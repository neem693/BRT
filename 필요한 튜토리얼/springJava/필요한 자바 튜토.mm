<map version="freeplane 1.9.0">
<!--To view this file, download free mind mapping software Freeplane from http://freeplane.sourceforge.net -->
<node TEXT="필요한 자바 튜토" FOLDED="false" ID="ID_1828054490" CREATED="1564407011351" MODIFIED="1621475789715">
<font NAME="SansSerif" SIZE="12"/>
<hook NAME="accessories/plugins/CreationModificationPlugin_new.properties"/>
<hook NAME="MapStyle">
    <properties fit_to_viewport="false" edgeColorConfiguration="#808080ff,#ff0000ff,#0000ffff,#00ff00ff,#ff00ffff,#00ffffff,#7c0000ff,#00007cff,#007c00ff,#7c007cff,#007c7cff,#7c7c00ff"/>

<map_styles>
<stylenode LOCALIZED_TEXT="styles.root_node" STYLE="oval" UNIFORM_SHAPE="true" VGAP_QUANTITY="24 pt">
<font SIZE="24"/>
<stylenode LOCALIZED_TEXT="styles.predefined" POSITION="right" STYLE="bubble">
<stylenode LOCALIZED_TEXT="default" ID="ID_271890427" ICON_SIZE="12 pt" COLOR="#000000" STYLE="fork">
<arrowlink SHAPE="CUBIC_CURVE" COLOR="#000000" WIDTH="2" TRANSPARENCY="200" DASH="" FONT_SIZE="9" FONT_FAMILY="SansSerif" DESTINATION="ID_271890427" STARTARROW="DEFAULT" ENDARROW="NONE"/>
<font NAME="SansSerif" SIZE="10" BOLD="false" ITALIC="false"/>
<richcontent CONTENT-TYPE="plain/auto" TYPE="DETAILS"/>
<richcontent TYPE="NOTE" CONTENT-TYPE="plain/auto"/>
</stylenode>
<stylenode LOCALIZED_TEXT="defaultstyle.details"/>
<stylenode LOCALIZED_TEXT="defaultstyle.attributes">
<font SIZE="9"/>
</stylenode>
<stylenode LOCALIZED_TEXT="defaultstyle.note" COLOR="#000000" BACKGROUND_COLOR="#ffffff" TEXT_ALIGN="LEFT"/>
<stylenode LOCALIZED_TEXT="defaultstyle.floating">
<edge STYLE="hide_edge"/>
<cloud COLOR="#f0f0f0" SHAPE="ROUND_RECT"/>
</stylenode>
<stylenode LOCALIZED_TEXT="defaultstyle.selection" BACKGROUND_COLOR="#4e85f8" STYLE="bubble" BORDER_COLOR_LIKE_EDGE="false" BORDER_COLOR="#4e85f8"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.user-defined" POSITION="right" STYLE="bubble">
<stylenode LOCALIZED_TEXT="styles.topic" COLOR="#18898b" STYLE="fork">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.subtopic" COLOR="#cc3300" STYLE="fork">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.subsubtopic" COLOR="#669900">
<font NAME="Liberation Sans" SIZE="10" BOLD="true"/>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.important" ID="ID_67550811">
<icon BUILTIN="yes"/>
<arrowlink COLOR="#003399" TRANSPARENCY="255" DESTINATION="ID_67550811"/>
</stylenode>
</stylenode>
<stylenode LOCALIZED_TEXT="styles.AutomaticLayout" POSITION="right" STYLE="bubble">
<stylenode LOCALIZED_TEXT="AutomaticLayout.level.root" COLOR="#000000" STYLE="oval" SHAPE_HORIZONTAL_MARGIN="10 pt" SHAPE_VERTICAL_MARGIN="10 pt">
<font SIZE="18"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,1" COLOR="#0033ff">
<font SIZE="16"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,2" COLOR="#00b439">
<font SIZE="14"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,3" COLOR="#990000">
<font SIZE="12"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,4" COLOR="#111111">
<font SIZE="10"/>
</stylenode>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,5"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,6"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,7"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,8"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,9"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,10"/>
<stylenode LOCALIZED_TEXT="AutomaticLayout.level,11"/>
</stylenode>
</stylenode>
</map_styles>
</hook>
<node TEXT="No goals have been specified for this build. You must specify a valid lifecycle phase or a goal in the format &lt;plugin-prefix&gt;:&lt;goal&gt; or &lt;plugin-group-id&gt;:&lt;plugin-artifact-id&gt;[:&lt;plugin-version&gt;]:&lt;goal&gt;. 다음과 같은 메이븐 에러일 때" FOLDED="true" POSITION="right" ID="ID_54453441" CREATED="1564407143832" MODIFIED="1621472968354" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="&lt;build&gt;" ID="ID_825190785" CREATED="1564407165766" MODIFIED="1564407165766">
<node TEXT="&lt;defaultGoal&gt;install&lt;/defaultGoal&gt;" ID="ID_1203480326" CREATED="1564407165768" MODIFIED="1564407168509" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="&lt;plugins&gt;" ID="ID_1568909172" CREATED="1564407165770" MODIFIED="1564407168501">
<node TEXT="&lt;plugin&gt;" ID="ID_1637936239" CREATED="1564407165771" MODIFIED="1564407168501">
<node TEXT="&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;" ID="ID_1350029928" CREATED="1564407165772" MODIFIED="1564407168501"/>
<node TEXT="&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;" ID="ID_1158917540" CREATED="1564407165773" MODIFIED="1564407168501"/>
</node>
<node TEXT="&lt;/plugin&gt;" ID="ID_747185002" CREATED="1564407165774" MODIFIED="1564407168501"/>
</node>
<node TEXT="&lt;/plugins&gt;" ID="ID_183004510" CREATED="1564407165775" MODIFIED="1564407168502"/>
</node>
<node TEXT="&lt;/build&gt;" ID="ID_1121844087" CREATED="1564407165776" MODIFIED="1564407165776"/>
</node>
</node>
<node TEXT="저 파란것을 추가해주면 된다." POSITION="right" ID="ID_967912806" CREATED="1564407170599" MODIFIED="1564407177170" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="크론" FOLDED="true" POSITION="right" ID="ID_603628225" CREATED="1564413592018" MODIFIED="1621472968354">
<node TEXT="https://docs.oracle.com/cd/E12058_01/doc/doc.1014/e12030/cron_expressions.htm" ID="ID_212916880" CREATED="1564413594189" MODIFIED="1564413594189" LINK="https://docs.oracle.com/cd/E12058_01/doc/doc.1014/e12030/cron_expressions.htm"/>
</node>
<node TEXT="jvm 환경에서 다음을 입력하여 인증서 만들 수 있음" FOLDED="true" POSITION="right" ID="ID_1752837018" CREATED="1564414947378" MODIFIED="1621472968354" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
<node TEXT="keytool -genkey -alias tomcat -storetype PKCS12 -keyalg RSA -keysize 2048 -keystore keystore.p12 -validity 3650" ID="ID_811643343" CREATED="1564414966606" MODIFIED="1564414968465"/>
</node>
<node TEXT="윈도우 환경에서는 cmd를 관리자권한으로 해야함" POSITION="right" ID="ID_909544120" CREATED="1564415243815" MODIFIED="1564415252755"/>
<node TEXT="튜토리얼 포인트에 독립적으로 사용간으한 서버 종류가 있다." FOLDED="true" POSITION="right" ID="ID_1743514445" CREATED="1564480786947" MODIFIED="1621472968354">
<node TEXT="해당하는 독립적인 서버는 다음에 있다." ID="ID_184338903" CREATED="1564480867438" MODIFIED="1564480882265">
<node TEXT="https://start.spring.io/" ID="ID_801792153" CREATED="1564480910830" MODIFIED="1564480910830" LINK="https://start.spring.io/"/>
</node>
<node TEXT="Eureka Server" ID="ID_1280668441" CREATED="1564480803528" MODIFIED="1564480807273">
<node TEXT="micro system의 분산처리를 할 수 있는 서버로 보인다." ID="ID_1571072317" CREATED="1564480808023" MODIFIED="1564480820289"/>
<node TEXT="기본적으로 서버를 보조하는 것으로 독립적으로 서버를 만들고 클라이언트 서버에 eureka 클라이언트를 어노테이션을 붙여서 사용 가능하다." ID="ID_577339448" CREATED="1564480820478" MODIFIED="1564480864585"/>
</node>
<node TEXT="zuul Server" ID="ID_615516696" CREATED="1564498508867" MODIFIED="1564499238004">
<node TEXT="기존의 서버가 가지고 있던 내용에 mapping을 보안상으로 감추거나 변경해주는 역할을 한다." ID="ID_1209867802" CREATED="1564498904940" MODIFIED="1564498961998"/>
<node TEXT="튜토리얼 포인트에 있는 내용을 그대로 적용시켰다." ID="ID_316289171" CREATED="1564498964025" MODIFIED="1564499375290">
<node TEXT="해당 프로퍼티 내용이다." ID="ID_1925954387" CREATED="1564498989746" MODIFIED="1564498993941">
<node TEXT="spring.application.name=zuulserver" ID="ID_1570416924" CREATED="1564498994319" MODIFIED="1564498994319"/>
<node TEXT="zuul.routes.get.path=/v1/api/**" ID="ID_1684614318" CREATED="1564498994320" MODIFIED="1564498994320"/>
<node TEXT="zuul.routes.get.url=http://127.0.0.1:8081/TctPro/" ID="ID_473615408" CREATED="1564498994321" MODIFIED="1564498994321" LINK="http://127.0.0.1:8081/TctPro/"/>
<node TEXT="logging.level.root=debug" ID="ID_1743722902" CREATED="1564498994324" MODIFIED="1564498994324"/>
<node TEXT="server.port=8111" ID="ID_389899872" CREATED="1564498994324" MODIFIED="1564498994324"/>
</node>
</node>
<node TEXT="@EnableZuulProxy을 적용시켰을 시 작동하지 않는 구석이 있는데 다음과 같다." ID="ID_1558984201" CREATED="1564499010442" MODIFIED="1594260842059">
<node TEXT="해당오류 내용이다." ID="ID_1057603631" CREATED="1564499139601" MODIFIED="1564499233097">
<node TEXT="org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;hystrixCommandAspect&apos; defined in class path resource" ID="ID_1548972747" CREATED="1564499142010" MODIFIED="1564499142010"/>
</node>
<node TEXT="그에 대한 해답" ID="ID_1073016531" CREATED="1564499188617" MODIFIED="1594260843100">
<node TEXT="https://stackoverflow.com/questions/46448051/hystrix-fallback-method-gives-error" ID="ID_645156322" CREATED="1564499196525" MODIFIED="1564499196525" LINK="https://stackoverflow.com/questions/46448051/hystrix-fallback-method-gives-error"/>
<node TEXT="메이븐에 다음을 적용시켰다." ID="ID_1291161621" CREATED="1564499218304" MODIFIED="1594260844165">
<node TEXT="&lt;dependency&gt;" ID="ID_1840887282" CREATED="1564499222826" MODIFIED="1564499222826"/>
<node TEXT="&lt;groupId&gt;org.aspectj&lt;/groupId&gt;" ID="ID_1282091310" CREATED="1564499222828" MODIFIED="1564499222828"/>
<node TEXT="&lt;artifactId&gt;aspectjrt&lt;/artifactId&gt;" ID="ID_1959923051" CREATED="1564499222830" MODIFIED="1564499222830"/>
<node TEXT="&lt;/dependency&gt;" ID="ID_1209749827" CREATED="1564499222831" MODIFIED="1564499222831"/>
<node TEXT="&lt;dependency&gt;" ID="ID_1084911540" CREATED="1564499222833" MODIFIED="1564499222833">
<node TEXT="&lt;groupId&gt;org.aspectj&lt;/groupId&gt;" ID="ID_437794822" CREATED="1564499222834" MODIFIED="1564499222834"/>
<node TEXT="&lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt;" ID="ID_1550738825" CREATED="1564499222837" MODIFIED="1564499222837"/>
</node>
<node TEXT="&lt;/dependency&gt;" ID="ID_997961936" CREATED="1564499222838" MODIFIED="1564499222838"/>
<node TEXT="&lt;dependency&gt;" ID="ID_627241238" CREATED="1564499222840" MODIFIED="1564499222840">
<node TEXT="&lt;groupId&gt;org.springframework&lt;/groupId&gt;" ID="ID_795888792" CREATED="1564499222842" MODIFIED="1564499222842"/>
<node TEXT="&lt;artifactId&gt;spring-aspects&lt;/artifactId&gt;" ID="ID_171860158" CREATED="1564499222844" MODIFIED="1564499222844"/>
</node>
<node TEXT="&lt;/dependency&gt;" ID="ID_426664576" CREATED="1564499222846" MODIFIED="1564499222846"/>
</node>
</node>
</node>
</node>
</node>
<node TEXT="swagger-ui.html이 404 떨어질때" FOLDED="true" POSITION="right" ID="ID_1142579295" CREATED="1565202033021" MODIFIED="1621472968354">
<node TEXT="swagger-ui.html 404 에러 나 같은 경우 스프링 부트 2.1.6 사용하고 있을 떄 springfox-swagger2와 springfox-swagger-ui를 사용할때 /v2/api-docs 는 잘되는데 swagger-ui.html이 씨알도 안먹히더라. 그래서 swagger와 ui를 2.7.0으로 바꾸니까 잘되더라. 참고바람 " ID="ID_356155014" CREATED="1565202046273" MODIFIED="1565202747081"/>
</node>
<node TEXT="포트 확인" FOLDED="true" POSITION="right" ID="ID_1017006133" CREATED="1565211325121" MODIFIED="1621472968354">
<node TEXT="netstat -ano" ID="ID_798013240" CREATED="1565211327619" MODIFIED="1565624634640"/>
<node TEXT="taskkill /F /PID 3792" ID="ID_1113092189" CREATED="1565624758878" MODIFIED="1565624758878"/>
<node TEXT="3792를 죽임" ID="ID_930944999" CREATED="1565624764382" MODIFIED="1565624768464"/>
</node>
<node TEXT="도커(Docker)" FOLDED="true" POSITION="right" ID="ID_738072142" CREATED="1565221709741" MODIFIED="1621472968354" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="docker는 docker를 설치하여야만 진행할 수 있을 듯 하다. 그러나 이걸 또 설치할려면 윈도우를 업데이트 하여야 한다. 그런데 윈도우 업데이트가 안된다. 그래서 이번껀은 넘긴다." ID="ID_375625165" CREATED="1565221676493" MODIFIED="1572269892721"/>
<node TEXT="인줄 알았는데 " ID="ID_1696233639" CREATED="1565223531807" MODIFIED="1579856326243">
<node TEXT="https://docs.docker.com/docker-for-windows/install/#what-to-know-before-you-install" ID="ID_507106757" CREATED="1565223539338" MODIFIED="1565223539338" LINK="https://docs.docker.com/docker-for-windows/install/#what-to-know-before-you-install"/>
</node>
<node TEXT="레거시 시스템에서도 받을 수 있도록 할수있다." ID="ID_413818247" CREATED="1565223540341" MODIFIED="1579856327113">
<node TEXT="https://docs.docker.com/toolbox/overview/" ID="ID_687248378" CREATED="1565223557336" MODIFIED="1565223557336" LINK="https://docs.docker.com/toolbox/overview/"/>
</node>
<node TEXT="그게 바로 docker toolbox인거 같다." ID="ID_77051114" CREATED="1565223588285" MODIFIED="1572269892723"/>
<node ID="ID_914672298" CREATED="1565227758101" MODIFIED="1579856328434"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <p>
      https&#47196; &#51217;&#49549;&#49884; &#51064;&#51613;&#50640; &#45824;&#54620; &#44221;&#47196; &#49444;&#51221;&#51012;&#160;&#54644;&#51480;&#50556; &#54616;&#44256; &#44536;&#44163;&#51012; &#52628;&#44032;&#49884;&#53020;&#51452;&#47732; &#46108;&#45796;.
    </p>
  </body>
</html>
</richcontent>
<font NAME="SansSerif" SIZE="12"/>
<node TEXT="https://stackoverflow.com/questions/39240560/spring-boot-with-docker-unable-to-find-valid-certification-path-to-requested-tar" ID="ID_1280610625" CREATED="1565227767066" MODIFIED="1565227767066" LINK="https://stackoverflow.com/questions/39240560/spring-boot-with-docker-unable-to-find-valid-certification-path-to-requested-tar"/>
</node>
<node TEXT="ADD failed : No such file/Directory" ID="ID_710344508" CREATED="1565286026082" MODIFIED="1579856329365" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="정확히 말하면 Failed to execute goal com.spotify:docker-maven-plugin:1.0.0:build (default-cli) on project TctProject: Exception caught: ADD failed: stat /mnt/sda1/var/lib/docker/tmp/docker-builder056676213/TctProject-0.0.1-SNAPSHOT.war: no such file or directory " ID="ID_632226530" CREATED="1565286164679" MODIFIED="1572269892728"/>
<node TEXT="이 에러인데" ID="ID_1613055189" CREATED="1565286390223" MODIFIED="1572269892730"/>
<node TEXT="이는 docker build를 할 때 맨처음 war파일을 docker-context-path에 copy가 되지 않아서 생긴 증상이다." ID="ID_1759184669" CREATED="1565286038944" MODIFIED="1572269892730"/>
<node TEXT="해당하는 플러그인에서 강조된 부분에 해당한다." FOLDED="true" ID="ID_1885714031" CREATED="1565286408960" MODIFIED="1620638754860">
<node TEXT="&lt;plugin&gt;" ID="ID_1378043070" CREATED="1565286452456" MODIFIED="1565286452456">
<node TEXT="&lt;groupId&gt;com.spotify&lt;/groupId&gt;" ID="ID_932154811" CREATED="1565286452463" MODIFIED="1565286452463"/>
<node TEXT="&lt;artifactId&gt;docker-maven-plugin&lt;/artifactId&gt;" ID="ID_7841400" CREATED="1565286452463" MODIFIED="1565286452463"/>
<node TEXT="&lt;version&gt;1.0.0&lt;/version&gt;" ID="ID_445258152" CREATED="1565286452464" MODIFIED="1565286452464"/>
<node TEXT="&lt;configuration&gt;" ID="ID_1424120310" CREATED="1565286452464" MODIFIED="1565286452464">
<node TEXT="&lt;dockerHost&gt;https://192.168.99.100:2376&lt;/dockerHost&gt;" ID="ID_730665132" CREATED="1565286452465" MODIFIED="1565286452465" LINK="https://192.168.99.100:2376%3C/dockerHost%3E"/>
<node TEXT="&lt;imageName&gt;${docker.image.prefix}/tctproject&lt;/imageName&gt;" ID="ID_749599613" CREATED="1565286452468" MODIFIED="1565286452468"/>
<node TEXT="&lt;dockerDirectory&gt;src/main/docker&lt;/dockerDirectory&gt;" ID="ID_590142680" CREATED="1565286452469" MODIFIED="1565286452469"/>
<node TEXT="&lt;dockerCertPath&gt;C:\Users\UIO\.docker\machine\machines\default&lt;/dockerCertPath&gt;" ID="ID_1500038146" CREATED="1565286452469" MODIFIED="1565286452469"/>
<node TEXT="&lt;resources&gt;" ID="ID_980807735" CREATED="1565286452471" MODIFIED="1565286452471">
<node TEXT="&lt;resource&gt;" ID="ID_1480040666" CREATED="1565286452471" MODIFIED="1565286452471">
<node TEXT="&lt;directory&gt;${project.build.directory}&lt;/directory&gt;" ID="ID_1063560732" CREATED="1565286452472" MODIFIED="1565286462647" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="&lt;include&gt;${project.build.finalName}.war&lt;/include&gt;" ID="ID_348494186" CREATED="1565286452472" MODIFIED="1565286652774" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
</node>
<node TEXT="&lt;/resource&gt;" ID="ID_1012188073" CREATED="1565286452473" MODIFIED="1565286452473"/>
</node>
<node TEXT="&lt;/resources&gt;" ID="ID_1026949114" CREATED="1565286452473" MODIFIED="1565286452473"/>
</node>
<node TEXT="&lt;/configuration&gt;" ID="ID_1318967709" CREATED="1565286452474" MODIFIED="1565286452474"/>
<node TEXT="&lt;/plugin&gt;" ID="ID_1565579284" CREATED="1565286452475" MODIFIED="1565286452475"/>
</node>
</node>
<node TEXT="여기서 &lt;include&gt;${project.build.finalName}.war&lt;/include&gt;  부분은 build를 할때 maven에서 packaging을 설정한 데로 해줘야 함을 명심하자" ID="ID_1046641712" CREATED="1565286654704" MODIFIED="1572269892730"/>
<node TEXT="그러면  다음과 같은 것을 docker build를 할때 콘솔에서 볼 수가 있을 것이다. docker-context-path에 복사가 되는 걸 볼 수 있다." FOLDED="true" ID="ID_567945016" CREATED="1565286702023" MODIFIED="1579856336587">
<node TEXT="Copying E:\BRT\TctProject\target\TctProject-0.0.1-SNAPSHOT.war -&gt; E:\BRT\TctProject\target\docker\TctProject-0.0.1-SNAPSHOT.war" ID="ID_1837520671" CREATED="1565286971657" MODIFIED="1565286971657"/>
</node>
<node TEXT="이렇게 옮겨만 진다고 다가 아니고 정확히 dockerfile에 대해서 저 war에 대한 명칭 정의가 필요하다. 강조된 부분을 참고하시라" FOLDED="true" ID="ID_813955792" CREATED="1565287074567" MODIFIED="1579856337764">
<node TEXT="FROM java:8" ID="ID_755616145" CREATED="1565287299034" MODIFIED="1565287299034"/>
<node TEXT="VOLUME /tmp" ID="ID_1868689251" CREATED="1565287299035" MODIFIED="1565287299035"/>
<node TEXT="ADD /TctProject-0.0.1-SNAPSHOT.war app.jar" ID="ID_704684853" CREATED="1565287299035" MODIFIED="1565287300748" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="RUN bash -c &apos;touch /app.jar&apos;" ID="ID_1743909221" CREATED="1565287299036" MODIFIED="1565287299036"/>
<node TEXT="ENTRYPOINT [&quot;java&quot;,&quot;-Djava.security.egd=file:/dev/./urandom&quot;,&quot;-jar&quot;,&quot;/app.jar&quot;]" ID="ID_185853562" CREATED="1565287299036" MODIFIED="1565287299036"/>
</node>
<node TEXT="그다음 바로 docker:build를 실행하자" FOLDED="true" ID="ID_433676764" CREATED="1565287744009" MODIFIED="1579856339447">
<node ID="ID_318670447" CREATED="1565287755731" MODIFIED="1565287755731"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_6113619079066766267.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="도커" FOLDED="true" ID="ID_1636504526" CREATED="1572269893606" MODIFIED="1579856324285">
<node TEXT="https://www.slideshare.net/pyrasis/docker-fordummies-44424016" ID="ID_134265155" CREATED="1572269899877" MODIFIED="1572269899877" LINK="https://www.slideshare.net/pyrasis/docker-fordummies-44424016"/>
</node>
</node>
<node TEXT="마리아DB --&gt; id, pwd " FOLDED="true" POSITION="right" ID="ID_1846173704" CREATED="1565631351067" MODIFIED="1621472968354">
<node TEXT="root" ID="ID_955855352" CREATED="1565631369063" MODIFIED="1565631408751"/>
<node TEXT="oratree12341234aa" ID="ID_1503716678" CREATED="1565631371685" MODIFIED="1565631381951"/>
</node>
<node TEXT="gmail less secure app" FOLDED="true" POSITION="right" ID="ID_1370038050" CREATED="1565647048431" MODIFIED="1621472968354">
<node TEXT="https://myaccount.google.com/lesssecureapps?pli=1" ID="ID_394578978" CREATED="1565647059045" MODIFIED="1565647059045" LINK="https://myaccount.google.com/lesssecureapps?pli=1"/>
</node>
<node TEXT="websocket" FOLDED="true" POSITION="right" ID="ID_295040871" CREATED="1565714861390" MODIFIED="1621472968354">
<node TEXT="https://www.tutorialspoint.com/spring_boot/spring_boot_web_socket.htm" ID="ID_449998338" CREATED="1565714885843" MODIFIED="1565714886630" LINK="https://www.tutorialspoint.com/spring_boot/spring_boot_web_socket.htm"/>
<node TEXT="튜토리얼 포인트에서 웹 소켓에 대한 내용이 있는데" ID="ID_1540854741" CREATED="1565714887694" MODIFIED="1565714956013"/>
<node TEXT="여기서 필요한 클래스가 잘 나오지 않는데 밑을 참고하면 잘 나온다." ID="ID_671373614" CREATED="1565714956190" MODIFIED="1565714965785"/>
<node TEXT="https://spring.io/guides/gs/messaging-stomp-websocket/" ID="ID_425794876" CREATED="1565714873204" MODIFIED="1565714873204" LINK="https://spring.io/guides/gs/messaging-stomp-websocket/"/>
<node TEXT="AbstractWebSocketMessageBrokerConfigurer 쓰지말랜다" ID="ID_983703411" CREATED="1565716635299" MODIFIED="1565716709752">
<node TEXT="AbstractWebSocketMessageBrokerConfigurer Deprecated.  as of 5.0 in favor of simply using WebSocketMessageBrokerConfigurer which has default methods, made possible by a Java 8 baseline." ID="ID_923872869" CREATED="1565716638086" MODIFIED="1565716657839" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="WebSocketMessageBrokerConfigurer 이거 쓰랜다." ID="ID_242748651" CREATED="1565716642781" MODIFIED="1565716644952"/>
<node TEXT="정확히 WebSocketMessageBrokerConfigurationSupport 이것인거 같다." ID="ID_923939358" CREATED="1565716771909" MODIFIED="1565716775936"/>
<node TEXT="아니다. WebSocketMessageBrokerConfigurer 는 인터페이스로 상속받는게 아니라 구현받아야 한다." ID="ID_660950122" CREATED="1565722446250" MODIFIED="1565722463045"/>
</node>
</node>
<node TEXT="cors filter를 글로벌 하게" FOLDED="true" POSITION="right" ID="ID_1376475978" CREATED="1565796565923" MODIFIED="1621472968354">
<node TEXT="package com.framework.Tct.filter;" ID="ID_739367565" CREATED="1565796936430" MODIFIED="1565796936430"/>
<node TEXT="import java.io.IOException;" ID="ID_1161798806" CREATED="1565796936431" MODIFIED="1565796936431"/>
<node TEXT="import javax.servlet.Filter;" ID="ID_993164094" CREATED="1565796936432" MODIFIED="1565796936432"/>
<node TEXT="import javax.servlet.FilterChain;" ID="ID_450915425" CREATED="1565796936432" MODIFIED="1565796936432"/>
<node TEXT="import javax.servlet.FilterConfig;" ID="ID_1178245968" CREATED="1565796936432" MODIFIED="1565796936432"/>
<node TEXT="import javax.servlet.ServletException;" ID="ID_1844409225" CREATED="1565796936433" MODIFIED="1565796936433"/>
<node TEXT="import javax.servlet.ServletRequest;" ID="ID_685960728" CREATED="1565796936433" MODIFIED="1565796936433"/>
<node TEXT="import javax.servlet.ServletResponse;" ID="ID_98868184" CREATED="1565796936433" MODIFIED="1565796936433"/>
<node TEXT="import javax.servlet.http.HttpServletResponse;" ID="ID_1033234726" CREATED="1565796936434" MODIFIED="1565796936434"/>
<node TEXT="import org.springframework.stereotype.Component;" ID="ID_341311041" CREATED="1565796936434" MODIFIED="1565796936434"/>
<node TEXT="@Component" ID="ID_963586907" CREATED="1565796936434" MODIFIED="1565796936434"/>
<node TEXT="public class CORSFilter implements Filter {" ID="ID_618403991" CREATED="1565796936435" MODIFIED="1593496730437">
<node TEXT="@Override" ID="ID_1139443" CREATED="1565796936435" MODIFIED="1565796936435"/>
<node TEXT="public void init(FilterConfig filterConfig) throws ServletException {" ID="ID_373453704" CREATED="1565796936435" MODIFIED="1565796936435"/>
<node TEXT="}" ID="ID_818372059" CREATED="1565796936436" MODIFIED="1565796936436"/>
<node TEXT="@Override" ID="ID_537428515" CREATED="1565796936436" MODIFIED="1565796936436"/>
<node TEXT="public void doFilter(ServletRequest servletRequest, ServletResponse servletResponse, FilterChain filterChain) throws IOException, ServletException {" ID="ID_1711699566" CREATED="1565796936437" MODIFIED="1565796936437">
<node TEXT="HttpServletResponse response = (HttpServletResponse) servletResponse;" ID="ID_613131241" CREATED="1565796936445" MODIFIED="1565796936445"/>
<node TEXT="response.setHeader(&quot;Access-Control-Allow-Origin&quot;, &quot;*&quot;);" ID="ID_771522844" CREATED="1565796936446" MODIFIED="1565796958714">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_771522844" ENDARROW="Default" ENDINCLINATION="1106;0;" ID="Arrow_ID_471463116" SOURCE="ID_294244476" STARTARROW="None" STARTINCLINATION="1106;0;"/>
</node>
<node TEXT="response.setHeader(&quot;Access-Control-Allow-Methods&quot;, &quot;POST, GET, PUT, OPTIONS, DELETE, PATCH&quot;);" ID="ID_1291847984" CREATED="1565796936446" MODIFIED="1565796936446"/>
<node TEXT="response.setHeader(&quot;Access-Control-Max-Age&quot;, &quot;3600&quot;);" ID="ID_1021382001" CREATED="1565796936447" MODIFIED="1565796936447"/>
<node TEXT="response.setHeader(&quot;Access-Control-Allow-Headers&quot;, &quot;Origin, Content-Type, Accept&quot;);" ID="ID_159851091" CREATED="1565796936447" MODIFIED="1565796936447"/>
<node TEXT="response.setHeader(&quot;Access-Control-Expose-Headers&quot;, &quot;Location&quot;);" ID="ID_241209301" CREATED="1565796936447" MODIFIED="1565796936447"/>
<node TEXT="filterChain.doFilter(servletRequest, servletResponse);" ID="ID_856898268" CREATED="1565796936448" MODIFIED="1565796936448"/>
</node>
<node TEXT="}" ID="ID_1575761357" CREATED="1565796936448" MODIFIED="1565796936448"/>
<node TEXT="@Override" ID="ID_1001506935" CREATED="1565796936448" MODIFIED="1565796936448"/>
<node TEXT="public void destroy() {" ID="ID_1047564194" CREATED="1565796936449" MODIFIED="1565796936449"/>
<node TEXT="}" ID="ID_914840643" CREATED="1565796936449" MODIFIED="1565796936449"/>
</node>
<node TEXT="}" ID="ID_1410557514" CREATED="1565796936449" MODIFIED="1565796936449"/>
<node TEXT="//저 오리진에 값을 넣어라" ID="ID_294244476" CREATED="1565796938108" MODIFIED="1565796958715">
<arrowlink DESTINATION="ID_771522844" STARTINCLINATION="829.49998 pt;0 pt;" ENDINCLINATION="829.49998 pt;0 pt;" STARTARROW="NONE" ENDARROW="DEFAULT"/>
</node>
</node>
<node TEXT="websocket cors" FOLDED="true" POSITION="right" ID="ID_160182894" CREATED="1565799539899" MODIFIED="1621472968354">
<node TEXT="@Override" ID="ID_411116254" CREATED="1565799551022" MODIFIED="1565799551022"/>
<node TEXT="public void addCorsMappings(CorsRegistry registry) {" ID="ID_528557940" CREATED="1565799551024" MODIFIED="1565799551024">
<node TEXT="// TODO Auto-generated method stub" ID="ID_914372966" CREATED="1565799551025" MODIFIED="1565799551025"/>
<node TEXT="registry.addMapping(&quot;/**&quot;).allowedOrigins(&quot;http://127.0.0.1:4200&quot;,&quot;http://127.0.0.1:8111&quot;);" ID="ID_1327370618" CREATED="1565799551025" MODIFIED="1565799552600" LINK="http://127.0.0.1:4200" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
</node>
<node TEXT="}" ID="ID_1228389721" CREATED="1565799551030" MODIFIED="1565799551030"/>
</node>
<node TEXT="sockjs-client 에서 global 변수가 정의되지 않았다고 뜰 때" FOLDED="true" POSITION="right" ID="ID_126925543" CREATED="1565799603895" MODIFIED="1621472968354">
<node TEXT="https://github.com/sockjs/sockjs-client/issues/439" ID="ID_530425315" CREATED="1565799622151" MODIFIED="1565799622151" LINK="https://github.com/sockjs/sockjs-client/issues/439"/>
<node TEXT="global 을 window로 정의해줘야함" ID="ID_1488279981" CREATED="1565799623163" MODIFIED="1565799630702">
<node TEXT="&lt;script&gt;" ID="ID_1964914146" CREATED="1565799636975" MODIFIED="1565799636975">
<node TEXT="var global = window;" ID="ID_1978812903" CREATED="1565799636976" MODIFIED="1565799636976"/>
</node>
<node TEXT="&lt;/script&gt;" ID="ID_1813327775" CREATED="1565799636976" MODIFIED="1565799636976"/>
</node>
<node TEXT="https://github.com/stomp-js/ng2-stompjs/issues/70" ID="ID_1385664685" CREATED="1565799678913" MODIFIED="1565799678913" LINK="https://github.com/stomp-js/ng2-stompjs/issues/70"/>
<node TEXT="angular를 이렇게함" ID="ID_1860577442" CREATED="1565799679969" MODIFIED="1565799683686">
<node TEXT="(window as any).global = window;" ID="ID_1130073980" CREATED="1565799689375" MODIFIED="1565799692435" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="to angular-clis polyfill.ts file. right now couldn&apos;t see any sideeffects" ID="ID_928810396" CREATED="1565799689378" MODIFIED="1565799689378"/>
</node>
</node>
<node TEXT="웹 소켓에 대한 정리" FOLDED="true" POSITION="right" ID="ID_718731204" CREATED="1565932198016" MODIFIED="1621472968354">
<node TEXT="기본적으로 angular 8 + spring 2.1.6을 사용한 것" ID="ID_169774616" CREATED="1565932222238" MODIFIED="1565932236394"/>
<node TEXT="튜토리얼 포인트를 기본적으로 참고" ID="ID_1296553527" CREATED="1565932331134" MODIFIED="1611911588858">
<node TEXT="https://www.tutorialspoint.com/spring_boot/spring_boot_web_socket.htm" ID="ID_81431862" CREATED="1565932338271" MODIFIED="1565932338271" LINK="https://www.tutorialspoint.com/spring_boot/spring_boot_web_socket.htm"/>
</node>
<node TEXT="angular 8에서 사용한 모듈" ID="ID_1790914735" CREATED="1565932339349" MODIFIED="1611911590030">
<node TEXT="npm install @types/sockjs" ID="ID_960084271" CREATED="1565932441342" MODIFIED="1565932444673"/>
<node TEXT="npm install @types/sockjs-client" ID="ID_909739163" CREATED="1565932594115" MODIFIED="1565933126706"/>
<node TEXT="sockjs는 global 변수가 없다고 뜨니 다음을 참고" ID="ID_1794270471" CREATED="1565932452901" MODIFIED="1565932471714" LINK="#ID_126925543"/>
</node>
<node TEXT="초기화(이미지)" ID="ID_187154817" CREATED="1565932655061" MODIFIED="1611911596450">
<node ID="ID_932637870" CREATED="1565932832902" MODIFIED="1565932832902"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_1057530845740162558.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="response대기 &amp; response 발송(이미지)" ID="ID_1543561114" CREATED="1565932669550" MODIFIED="1611911634340">
<node ID="ID_1133023370" CREATED="1565932848803" MODIFIED="1565932848803"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_9066862867563416584.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="결과(이미지)" FOLDED="true" ID="ID_23517283" CREATED="1565932799167" MODIFIED="1575381537050">
<node ID="ID_1779098021" CREATED="1565932964388" MODIFIED="1565932964388"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_3905903370955449598.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="웹 소켓 스케쥴링(이미지)" FOLDED="true" ID="ID_378806869" CREATED="1565932801094" MODIFIED="1611645769734">
<node ID="ID_266505493" CREATED="1565932905882" MODIFIED="1565932905882"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_3808019953913013532.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="결과(이미지)" FOLDED="true" ID="ID_1348791827" CREATED="1565932810406" MODIFIED="1581412920120">
<node ID="ID_15785288" CREATED="1565932971027" MODIFIED="1565932971027"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_6534264726674078772.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="중요!!" FOLDED="true" ID="ID_42721197" CREATED="1565936865269" MODIFIED="1569169982920">
<node TEXT="해당 페이지의 OnDestory 인터페이스를 해당 클래스에서 구현해서 페이지 벗어날 떄마다 disconnect를 해줘야 한다. 이렇게 하지 않으면 기존 세션이 살아있어서 똑같은 메시지가 2개이상 날라올 수 있다." ID="ID_456157295" CREATED="1565936870253" MODIFIED="1565937083712">
<node TEXT="export class WebSocketComponent implements OnInit,OnDestroy" ID="ID_1635874714" CREATED="1565936921059" MODIFIED="1565936923998"/>
<node TEXT="ngOnDestroy(): void { this.disconnect(); }  " ID="ID_619442801" CREATED="1565936909433" MODIFIED="1565936944817"/>
</node>
</node>
</node>
<node TEXT="alt + shift + s" POSITION="right" ID="ID_1816867178" CREATED="1566173568044" MODIFIED="1566173574807"/>
<node TEXT="batchService 오류 &amp; flyway" FOLDED="true" POSITION="right" ID="ID_767685997" CREATED="1566190490009" MODIFIED="1621472968354">
<node TEXT="1" ID="ID_1410866249" CREATED="1566191547662" MODIFIED="1581412598306">
<node TEXT="Caused by: java.lang.IllegalArgumentException: DatabaseType not found for product name: [MariaDB]" ID="ID_1054801273" CREATED="1566191549334" MODIFIED="1566191549334"/>
</node>
<node TEXT="2" ID="ID_882481656" CREATED="1566191559022" MODIFIED="1581412599392">
<node TEXT="Caused by: java.lang.IllegalStateException: Unable to initialize Spring Batch" ID="ID_117247796" CREATED="1566191559702" MODIFIED="1566191559702"/>
</node>
<node TEXT="3" ID="ID_977707679" CREATED="1566191566917" MODIFIED="1581412599994">
<node TEXT="org.springframework.beans.factory.BeanCreationException: Error creating bean with name &apos;batchConfigurer&apos;: Invocation of init method failed; nested exception is java.lang.IllegalStateException: Unable to initialize Spring Batch" ID="ID_1452012363" CREATED="1566191567608" MODIFIED="1566191567608"/>
</node>
<node TEXT="해결" ID="ID_1618196384" CREATED="1566192834509" MODIFIED="1581412600692">
<node TEXT="https://github.com/spring-projects/spring-framework/issues/22344" ID="ID_882801554" CREATED="1566192836088" MODIFIED="1566192836088" LINK="https://github.com/spring-projects/spring-framework/issues/22344"/>
<node TEXT="마리아 DB 2.4.0는 특정 설정이 Mysql에서 mariaDB로 바뀌었다고 함" ID="ID_930864554" CREATED="1566192836797" MODIFIED="1566195224367"/>
<node TEXT="따라서 2.3.0으로 변경하거나, 배치서비스가 mariaDB를 지원해주는 방법 밖에 없음" ID="ID_470857625" CREATED="1566195224837" MODIFIED="1566195279784"/>
</node>
<node TEXT="1" ID="ID_1521823159" CREATED="1566195296243" MODIFIED="1581412604282">
<node TEXT="Caused by: java.sql.SQLException: Table &apos;test.batch_job_instance&apos; doesn&apos;t exist" ID="ID_1096991296" CREATED="1566195297400" MODIFIED="1566195297400"/>
</node>
<node TEXT="해결" ID="ID_1410361018" CREATED="1566195699318" MODIFIED="1581412605802">
<node TEXT="https://stackoverflow.com/questions/49443551/i-am-getting-error-table-test-batch-job-instance-doesnt-exist" ID="ID_339903593" CREATED="1566195700364" MODIFIED="1566195700364" LINK="https://stackoverflow.com/questions/49443551/i-am-getting-error-table-test-batch-job-instance-doesnt-exist"/>
<node TEXT="스키마 초기화에 대한 application.yml에 대한 프로퍼티 값에 대한 always값을 가지게 하면 됨" ID="ID_1273742086" CREATED="1566195702924" MODIFIED="1566195740320"/>
</node>
<node TEXT="1" ID="ID_1203165890" CREATED="1566196705018" MODIFIED="1581412608307">
<node TEXT="java.lang.NoSuchMethodException: com.framework.Tct.batchService.User2.&lt;init&gt;()" ID="ID_149752340" CREATED="1566196714435" MODIFIED="1566196714435"/>
</node>
<node TEXT="해결" ID="ID_792945996" CREATED="1566196715795" MODIFIED="1581412609489">
<node TEXT="해당 pojo 그러니까 vo 클래스가 기본 생성자가 없어서 생긴 문제" ID="ID_1153369544" CREATED="1566196717762" MODIFIED="1566196737288">
<node TEXT="public User2() {" ID="ID_722980743" CREATED="1566196749956" MODIFIED="1566196749956">
<node TEXT="super();" ID="ID_1688977754" CREATED="1566196749957" MODIFIED="1566196749957"/>
</node>
<node TEXT="}" ID="ID_1858533577" CREATED="1566196749957" MODIFIED="1566196749957"/>
</node>
<node TEXT="만 만들어주면 끝" ID="ID_295364115" CREATED="1566196752723" MODIFIED="1566196754809"/>
</node>
<node TEXT="1" ID="ID_1567361321" CREATED="1566197037906" MODIFIED="1581412612281">
<node TEXT="java.sql.SQLException: Table &apos;test.users2&apos; doesn&apos;t exist" ID="ID_840167478" CREATED="1566197038540" MODIFIED="1566197038540"/>
</node>
<node TEXT="해결" ID="ID_290306677" CREATED="1566204901574" MODIFIED="1581412613483">
<node TEXT="https://stackoverflow.com/questions/34942275/why-is-flyway-ignoring-my-sql-migration-files" ID="ID_209114959" CREATED="1566204903913" MODIFIED="1566204903913" LINK="https://stackoverflow.com/questions/34942275/why-is-flyway-ignoring-my-sql-migration-files"/>
<node TEXT="user2 테이블이 생성되지 않는 문제,  기존의 테이블 만드는 걸 사용하기 보다는 flyway를 사용하라고 권장함. 그래서 flyway씀" ID="ID_456830940" CREATED="1566214832308" MODIFIED="1566225995730"/>
<node TEXT="문제" ID="ID_1496406379" CREATED="1566205114656" MODIFIED="1566205117101">
<node TEXT="Invocation of init method failed; nested exception is org.flywaydb.core.api.FlywayException: Found more than one migration with version 1" ID="ID_1941240797" CREATED="1566205117490" MODIFIED="1566205117490"/>
</node>
<node TEXT="https://stackoverflow.com/questions/34919163/flyway-cant-run-multiple-sql-scripts" ID="ID_1442510023" CREATED="1566205100786" MODIFIED="1566205100786" LINK="https://stackoverflow.com/questions/34919163/flyway-cant-run-multiple-sql-scripts"/>
<node TEXT="해당 미그레이션은 prefix로 버젼을 뜻하는 V가 맨 앞에 있어야 함. 이 버젼값은 유니크 값이어야 함" ID="ID_1407919961" CREATED="1566226047606" MODIFIED="1566226643564"/>
</node>
<node TEXT="문제" ID="ID_1632414220" CREATED="1566205229489" MODIFIED="1581412625499">
<node TEXT="Incorrect string value: &apos;\xEC\xA1\xB4&apos; for column `test`.`users2`.`first_name` at row 1" ID="ID_1654842677" CREATED="1566205230674" MODIFIED="1566205230674"/>
</node>
<node TEXT="https://seizetop.tistory.com/3" ID="ID_1567988227" CREATED="1566214070423" MODIFIED="1566214072647" LINK="https://seizetop.tistory.com/3"/>
<node TEXT="https://stackoverflow.com/questions/2136126/creating-mysql-table-with-explicit-default-character-set-what-if-i-dont" ID="ID_601462373" CREATED="1566214469100" MODIFIED="1566214470373" LINK="https://stackoverflow.com/questions/2136126/creating-mysql-table-with-explicit-default-character-set-what-if-i-dont"/>
<node TEXT="해결" ID="ID_965247723" CREATED="1566226232090" MODIFIED="1581412627932">
<node TEXT="테이블 자체가 utf-8로 설정이 되어 있지 않아서 생기는 문제" ID="ID_225035475" CREATED="1566226082918" MODIFIED="1566226109771"/>
</node>
<node TEXT="문제" ID="ID_1348043153" CREATED="1566212100550" MODIFIED="1581412629040">
<node TEXT="Found non-empty schema &quot;public&quot; without metadata table! Use init() or set initOnMigrate to true to initialize the metadata table." ID="ID_1634952464" CREATED="1566212102601" MODIFIED="1566212102601"/>
</node>
<node TEXT="https://stackoverflow.com/questions/25562115/flyway-non-empty-schema-without-metadata-table" ID="ID_299350687" CREATED="1566212109635" MODIFIED="1566212109635" LINK="https://stackoverflow.com/questions/25562115/flyway-non-empty-schema-without-metadata-table"/>
<node ID="ID_491684848" CREATED="1566226239430" MODIFIED="1581412630625"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <p>
      &#54644;&#44208;
    </p>
  </body>
</html>
</richcontent>
<node ID="ID_759001616" CREATED="1566226264806" MODIFIED="1566226264807"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <p>
      flyway.baseline-on-migrate = true&#44050;&#51012; &#51468;
    </p>
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="문제" ID="ID_1548650117" CREATED="1566226268999" MODIFIED="1581412631006">
<node TEXT="이번엔 user 테이블이 만들어지지 않음" ID="ID_1505277749" CREATED="1566222759305" MODIFIED="1566222767543"/>
</node>
<node TEXT="https://flywaydb.org/documentation/commandline/migrate#baselineOnMigrate" ID="ID_350550880" CREATED="1566225091433" MODIFIED="1566225091433" LINK="https://flywaydb.org/documentation/commandline/migrate#baselineOnMigrate"/>
<node TEXT="해결" FOLDED="true" ID="ID_92912782" CREATED="1566226273727" MODIFIED="1581412596335">
<node TEXT="해당 flyway.baseline-on-migrate 는 기존의 history가 남아있는데도 새롭게 테이블을 만들거나 삽입하려고 하는 행위를 막으려고 하는 보호장치를 가동하는것. " ID="ID_1224066181" CREATED="1566226180078" MODIFIED="1566226356779"/>
<node TEXT="그것을 baseLine이라고 부르며 해당 옵션값은 baselineVersion  으로 정할수 있음. 여기서 설정하는 버젼보다 높은 것들은 다 가동시키나, 그렇지 않으면 가동시키지 않음" ID="ID_75781714" CREATED="1566226357423" MODIFIED="1566226430515"/>
<node TEXT="기본값은 1로 설정되어 있음." ID="ID_1379515510" CREATED="1566226471975" MODIFIED="1566226478723"/>
<node TEXT="사실 기본값을 바꾸기 보다는 현재 user 테이블을 만드는데 사용되는 V1을 V1.1이나 다른 기타로 바꿀 필요가 있음" ID="ID_1320763796" CREATED="1566226479927" MODIFIED="1566226502155"/>
<node TEXT="따라서 해당 sql 파일을 변경할거임 V1__initial.sql  --&gt; V1.1__initial.sql 로 변경." ID="ID_1926873596" CREATED="1566226511159" MODIFIED="1566226777596"/>
<node TEXT="기존의 V1.1__user2.sql은 앞 부분만 V1.2__user2.sql로 변경" ID="ID_538643207" CREATED="1566226778824" MODIFIED="1566226804540"/>
</node>
<node TEXT="개선" FOLDED="true" ID="ID_825754623" CREATED="1566236190131" MODIFIED="1581412596335">
<node TEXT="멀티 datasource 가능 할 수 있도록" ID="ID_1683759833" CREATED="1566236197121" MODIFIED="1566236204916"/>
</node>
<node TEXT="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#howto-configure-a-datasource" ID="ID_1366761329" CREATED="1566236207437" MODIFIED="1566236207437" LINK="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#howto-configure-a-datasource"/>
<node TEXT="https://stackoverflow.com/questions/49088847/after-spring-boot-2-0-migration-jdbcurl-is-required-with-driverclassname" ID="ID_1851668283" CREATED="1566236215273" MODIFIED="1566236215273" LINK="https://stackoverflow.com/questions/49088847/after-spring-boot-2-0-migration-jdbcurl-is-required-with-driverclassname"/>
<node TEXT="해결" FOLDED="true" ID="ID_763291293" CREATED="1566358929893" MODIFIED="1581412596335">
<node TEXT="해당 두 링크를 적절히 섞어서 진행을 해야만 한다." ID="ID_330139780" CREATED="1566358933675" MODIFIED="1566358947405"/>
<node TEXT="해당 해결(이미지)" FOLDED="true" ID="ID_1511968131" CREATED="1566359294730" MODIFIED="1572590027921">
<node ID="ID_1238942256" CREATED="1566359335226" MODIFIED="1566359335226"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_5387478195447482212.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="먼저 propertis를 가져오는 함수를 만든후 그에 따르는 datasource를 만든다." ID="ID_981387799" CREATED="1566359538898" MODIFIED="1566359557806"/>
<node TEXT="추가적으로 알아둬야 할것은 HikariDatasource인데 이 datasource는 좀더 빠르다고 한다." ID="ID_1880450760" CREATED="1566359565090" MODIFIED="1572593248928"/>
</node>
<node TEXT="배치 기본적 부분은 다음과 같다. 어떻게 동작하는지에 대한 부분(이미지)" FOLDED="true" ID="ID_895858694" CREATED="1566359353297" MODIFIED="1581412596336">
<node ID="ID_1745462485" CREATED="1566361486631" MODIFIED="1566361486631"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_5458846994340557257.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="kafka오류" FOLDED="true" POSITION="right" ID="ID_773715394" CREATED="1566377216061" MODIFIED="1621472968354">
<node TEXT="기본적인 개념도(이미지)" FOLDED="true" ID="ID_474549072" CREATED="1566566164289" MODIFIED="1569165928944">
<node ID="ID_790047779" CREATED="1566566169604" MODIFIED="1566566169604"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_5453484010853940619.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="튜토리얼 포인트" FOLDED="true" ID="ID_1260526683" CREATED="1566564868351" MODIFIED="1569165930409">
<node TEXT="https://www.tutorialspoint.com/spring_boot/spring_boot_apache_kafka.htm" ID="ID_794523262" CREATED="1566564871586" MODIFIED="1566564871586" LINK="https://www.tutorialspoint.com/spring_boot/spring_boot_apache_kafka.htm"/>
</node>
<node TEXT="문제" FOLDED="true" ID="ID_1069279727" CREATED="1566377225742" MODIFIED="1568739918086">
<node TEXT="Connection to node -1 could not be established. Broker may not be available." ID="ID_1978970841" CREATED="1566377221040" MODIFIED="1566377221484"/>
<node TEXT="@EnableKafka 추가 안함" ID="ID_1477540254" CREATED="1566381985416" MODIFIED="1566381994436"/>
</node>
<node TEXT="문제" FOLDED="true" ID="ID_947940271" CREATED="1566381977049" MODIFIED="1568739918086">
<node TEXT="com.fasterxml.jackson.databind.deser.std.StringDeserializer is not an instance of org.apache.kafka.common.serialization.Deserializer" ID="ID_1284687801" CREATED="1566381978228" MODIFIED="1566381978228"/>
</node>
<node TEXT="해결" FOLDED="true" ID="ID_945763282" CREATED="1566382015008" MODIFIED="1568739918086">
<node TEXT="https://stackoverflow.com/questions/53801565/common-kafkaexception-com-fasterxml-jackson-databind-ser-std-stringserializer-i" ID="ID_1830312338" CREATED="1566382011379" MODIFIED="1566382011379" LINK="https://stackoverflow.com/questions/53801565/common-kafkaexception-com-fasterxml-jackson-databind-ser-std-stringserializer-i"/>
<node TEXT="org.apache.kafka.common.serialization.StringSerializer사용" ID="ID_827809247" CREATED="1566382037838" MODIFIED="1566382041053"/>
</node>
<node TEXT="기본적으로 주키퍼와 카프카가 실행이 되어야만 작동한다." ID="ID_1806038925" CREATED="1566562732939" MODIFIED="1566562746047"/>
<node TEXT="apache zookeeper" FOLDED="true" ID="ID_903050808" CREATED="1566427088263" MODIFIED="1582459804536">
<node TEXT="https://github.com/apache/zookeeper/releases" ID="ID_1461454168" CREATED="1566427093814" MODIFIED="1566427093814" LINK="https://github.com/apache/zookeeper/releases"/>
<node TEXT="org.apache.zookeeper.server.quorum.QuorumPeerMain" ID="ID_206824252" CREATED="1566427485562" MODIFIED="1566427485562"/>
<node TEXT="https://stackoverflow.com/questions/28484398/starting-zookeeper-cluster-error-could-not-find-or-load-main-class-org-apache" ID="ID_1467809726" CREATED="1566468635439" MODIFIED="1566468637769" LINK="https://stackoverflow.com/questions/28484398/starting-zookeeper-cluster-error-could-not-find-or-load-main-class-org-apache"/>
<node TEXT="bin 사용하면 된다." ID="ID_285391809" CREATED="1566468645676" MODIFIED="1566468648800"/>
<node TEXT="java.lang.NumberFormatException: For input string: &quot;E:\apache-zookeeper-3.5.5-bin\apache-zookeeper-3.5.5-bin\bin\..\conf\zoo.cfg&quot;" ID="ID_468587348" CREATED="1566467811637" MODIFIED="1566467811637"/>
<node TEXT="https://stackoverflow.com/questions/11765015/zookeeper-not-starting" ID="ID_1327903559" CREATED="1566468540489" MODIFIED="1566468540489" LINK="https://stackoverflow.com/questions/11765015/zookeeper-not-starting"/>
</node>
<node TEXT="apche kafka" FOLDED="true" ID="ID_763869163" CREATED="1566475642179" MODIFIED="1569357318979">
<node TEXT="https://www.tutorialspoint.com/apache_kafka/apache_kafka_installation_steps.htm" ID="ID_1835305184" CREATED="1566475648870" MODIFIED="1566475648870" LINK="https://www.tutorialspoint.com/apache_kafka/apache_kafka_installation_steps.htm"/>
<node TEXT="https://www.tutorialspoint.com/apache_kafka/apache_kafka_basic_operations.htm" ID="ID_400486839" CREATED="1566553489038" MODIFIED="1566553668968" LINK="https://www.tutorialspoint.com/apache_kafka/apache_kafka_basic_operations.htm" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="중요한건 카프카 사용할때 먼저 주키퍼부터 켜야 한다는것. 이건 튜토리얼포인트에서도 나와있다." ID="ID_732690937" CREATED="1566565105480" MODIFIED="1566565165476"/>
</node>
<node TEXT="중요" FOLDED="true" ID="ID_535185704" CREATED="1566562855459" MODIFIED="1568739941087">
<node TEXT="주키퍼와 아파치와 카프카가 버젼을 많이 탄다." ID="ID_211822464" CREATED="1566562555491" MODIFIED="1566562766081"/>
<node TEXT="따라서 주키퍼를 따로 가져오고 카프카를 따로 가져오는것 보다, 그냥 카프카만 새로 가져오면 호환되는 주키퍼를 가지고 오니 그 안에 있는 주키퍼를 사용할것" ID="ID_1152726283" CREATED="1566562766780" MODIFIED="1566562791632"/>
<node TEXT="주키퍼에 카프카가 접속 할때, 해당 data를 저장해놓는데, 보통 /tmp/data 에 있다." ID="ID_178360045" CREATED="1566562887324" MODIFIED="1566562910512"/>
<node TEXT="E:\tmp\zookeeper\version-2" ID="ID_1052107545" CREATED="1566562942702" MODIFIED="1566562942702"/>
<node TEXT="근데 버젼이 한번 앵꼬가 나면 그냥 오류로 누워버리니, 그럴 때마다 저 부분을 삭제해주는게 좋다." ID="ID_531614027" CREATED="1566562954483" MODIFIED="1566562975072"/>
<node TEXT="https://stackoverflow.com/questions/44217654/how-to-recover-zookeeper-from-java-io-eofexception-after-a-server-crash" ID="ID_1292331256" CREATED="1566478762960" MODIFIED="1566478762960" LINK="https://stackoverflow.com/questions/44217654/how-to-recover-zookeeper-from-java-io-eofexception-after-a-server-crash"/>
<node TEXT="https://github.com/spring-projects/spring-kafka" ID="ID_846640087" CREATED="1566479885524" MODIFIED="1566479885524" LINK="https://github.com/spring-projects/spring-kafka"/>
<node TEXT="TOPIC이 중요한개념, 즉 방이라는 뜻" ID="ID_893255264" CREATED="1566566535130" MODIFIED="1566566544471"/>
</node>
<node TEXT="문제" FOLDED="true" ID="ID_774230446" CREATED="1566562637454" MODIFIED="1611910584298">
<node TEXT="Timeout expired while fetching topic metadata" ID="ID_1601511798" CREATED="1566547842069" MODIFIED="1566547842069"/>
<node TEXT="가장 지랄같았던 문제" ID="ID_676844990" CREATED="1566562993596" MODIFIED="1566562996420"/>
</node>
<node TEXT="https://stackoverflow.com/questions/53783938/org-springframework-context-applicationcontextexception-failed-to-start-bean-o" ID="ID_1760383901" CREATED="1566547902160" MODIFIED="1566547902160" LINK="https://stackoverflow.com/questions/53783938/org-springframework-context-applicationcontextexception-failed-to-start-bean-o"/>
<node TEXT="해결" ID="ID_1339774673" CREATED="1566562671012" MODIFIED="1617843620303">
<node TEXT="consumer 의 포트 또한 주키퍼가 아닌 카프카로 해야한다. 이부분은 tutorial point가 잘못된 것으로 보인다. 혹은 버젼때문에 달라진것일지도" ID="ID_776535020" CREATED="1566562673149" MODIFIED="1566564038755"/>
<node TEXT="즉 9092로 바꿔야 한다. 2181가 아니다." ID="ID_1105788051" CREATED="1566562703107" MODIFIED="1566562716072"/>
<node TEXT="소스" ID="ID_542782870" CREATED="1566563734709" MODIFIED="1566563735346">
<node TEXT="@Bean" ID="ID_1721883260" CREATED="1566563735744" MODIFIED="1566563735744"/>
<node TEXT="public ProducerFactory&lt;String, String&gt; producerFactory(){" ID="ID_444680598" CREATED="1566563735745" MODIFIED="1566563735745">
<node TEXT="Map&lt;String,Object&gt; configProps = new HashMap&lt;String,Object&gt;();" ID="ID_1365099931" CREATED="1566563735746" MODIFIED="1566563735746"/>
<node TEXT="configProps.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, &quot;localhost:9092&quot;);//이부분 2181가 아닌 9092로" ID="ID_763220060" CREATED="1566563735746" MODIFIED="1566563738016" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="configProps.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, StringSerializer.class);" ID="ID_108436216" CREATED="1566563735748" MODIFIED="1566563735748"/>
<node TEXT="configProps.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, StringSerializer.class);" ID="ID_975966887" CREATED="1566563735749" MODIFIED="1566563735749"/>
<node TEXT="return new DefaultKafkaProducerFactory&lt;&gt;(configProps);" ID="ID_891049033" CREATED="1566563735749" MODIFIED="1566563735749"/>
</node>
<node TEXT="}" ID="ID_1823132310" CREATED="1566563735750" MODIFIED="1566563735750"/>
</node>
</node>
<node TEXT="문제" FOLDED="true" ID="ID_1320166464" CREATED="1566562723888" MODIFIED="1568739918086">
<node TEXT="ERROR Processor got uncaught exception. (kafka.network.Processor)" ID="ID_1028533561" CREATED="1566549176467" MODIFIED="1566549176467"/>
</node>
<node TEXT="https://stackoverflow.com/questions/48927177/kafka-network-processor-error-in-producer-programarrayindexoutofboundsexception" ID="ID_1904675306" CREATED="1566549184006" MODIFIED="1566549184006" LINK="https://stackoverflow.com/questions/48927177/kafka-network-processor-error-in-producer-programarrayindexoutofboundsexception"/>
<node TEXT="https://spring.io/projects/spring-kafka" ID="ID_1537971679" CREATED="1566549390604" MODIFIED="1566549390604" LINK="https://spring.io/projects/spring-kafka"/>
<node TEXT="https://stackoverflow.com/questions/52983567/kafka0-9-0-0-gives-arrayindexoutofboundsexception" ID="ID_364203556" CREATED="1566552236723" MODIFIED="1566552236723" LINK="https://stackoverflow.com/questions/52983567/kafka0-9-0-0-gives-arrayindexoutofboundsexception"/>
<node TEXT="https://kafka.apache.org/downloads#2.0.1" ID="ID_1517387670" CREATED="1566553635685" MODIFIED="1566553636488" LINK="https://kafka.apache.org/downloads#2.0.1"/>
<node TEXT="https://kafka.apache.org/20/documentation.html#quickstart" ID="ID_1277349424" CREATED="1566555671862" MODIFIED="1566562652361" LINK="https://kafka.apache.org/20/documentation.html#quickstart"/>
<node TEXT="해결" ID="ID_845291995" CREATED="1566562640659" MODIFIED="1582459807222">
<node TEXT="현재 spring-kafka 에서 kafka-client의 버젼이 2.0.1이다." ID="ID_399619856" CREATED="1566552923891" MODIFIED="1566563952812"/>
<node TEXT="https://mvnrepository.com/artifact/org.springframework.kafka/spring-kafka/2.2.8.RELEASE" ID="ID_861517706" CREATED="1566563822347" MODIFIED="1566563823758" LINK="https://mvnrepository.com/artifact/org.springframework.kafka/spring-kafka/2.2.8.RELEASE"/>
<node TEXT="따라서 카프카 서버도 해당 버젼을 사용해야만 한다." ID="ID_1696938436" CREATED="1566563835973" MODIFIED="1566563960899"/>
<node TEXT="뒤에있는 버젼이 kafka-client 버젼인듯 하다(이미지) " ID="ID_1433526038" CREATED="1566563962487" MODIFIED="1566563963026">
<node ID="ID_1023412278" CREATED="1566553660976" MODIFIED="1566563834920"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_2173536735381487191.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="즉 버젼 문제이다." ID="ID_816554648" CREATED="1566562649444" MODIFIED="1566563986005"/>
<node TEXT="이 좆같은게 버젼이 따라서 명령어도 달라진다.(빡침)" ID="ID_760691310" CREATED="1566555609721" MODIFIED="1566564227955"/>
<node TEXT="튜토리얼 포인트 보다는 버젼에 맞는 doc를 참조하는게 좋다." ID="ID_1829197200" CREATED="1566563989822" MODIFIED="1566564018290"/>
<node TEXT="https://kafka.apache.org/20/documentation.html" ID="ID_776037760" CREATED="1566564083963" MODIFIED="1566564083963" LINK="https://kafka.apache.org/20/documentation.html"/>
<node TEXT="https://spring.io/projects/spring-kafka#learn" ID="ID_49839724" CREATED="1566564152021" MODIFIED="1566564152021" LINK="https://spring.io/projects/spring-kafka#learn"/>
</node>
<node TEXT="실행" FOLDED="true" ID="ID_351100597" CREATED="1566564249870" MODIFIED="1582459810989">
<node TEXT="메시지 전송과 받기(이미지)" ID="ID_188152713" CREATED="1566564251545" MODIFIED="1569404394910">
<node ID="ID_324749526" CREATED="1566564321328" MODIFIED="1566564321328"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_6312331157045623200.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="따로 콘솔에서 받기(이미지)" FOLDED="true" ID="ID_1289516077" CREATED="1566564270750" MODIFIED="1568739923049">
<node ID="ID_924420171" CREATED="1566564423949" MODIFIED="1566564423949"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_3104344258364705377.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="잘보면 콘솔에서 받기 할때도 9092인데 튜토리얼 포인트에서 2181 로 되어있다." ID="ID_956550789" CREATED="1566565013360" MODIFIED="1566565032748"/>
<node TEXT="명령어" ID="ID_43925296" CREATED="1566565812537" MODIFIED="1569404403832">
<node TEXT="주키퍼실행" ID="ID_730970808" CREATED="1566565819889" MODIFIED="1566565822006">
<node ID="ID_773623198" CREATED="1566565892414" MODIFIED="1568739953162"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <p>
      E:\BRT\kafka_2.11-2.0.1&gt;
    </p>
  </body>
</html>
</richcontent>
<node ID="ID_1704879667" CREATED="1567795257490" MODIFIED="1567795257493"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <p>
      bin\windows\zookeeper-server-start.bat config\zookeeper.properties
    </p>
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="카프카실행" ID="ID_1948237140" CREATED="1566565922544" MODIFIED="1566565924694">
<node ID="ID_616826091" CREATED="1566566124325" MODIFIED="1567795264232"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <p>
      E:\BRT\kafka_2.11-2.0.1&gt;
    </p>
  </body>
</html>
</richcontent>
<node ID="ID_276495592" CREATED="1567795264235" MODIFIED="1567795264239"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <p>
      bin\windows\kafka-server-start.bat config\server.properties
    </p>
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="보내기받기 이곳참고" ID="ID_1924425489" CREATED="1566566506674" MODIFIED="1566566509791">
<node TEXT="https://kafka.apache.org/quickstart#quickstart_send" ID="ID_1382332745" CREATED="1566566510093" MODIFIED="1566566510093" LINK="https://kafka.apache.org/quickstart#quickstart_send"/>
</node>
<node TEXT="springboot 실행(단축키누르자 그냥)" ID="ID_1441422343" CREATED="1566565926849" MODIFIED="1566565936509"/>
</node>
</node>
</node>
<node TEXT="twilio 오류" FOLDED="true" POSITION="right" ID="ID_1570463181" CREATED="1567514383933" MODIFIED="1621472968362">
<node TEXT="문제" ID="ID_23357300" CREATED="1567533567188" MODIFIED="1567533569334">
<node TEXT="Authentication Error - invalid username" ID="ID_1925461937" CREATED="1567514389176" MODIFIED="1567514389176"/>
</node>
<node TEXT="https://www.twilio.com/docs/libraries/java" ID="ID_1251405342" CREATED="1567533570814" MODIFIED="1567533592379" LINK="https://www.twilio.com/docs/libraries/java"/>
<node TEXT="해결" ID="ID_268792101" CREATED="1567533569786" MODIFIED="1567533570414">
<node TEXT="init 할때 변수명이 username,password로 되어있는데, 저곳에는 유저에 대한 정보가 아니라 ID와 token값을 입력해야 한다." ID="ID_250112871" CREATED="1567533593954" MODIFIED="1567533626533"/>
<node TEXT="또한 twili에서 번호를 받아야 하며, 해당 번호는 message를 보낼 때 from값에 넣어줘야 한다. 그렇지 않으면 씨알도 안먹힘을 명심하라" ID="ID_1972765338" CREATED="1567533637841" MODIFIED="1567533670567"/>
</node>
<node TEXT="문제" ID="ID_34394798" CREATED="1567539072548" MODIFIED="1567539073379">
<node TEXT="Account not authorized to call +82이하생략. Perhaps you need to enable some international permissions: https://www.twilio.com/console/voice/calls/geo-permissions/low-risk" ID="ID_1886263691" CREATED="1567539073678" MODIFIED="1567539081587" LINK="https://www.twilio.com/console/voice/calls/geo-permissions/low-risk"/>
</node>
<node TEXT="해결" ID="ID_910722538" CREATED="1567539087581" MODIFIED="1567539088483">
<node TEXT="주어진 사이트로 가서 일단 국가 클릭해놓음" ID="ID_1135191498" CREATED="1567539091214" MODIFIED="1567539101843"/>
</node>
</node>
<node TEXT="Unit Test Cases" FOLDED="true" POSITION="right" ID="ID_1017386506" CREATED="1567909143978" MODIFIED="1621472968362">
<node TEXT="문제" ID="ID_748592316" CREATED="1567909145995" MODIFIED="1567909148287">
<node TEXT="부팅해도 아무것도 뜨지 않는다." ID="ID_1771944278" CREATED="1567909149804" MODIFIED="1567909157446"/>
</node>
<node TEXT="해결" ID="ID_1779869352" CREATED="1567914233893" MODIFIED="1567914234809">
<node TEXT="maven install을 할시에 같이 실햋되는 것이지, 이클립스 안에서 디버그 할 때는 실행되지 않는다." ID="ID_371913256" CREATED="1567914235470" MODIFIED="1567914252337"/>
</node>
<node TEXT="문제" ID="ID_124274143" CREATED="1567914255526" MODIFIED="1567914256168">
<node TEXT="org.junit.ComparisonFailure: expected:&lt;Mock[ ]Name&gt; but was:&lt;Mock[]Name&gt;" ID="ID_1418202825" CREATED="1567915615667" MODIFIED="1567915615667"/>
</node>
<node TEXT="해결" ID="ID_51206383" CREATED="1567915704365" MODIFIED="1567915705809">
<node TEXT="두개가 같아야 할듯" ID="ID_24029366" CREATED="1567915706478" MODIFIED="1567915708793"/>
<node TEXT="이미지" ID="ID_1912566619" CREATED="1567915708990" MODIFIED="1567915710881">
<node ID="ID_287395478" CREATED="1567915711317" MODIFIED="1567915711317"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_3370019955237776890.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
</node>
<node TEXT="Database Handling" FOLDED="true" POSITION="right" ID="ID_1122918597" CREATED="1568042534093" MODIFIED="1621472968362">
<node TEXT="h2" ID="ID_1162996308" CREATED="1568042544125" MODIFIED="1569312233104" LINK="#ID_633062079"/>
<node TEXT="Redis" ID="ID_800868004" CREATED="1568042547757" MODIFIED="1568042550538">
<node TEXT="문제" ID="ID_138312707" CREATED="1568042551477" MODIFIED="1568042558257">
<node TEXT="jedis hostname이 deprecated임" ID="ID_224356156" CREATED="1568042558919" MODIFIED="1568042576721"/>
</node>
<node TEXT="해결" ID="ID_861407679" CREATED="1568042578294" MODIFIED="1568042578896">
<node TEXT="https://stackoverflow.com/questions/49021994/jedisconnectionfactory-sethostname-is-deprecated" ID="ID_424455188" CREATED="1568042600508" MODIFIED="1568042600508" LINK="https://stackoverflow.com/questions/49021994/jedisconnectionfactory-sethostname-is-deprecated"/>
<node TEXT="https://docs.spring.io/spring-data/data-redis/docs/current/reference/html/#get-started" ID="ID_1935792906" CREATED="1568043567248" MODIFIED="1568043569253" LINK="https://docs.spring.io/spring-data/data-redis/docs/current/reference/html/#get-started"/>
<node TEXT="RedisStandaloneConfiguration사용해라" ID="ID_164426431" CREATED="1568042611505" MODIFIED="1568042649457"/>
</node>
<node TEXT="문제" ID="ID_1311667910" CREATED="1568044712485" MODIFIED="1568044713210">
<node TEXT="The type redis.clients.jedis.JedisPoolConfig cannot be resolved" ID="ID_187839442" CREATED="1568044713465" MODIFIED="1568044722305"/>
</node>
<node TEXT="해결" ID="ID_376527001" CREATED="1568045091189" MODIFIED="1568045093690">
<node TEXT="https://www.concretepage.com/questions/599" ID="ID_1732477594" CREATED="1568045094026" MODIFIED="1568045094026" LINK="https://www.concretepage.com/questions/599"/>
<node TEXT="LettuceConnectionFactory 로 변경해서 진행해볼것" ID="ID_1297552016" CREATED="1568045188700" MODIFIED="1568045207537"/>
</node>
<node TEXT="문제" ID="ID_1101043057" CREATED="1568060266752" MODIFIED="1568060267474">
<node TEXT="Connection refused: no further information: localhost/127.0.0.1:6000" ID="ID_1454300097" CREATED="1568060267785" MODIFIED="1568060267785"/>
</node>
<node TEXT="해결" ID="ID_685378862" CREATED="1568065557804" MODIFIED="1568065559057">
<node TEXT="https://www.baeldung.com/java-redis-lettuce" ID="ID_1488974326" CREATED="1568065562827" MODIFIED="1568065562827" LINK="https://www.baeldung.com/java-redis-lettuce"/>
<node TEXT="luttech 사용법인데, 이곳에서 redis 설치법이 나온다." ID="ID_720283908" CREATED="1568065564330" MODIFIED="1568089392129"/>
<node TEXT="현재 windows 환경이니 windows git주소는 이렇다." ID="ID_135274014" CREATED="1568089446327" MODIFIED="1568089454873"/>
<node TEXT="https://github.com/MicrosoftArchive/redis" ID="ID_173439907" CREATED="1568089455621" MODIFIED="1568089455621" LINK="https://github.com/MicrosoftArchive/redis"/>
<node TEXT="이렇게 redis를 설치하고 실행한다.(이미지)" FOLDED="true" ID="ID_1413105240" CREATED="1568089473493" MODIFIED="1568090292425">
<node ID="ID_1300944335" CREATED="1568089569368" MODIFIED="1568089569368"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_7667580728636180695.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="데이터 저장 데이터 뽑기(이미지)" FOLDED="true" ID="ID_1934547715" CREATED="1568089575526" MODIFIED="1568090320791">
<node ID="ID_933854715" CREATED="1568090246011" MODIFIED="1568090246011"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_3578286928181540969.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="데이터 뽑을 시 결과" ID="ID_349432353" CREATED="1568090321533" MODIFIED="1568090330218">
<node TEXT="{eee=efef}" ID="ID_1338730690" CREATED="1568090326146" MODIFIED="1568090326146"/>
</node>
</node>
</node>
<node TEXT="JDBC TEMPLATE &amp;&amp; Multiple DataSource" ID="ID_433850" CREATED="1568090615245" MODIFIED="1569338423518">
<node TEXT="진행이미지" ID="ID_1945093058" CREATED="1568093379895" MODIFIED="1568093385396">
<node ID="ID_314664385" CREATED="1568093387037" MODIFIED="1568093387037"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_6044406536922202153.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
</node>
<node TEXT="springSecurity" FOLDED="true" POSITION="right" ID="ID_1513202297" CREATED="1568136171473" MODIFIED="1621472968362">
<node TEXT="문제" FOLDED="true" ID="ID_829841707" CREATED="1568136225277" MODIFIED="1619770110806">
<node TEXT="로그인 페이지로 안감" ID="ID_1806002014" CREATED="1568136227916" MODIFIED="1568136231017"/>
</node>
<node TEXT="해결" ID="ID_1242731002" CREATED="1568136231708" MODIFIED="1619770106710">
<node TEXT="configure를 해제함 (이미지)" FOLDED="true" ID="ID_1213230462" CREATED="1568136238597" MODIFIED="1568141282023">
<node ID="ID_1272586782" CREATED="1568141259587" MODIFIED="1568141259587"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_7515362011340452822.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="문제" ID="ID_1504682387" CREATED="1568141371182" MODIFIED="1619770107094">
<node TEXT="java.lang.IllegalArgumentException: There is no PasswordEncoder mapped for the id &quot;null&quot;" ID="ID_1417966876" CREATED="1568141414667" MODIFIED="1568141415770"/>
</node>
<node TEXT="해결" ID="ID_348260147" CREATED="1568141417725" MODIFIED="1619770107550">
<node TEXT="https://www.mkyong.com/spring-boot/spring-security-there-is-no-passwordencoder-mapped-for-the-id-null/" ID="ID_304229500" CREATED="1568141390123" MODIFIED="1568141419587" LINK="https://www.mkyong.com/spring-boot/spring-security-there-is-no-passwordencoder-mapped-for-the-id-null/"/>
<node TEXT="패스워드에 {noop}을 넣어줌" ID="ID_1325149619" CREATED="1568141425141" MODIFIED="1568141432370"/>
</node>
<node TEXT="이게 맞는가?" ID="ID_1819427320" CREATED="1568141454509" MODIFIED="1619770107918">
<node TEXT="그러면 대강 로그인이 성립이 됨" ID="ID_1503332080" CREATED="1568141435709" MODIFIED="1568141448106"/>
<node TEXT="그러나 이러한 방법은 custom login page가 먹히지 않는다는 단점이 존재함" ID="ID_149249130" CREATED="1568141461054" MODIFIED="1568141584426"/>
<node TEXT="또한 Angular에서 해당 페이지로 접근가능한 방법이 그렇게 유용하다고 볼 수는 없음" ID="ID_1225540165" CREATED="1568141616549" MODIFIED="1568141635250"/>
<node TEXT="어쨋든 일부러 이런 방식을 사용하여 angular에서 시도해야 함" ID="ID_1045235407" CREATED="1568141640389" MODIFIED="1568141655834"/>
</node>
<node TEXT="정리할 필요가 있다." ID="ID_708755987" CREATED="1568311134739" MODIFIED="1619770108270">
<node TEXT="일반적으로 form 형식으로 되어 있음을 알고 있어야 한다." ID="ID_920316633" CREATED="1568311139069" MODIFIED="1568311156343"/>
<node TEXT="로그인 과정(이미지)" FOLDED="true" ID="ID_1435451748" CREATED="1568313050329" MODIFIED="1569165897929">
<node ID="ID_242761916" CREATED="1568313055665" MODIFIED="1568313055665"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_7877622929877684556.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="여기서 csrf값은 계속 바뀌는 것을 명심해야 한다." ID="ID_1534782026" CREATED="1568313061591" MODIFIED="1568313069307"/>
<node TEXT="csrf에 대한 정석" FOLDED="true" ID="ID_770976836" CREATED="1568442100218" MODIFIED="1568563992734">
<node TEXT="https://itstory.tk/entry/CSRF-%EA%B3%B5%EA%B2%A9%EC%9D%B4%EB%9E%80-%EA%B7%B8%EB%A6%AC%EA%B3%A0-CSRF-%EB%B0%A9%EC%96%B4-%EB%B0%A9%EB%B2%95" ID="ID_1815280582" CREATED="1568443272583" MODIFIED="1568443273313" LINK="https://itstory.tk/entry/CSRF-%EA%B3%B5%EA%B2%A9%EC%9D%B4%EB%9E%80-%EA%B7%B8%EB%A6%AC%EA%B3%A0-CSRF-%EB%B0%A9%EC%96%B4-%EB%B0%A9%EB%B2%95"/>
<node TEXT="https://cheese10yun.github.io/spring-csrf/" ID="ID_302411213" CREATED="1568442104059" MODIFIED="1568442104059" LINK="https://cheese10yun.github.io/spring-csrf/"/>
</node>
<node TEXT="다음과 같은 설정을 하면 cookie에 csrf토큰이 만들어지면 그걸 parameter나 header에 넣어서 판단할 수 있음" FOLDED="true" ID="ID_903599090" CREATED="1568443275701" MODIFIED="1568564010903">
<node TEXT=".csrf().csrfTokenRepository(CookieCsrfTokenRepository.withHttpOnlyFalse()).and()" ID="ID_937158051" CREATED="1568450461305" MODIFIED="1568450461305"/>
<node TEXT="해당 key 값" ID="ID_1341482368" CREATED="1568451043395" MODIFIED="1568451052056">
<node ID="ID_1129280002" CREATED="1568451052477" MODIFIED="1568451052477"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_8332026707814930212.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="기본값은 HttpSessionCsrfTokenRepository으로 위와 같은 설정을 안하면 세션에 기록이 됨(이미지)" FOLDED="true" ID="ID_1185239794" CREATED="1568450468818" MODIFIED="1568564012047">
<node ID="ID_1201735062" CREATED="1568450513280" MODIFIED="1568450513280"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_6291916685446520198.jpeg" />
  </body>
</html>
</richcontent>
</node>
<node ID="ID_1258490975" CREATED="1568450883439" MODIFIED="1568450883439"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_1274980966365675840.jpeg" />
  </body>
</html>
</richcontent>
</node>
<node ID="ID_1812801222" CREATED="1568456733593" MODIFIED="1568456733593"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_6159957515725029981.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="로그아웃 과정(이미지)" ID="ID_1544244835" CREATED="1568313093366" MODIFIED="1619770114182">
<node ID="ID_479823995" CREATED="1568313117764" MODIFIED="1568313117764"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_4527473175593190141.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="기본적인 문서" FOLDED="true" ID="ID_1246584457" CREATED="1568313756080" MODIFIED="1568737238842">
<node TEXT="https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/" ID="ID_254142837" CREATED="1568313758137" MODIFIED="1568313758137" LINK="https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/"/>
</node>
<node TEXT="여기에 대한 기본적인 설명 및 해당 form을 ajax로 하여금 가져오는 링크는 다음과 같다." ID="ID_202724480" CREATED="1568313705816" MODIFIED="1568564022611">
<node TEXT="https://www.baeldung.com/securing-a-restful-web-service-with-spring-security" ID="ID_127590107" CREATED="1568313739355" MODIFIED="1568313739355" LINK="https://www.baeldung.com/securing-a-restful-web-service-with-spring-security"/>
<node TEXT="https://spring.io/guides/tutorials/spring-security-and-angular-js/" ID="ID_552933409" CREATED="1568314270324" MODIFIED="1568314270324" LINK="https://spring.io/guides/tutorials/spring-security-and-angular-js/"/>
</node>
<node TEXT="또 여기서 그냥 Rest형식으로 바로 로그인 하는 방법도 있다." ID="ID_282317820" CREATED="1568314272248" MODIFIED="1568564039412">
<node TEXT="https://medium.com/better-programming/secure-a-spring-boot-rest-api-with-json-web-token-reference-to-angular-integration-e57a25806c50" ID="ID_632823773" CREATED="1568314309740" MODIFIED="1568314309740" LINK="https://medium.com/better-programming/secure-a-spring-boot-rest-api-with-json-web-token-reference-to-angular-integration-e57a25806c50"/>
<node TEXT="https://cusonar.tistory.com/17" ID="ID_1531089535" CREATED="1568314315867" MODIFIED="1568314315867" LINK="https://cusonar.tistory.com/17"/>
</node>
</node>
<node TEXT="멀티 스프링 security" ID="ID_1302497736" CREATED="1568315248485" MODIFIED="1619770109030">
<node TEXT="https://www.baeldung.com/spring-security-multiple-entry-points" ID="ID_263805076" CREATED="1568315259848" MODIFIED="1568315259848" LINK="https://www.baeldung.com/spring-security-multiple-entry-points"/>
</node>
<node TEXT="context-path를 지우고 싶은데 지워지지가 않는다." ID="ID_800973937" CREATED="1568497135171" MODIFIED="1619770109470">
<node TEXT="config server가 문제였음" ID="ID_929977426" CREATED="1568663496555" MODIFIED="1568663501262"/>
</node>
<node TEXT="spring security basic" ID="ID_1288128307" CREATED="1568663501960" MODIFIED="1620638890499" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="기본적으로 spring security에 대한 csrf토큰이 주어지는걸 정확히 봐야한다. 해당 토큰을 헤더가 파라미터로 같이 날리지 않으면 허락된 경로를 제외하면 접근할 수 없고, 모든 post 기타 다른 method도 접근 할 수 없다. 이러한 토큰은 특정 이벤트일 때 계속 갱신되며, 외부에서 들어오는 자극이 허락없이 다가오는 것을 기필코 차단하는 역할을 한다. 일단 ANGULAR에서 진행 했을 때 많은 튜토리얼에서 이걸 그냥 disable을 시키는 걸로 자주 나오는데, 이는 결코 올바르지 않다. 일단 csrf토큰의 가장 큰 문제는 바로 쿠키이다. 이 쿠키는 JSESSIONID 그러니까 세션 유지와 더불어서 ANGULAR 개발 환경에서 매우 큰 문제로 다가온다. 클라이언트에서 그러니까 angular 개발 환경은 보통 4200 포트이며, 스프링은 보통 8080이다. 나는 8081로 사용하고 있다. 이렇게 클라이언트와 스프링을 분리시켜 클라이언트 단에서 rest api로만 스프링 그러니까 backend에 접근하는 것은 비교적 계속해서 많이 사용되고 있는 개발 방법이다. 일단 보통 쿠키가 setting 될 때는 domain과 path가 있는데 둘다 되게 좀 까다롭다고 해야 되나? &#xa;&#xa;일단 도메인부터 보자. 만약 127.0.0.1:4200에서 backend로 api를 쏠 때 127.0.0.1:8081/api/example 로 쏴서 응답으로 setcookie가 설정된다고 했을 때 해당 쿠키는 절대 127.0.0.1:4200 도메인을 기반으로 하여 setting이 되지 않는다. 이 쿠키는 127.0.0.1:8081 도메인에 저장이 된다. 그 말은 다시 말해서 4200에서 해당 쿠키를 가져올 수 없다는 뜻이다. " ID="ID_197443115" CREATED="1568663511472" MODIFIED="1568664991775"/>
<node TEXT="일단 이 문제를 해결하기 위해서는 angular proxy를 사용해야만 한다. 그것은 이 두곳을 참조하자" ID="ID_1349906789" CREATED="1568664372378" MODIFIED="1607406582465">
<node TEXT="https://angular.io/guide/build#proxying-to-a-backend-server" ID="ID_1700817127" CREATED="1568562749885" MODIFIED="1568562749885" LINK="https://angular.io/guide/build#proxying-to-a-backend-server"/>
<node TEXT="https://www.youtube.com/watch?v=OjmZPPKaj6A" ID="ID_431540356" CREATED="1568570863814" MODIFIED="1568570863814" LINK="https://www.youtube.com/watch?v=OjmZPPKaj6A"/>
</node>
<node TEXT="기본적으로 proxy.config.json을 하나 만든 다음에 어느 경로로 갈 때 해당 프록시가 작동할 것인지 세팅을 하고 그 타겟과 기타 다른 옵션들을 멕인다. 여기서 rewrite를 사용한건 바로 쿠키 path때문인데, 이 이야기도 또 골치아픈 이야기이다. 나중에하자. " FOLDED="true" ID="ID_1763991805" CREATED="1568664453114" MODIFIED="1570820267304">
<node TEXT="{" ID="ID_1350248403" CREATED="1568664495209" MODIFIED="1568664495209">
<node TEXT="&quot;/TctPro&quot;: {" ID="ID_1736778258" CREATED="1568664495210" MODIFIED="1568664495210">
<node TEXT="&quot;target&quot;: &quot;http://127.0.0.1:8081&quot;," ID="ID_1033973599" CREATED="1568664495210" MODIFIED="1568664495210" LINK="http://127.0.0.1:8081"/>
<node TEXT="&quot;secure&quot;: false," ID="ID_757475946" CREATED="1568664495211" MODIFIED="1568664495211"/>
<node TEXT="&quot;pathRewrite&quot;:{&quot;^/TctPro&quot; : &quot;http://127.0.0.1:8081/&quot;}" ID="ID_210704295" CREATED="1568664495212" MODIFIED="1570810092449" LINK="http://127.0.0.1:8081/">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_210704295" ENDARROW="Default" ENDINCLINATION="636;0;" ID="Arrow_ID_1531679497" SOURCE="ID_475053583" STARTARROW="None" STARTINCLINATION="636;0;"/>
<linktarget COLOR="#b0b0b0" DESTINATION="ID_210704295" ENDARROW="Default" ENDINCLINATION="1005;0;" ID="Arrow_ID_405561357" SOURCE="ID_888132635" STARTARROW="None" STARTINCLINATION="1005;0;"/>
</node>
</node>
<node TEXT="}" ID="ID_1237243598" CREATED="1568664495212" MODIFIED="1568664495212"/>
<node TEXT="}" ID="ID_738161014" CREATED="1568664495213" MODIFIED="1568664495213"/>
</node>
</node>
<node TEXT="아무튼 저 json에 대한 경로를 angular.json serve 밑에 설정해준다." FOLDED="true" ID="ID_1642365541" CREATED="1568664608328" MODIFIED="1570820269250">
<node TEXT="&quot;serve&quot;: {" ID="ID_877191603" CREATED="1568664658088" MODIFIED="1568664658088">
<node TEXT="&quot;builder&quot;: &quot;@angular-devkit/build-angular:dev-server&quot;," ID="ID_1789062431" CREATED="1568664658089" MODIFIED="1568664658089" LINK="mailto:%22@angular-devkit/build-angular:dev-server%22,"/>
<node TEXT="&quot;options&quot;: {" ID="ID_597419556" CREATED="1568664658094" MODIFIED="1568664658094">
<node TEXT="&quot;browserTarget&quot;: &quot;TheComment:build&quot;," ID="ID_1958313124" CREATED="1568664658095" MODIFIED="1568664658095"/>
<node TEXT="&quot;proxyConfig&quot;: &quot;proxy.conf.json&quot;" ID="ID_504572961" CREATED="1568664658096" MODIFIED="1568664664579" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
</node>
<node TEXT="}," ID="ID_646798335" CREATED="1568664658097" MODIFIED="1568664658097"/>
</node>
</node>
<node TEXT="그리고 ng serve를 해주면 프록시는 작동한다." ID="ID_1333269435" CREATED="1568664666115" MODIFIED="1568664696999"/>
<node TEXT="이렇게 프록시를 작동시키면 127.0.0.1:4200/TctPro/어쩌구저쩌구 로 접속해서 응답에 쿠키가 돌아올 때 해당 쿠키는 편법으로 127.0.0.1:4200에 저장된다. 일단 이러한 방법으로 분리된 개발환경에서의 쿠키 저장을 시작할 수 있다." ID="ID_546517317" CREATED="1568664697226" MODIFIED="1568664879375"/>
<node TEXT="두번 째로 바로 path이다. 이 path를 고치기 위해서 다음과 같은 pathRewirte를 사용했다." ID="ID_475053583" CREATED="1568664898499" MODIFIED="1570810092449">
<arrowlink DESTINATION="ID_210704295" STARTINCLINATION="476.99999 pt;0 pt;" ENDINCLINATION="476.99999 pt;0 pt;" STARTARROW="NONE" ENDARROW="DEFAULT"/>
</node>
<node TEXT="또 이 path는 다 발생하는 건 아니고, backEnd 개발 서버의 contextPath 라고 불리우는 127.0.0.1:8081/api 에서 /api따위를 말하는데, 이게 존재할 때 문제가 뱔생한다. 이게 만약 없고 /api가 아니라 그냥 / 라면 아무 문제가 없다." ID="ID_1663612441" CREATED="1568665036939" MODIFIED="1568665146552"/>
<node TEXT="그렇다. 이 contextPath를 제거하는 것이 바로 해결방법이다. 일단 서버의 contextPath를 제거하도록 하자. 뭔 미친소리냐고? 이 걸 안하면 더 복잡하게 문제를 해결해야 한다. 쿠키가 다름아닌 이 path로 저장되기 때문이다. 특정 path로 저장된 쿠키는 해당 path에 해당하지 않는 location에 있을 경우 보안상 절대로 해당 쿠키값을 쓰지 못하게 설정이 되어 있다." ID="ID_1372829765" CREATED="1568665176187" MODIFIED="1568665396096"/>
<node ID="ID_204700426" CREATED="1568665202916" MODIFIED="1568665466250"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <p>
      &#44032;&#51109; &#44036;&#45800;&#54620; &#48169;&#48277;&#51004;&#47196;&#45716; server.servlet.context-path= /TctPro &#46972;&#44256; &#46104;&#50612; &#51080;&#45716; &#48512;&#48516;&#51012; &#44536;&#45285; / &#47196; &#48320;&#44221;&#54616;&#45716; &#44163;&#51060;&#45796;. &#45800; &#51060; &#48169;&#48277;&#51008; spring boot &#48260;&#51260;&#51060; &#50612;&#45712;&#51221;&#46020; &#46104;&#50612;&#50556; &#54616;&#45716;&#45936;, &#44536;&#44172; 1.5.x &#51060;&#49345;&#51064;&#44032;? &#44536;&#47088;&#44152;&#47196; &#50508;&#44256; &#51080;&#45716;&#45936; &#51221;&#54869;&#54620;&#44148; &#51096; &#47784;&#47476;&#44192;&#45796;. &#52286;&#50500;&#48372;&#49884;&#46972;
    </p>
  </body>
</html>
</richcontent>
</node>
<node TEXT="아무튼 이렇게 변경을 한 다음과 같은 rewrite를 설정하여 특정 url에 proxy로 접속하게끔 한다. 해당 rewrite는 url이 http://127.0.0.1:8081/TctPro로 가지 않고,  http://127.0.0.1:8081/ 로 가게끔 하는 것이다." ID="ID_888132635" CREATED="1568665481180" MODIFIED="1568666701347">
<arrowlink DESTINATION="ID_210704295" STARTINCLINATION="753.74998 pt;0 pt;" ENDINCLINATION="753.74998 pt;0 pt;" STARTARROW="NONE" ENDARROW="DEFAULT"/>
</node>
<node TEXT="쿠키가 경로가 /에 생성되면 성공(이미지)" FOLDED="true" ID="ID_1841817901" CREATED="1568666853951" MODIFIED="1570820274986">
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1841817901" ENDARROW="Default" ENDINCLINATION="407;0;" ID="Arrow_ID_1802259037" SOURCE="ID_113071049" STARTARROW="None" STARTINCLINATION="407;0;"/>
<node ID="ID_1702345493" CREATED="1568666860789" MODIFIED="1568666860789"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_8158251256518827414.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="저런 경로가 설정이 되려면 자바 설정을 해야 한다." ID="ID_594438415" CREATED="1568666899527" MODIFIED="1568666909835"/>
<node TEXT="일단 spring-security에 대한 기본적인 설정을 해보도록 하자(이미지)" FOLDED="true" ID="ID_1041391217" CREATED="1568666911599" MODIFIED="1568738020196">
<node ID="ID_1791161635" CREATED="1568668505036" MODIFIED="1568668505036"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_8513178459649616628.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="성공 헨들러 실패 헨들러 메모리 로그인" FOLDED="true" ID="ID_353201337" CREATED="1568668823619" MODIFIED="1570820271618">
<node TEXT="@Override" ID="ID_1790047134" CREATED="1568668875570" MODIFIED="1568668875570"/>
<node TEXT="protected void configure(AuthenticationManagerBuilder auth) throws Exception {" ID="ID_1327178498" CREATED="1568668875572" MODIFIED="1568668875572">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1212027796" CREATED="1568668875573" MODIFIED="1568668875573"/>
<node TEXT="// super.configure(auth);" ID="ID_1558559559" CREATED="1568668875575" MODIFIED="1568668875575"/>
<node TEXT="auth.inMemoryAuthentication().withUser(&quot;user&quot;).password(&quot;{noop}password&quot;).roles(&quot;USER&quot;);" ID="ID_1254449445" CREATED="1568668875576" MODIFIED="1568668875576"/>
</node>
<node TEXT="}" ID="ID_291999056" CREATED="1568668875578" MODIFIED="1568668875578"/>
<node TEXT="private AuthenticationSuccessHandler successHandler() {" ID="ID_32617329" CREATED="1568668875579" MODIFIED="1568668875579">
<node TEXT="return new AuthenticationSuccessHandler() {" ID="ID_1720817196" CREATED="1568668875581" MODIFIED="1568668875581">
<node TEXT="@Override" ID="ID_79372223" CREATED="1568668875584" MODIFIED="1568668875584"/>
<node TEXT="public void onAuthenticationSuccess(HttpServletRequest httpServletRequest," ID="ID_1514790831" CREATED="1568668875585" MODIFIED="1568668875585">
<node TEXT="HttpServletResponse httpServletResponse, Authentication authentication)" ID="ID_967079085" CREATED="1568668875585" MODIFIED="1568668875585"/>
<node TEXT="throws IOException, ServletException {" ID="ID_1667972080" CREATED="1568668875586" MODIFIED="1568668875586"/>
<node TEXT="System.out.println(&quot;성공&quot;);" ID="ID_1613738274" CREATED="1568668875587" MODIFIED="1568668875587"/>
<node TEXT="httpServletResponse.getWriter().append(&quot;OK&quot;);" ID="ID_1980797032" CREATED="1568668875587" MODIFIED="1568668875587"/>
<node TEXT="httpServletResponse.setStatus(200);" ID="ID_974778771" CREATED="1568668875587" MODIFIED="1568668875587"/>
</node>
<node TEXT="}" ID="ID_890132239" CREATED="1568668875588" MODIFIED="1568668875588"/>
</node>
<node TEXT="};" ID="ID_126309015" CREATED="1568668875588" MODIFIED="1568668875588"/>
</node>
<node TEXT="}" ID="ID_1113110173" CREATED="1568668875588" MODIFIED="1568668875588"/>
<node TEXT="private AuthenticationFailureHandler failureHandler() {" ID="ID_1617208207" CREATED="1568668875589" MODIFIED="1568668875589">
<node TEXT="return new AuthenticationFailureHandler() {" ID="ID_1930211454" CREATED="1568668875589" MODIFIED="1568668875589">
<node TEXT="@Override" ID="ID_1823672506" CREATED="1568668875590" MODIFIED="1568668875590"/>
<node TEXT="public void onAuthenticationFailure(HttpServletRequest httpServletRequest," ID="ID_485560004" CREATED="1568668875591" MODIFIED="1568668875591">
<node TEXT="HttpServletResponse httpServletResponse, AuthenticationException e)" ID="ID_468805904" CREATED="1568668875591" MODIFIED="1568668875591"/>
<node TEXT="throws IOException, ServletException {" ID="ID_1716903856" CREATED="1568668875592" MODIFIED="1568668875592"/>
<node TEXT="System.out.println(&quot;실패&quot;);" ID="ID_1771204847" CREATED="1568668875592" MODIFIED="1568668875592"/>
<node TEXT="httpServletResponse.getWriter().append(&quot;Authentication failure&quot;);" ID="ID_1502820805" CREATED="1568668875593" MODIFIED="1568668875593"/>
<node TEXT="httpServletResponse.setStatus(401);" ID="ID_582928320" CREATED="1568668875593" MODIFIED="1568668875593"/>
</node>
<node TEXT="}" ID="ID_592980048" CREATED="1568668875594" MODIFIED="1568668875594"/>
</node>
<node TEXT="};" ID="ID_169926906" CREATED="1568668875594" MODIFIED="1568668875594"/>
</node>
<node TEXT="}" ID="ID_1109056889" CREATED="1568668875594" MODIFIED="1568668875594"/>
</node>
<node TEXT="로그인페이지에 오자마자 따로 restApi를 날리기 위해 다음과 같은 클래스를 만들 필요가 있었다." FOLDED="true" ID="ID_1842175976" CREATED="1568668975563" MODIFIED="1602138253797">
<node TEXT="import java.util.HashMap;" ID="ID_1766726331" CREATED="1568669298208" MODIFIED="1568669298208"/>
<node TEXT="import java.util.Map;" ID="ID_553162380" CREATED="1568669298209" MODIFIED="1568669298209"/>
<node TEXT="import javax.servlet.http.HttpServletRequest;" ID="ID_1247677553" CREATED="1568669298210" MODIFIED="1568669298210"/>
<node TEXT="import javax.servlet.http.HttpSession;" ID="ID_840248452" CREATED="1568669298210" MODIFIED="1568669298210"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_961810442" CREATED="1568669298211" MODIFIED="1568669298211"/>
<node TEXT="import org.springframework.security.authentication.AuthenticationManager;" ID="ID_1734227499" CREATED="1568669298212" MODIFIED="1568669298212"/>
<node TEXT="import org.springframework.security.web.csrf.CookieCsrfTokenRepository;" ID="ID_1172687974" CREATED="1568669298213" MODIFIED="1568669298213"/>
<node TEXT="import org.springframework.security.web.csrf.CsrfToken;" ID="ID_588909856" CREATED="1568669298214" MODIFIED="1568669298214"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestMapping;" ID="ID_235819602" CREATED="1568669298215" MODIFIED="1568669298215"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestMethod;" ID="ID_217290517" CREATED="1568669298216" MODIFIED="1568669298216"/>
<node TEXT="import org.springframework.web.bind.annotation.RestController;" ID="ID_1816926438" CREATED="1568669298217" MODIFIED="1568669298217"/>
<node TEXT="import com.framework.Tct.Const.PublicConst;" ID="ID_410562433" CREATED="1568669298218" MODIFIED="1568669298218"/>
<node TEXT="@RestController" ID="ID_171214766" CREATED="1568669298219" MODIFIED="1568669298219"/>
<node TEXT="public class LoginRestController {" ID="ID_681678010" CREATED="1568669298220" MODIFIED="1568669298220">
<node TEXT="@Autowired" ID="ID_1588890010" CREATED="1568669298220" MODIFIED="1568669298220"/>
<node TEXT="HttpSession session;" ID="ID_1172341014" CREATED="1568669298222" MODIFIED="1568669298222"/>
<node TEXT="@Autowired" ID="ID_867432625" CREATED="1568669298223" MODIFIED="1568669298223"/>
<node TEXT="HttpServletRequest request;" ID="ID_1498438841" CREATED="1568669298223" MODIFIED="1568669298223"/>
<node TEXT="@Autowired" ID="ID_673076094" CREATED="1568669298224" MODIFIED="1568669298224"/>
<node TEXT="CookieCsrfTokenRepository cookieTokenMaker;" ID="ID_1756823012" CREATED="1568669298225" MODIFIED="1568669298225"/>
<node TEXT="@RequestMapping(value=&quot;/getCsrfToken&quot;,method=RequestMethod.GET)" ID="ID_690462609" CREATED="1568669298225" MODIFIED="1568669298225"/>
<node TEXT="public void getCsrf() {" ID="ID_1433459330" CREATED="1568669298226" MODIFIED="1568669298226"/>
</node>
<node TEXT="//                CsrfToken csrfToken = (CsrfToken)session.getAttribute(PublicConst.SPRING_SCURITY.CSRF_TOKEN);" ID="ID_1897583753" CREATED="1568669298226" MODIFIED="1568669298226"/>
<node TEXT="//                System.out.println(csrfToken.getToken());" ID="ID_585396394" CREATED="1568669298227" MODIFIED="1568669298227">
<node TEXT="Map&lt;String,Object&gt; map = new HashMap&lt;String,Object&gt;();" ID="ID_207816903" CREATED="1568669298228" MODIFIED="1568669298228"/>
<node TEXT="CsrfToken csrf = cookieTokenMaker.loadToken(request);" ID="ID_794519506" CREATED="1568669298228" MODIFIED="1568669298228"/>
<node TEXT="if(csrf == null) {" ID="ID_748172336" CREATED="1568669298229" MODIFIED="1568669298229">
<node TEXT="csrf =cookieTokenMaker.generateToken(request);" ID="ID_1589982305" CREATED="1568669298229" MODIFIED="1568669298229"/>
</node>
<node TEXT="}" ID="ID_1944300055" CREATED="1568669298229" MODIFIED="1568669298229"/>
</node>
<node TEXT="//                map.put(&quot;value&quot;, cookieTokenMaker.loadToken(request).getToken());" ID="ID_1001302108" CREATED="1568669298230" MODIFIED="1568669298230"/>
<node TEXT="//                map.put(&quot;sessionId&quot;, session.getId());" ID="ID_1049578489" CREATED="1568669298230" MODIFIED="1568669298230">
<node TEXT="//return map;" ID="ID_491728959" CREATED="1568669298230" MODIFIED="1568669298230"/>
<node TEXT="}" ID="ID_1226991464" CREATED="1568669298231" MODIFIED="1568669298231"/>
</node>
<node TEXT="}" ID="ID_818055302" CREATED="1568669298231" MODIFIED="1568669298231"/>
</node>
<node TEXT="해당 api는 angular 페이지에 왔을 때 바로 날리도록 해서 만약 csrf 토큰이 없을 때 해당 토큰을 만들도록 해준다. 이 토큰은 쿠키에 자동으로 생성된다." ID="ID_113071049" CREATED="1568669331301" MODIFIED="1568669559927">
<arrowlink DESTINATION="ID_1841817901" STARTINCLINATION="305.24999 pt;0 pt;" ENDINCLINATION="305.24999 pt;0 pt;" STARTARROW="NONE" ENDARROW="DEFAULT"/>
</node>
<node TEXT="spring security에서 login 경로를 설정했기 때문에 login 페이지를 따로 설정을 해놔야 한다." ID="ID_1309645305" CREATED="1568738021077" MODIFIED="1620638890519">
<node TEXT="package com.framework.Tct.login;" ID="ID_877568003" CREATED="1568738075346" MODIFIED="1568738075346"/>
<node TEXT="import org.springframework.stereotype.Controller;" ID="ID_1308614240" CREATED="1568738075348" MODIFIED="1568738075348"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestMapping;" ID="ID_1167498941" CREATED="1568738075349" MODIFIED="1568738075349"/>
<node TEXT="@Controller" ID="ID_1250651726" CREATED="1568738075350" MODIFIED="1568738075350"/>
<node TEXT="public class LoginController {" ID="ID_1738578126" CREATED="1568738075351" MODIFIED="1568738075351">
<node TEXT="@RequestMapping(&quot;/login&quot;)" ID="ID_143028139" CREATED="1568738075351" MODIFIED="1568738075351"/>
<node TEXT="public String loginPage() {" ID="ID_1832292376" CREATED="1568738075352" MODIFIED="1568738075352">
<node TEXT="return &quot;login&quot;;" ID="ID_1162514129" CREATED="1568738075353" MODIFIED="1568738075353"/>
</node>
<node TEXT="}" ID="ID_938071136" CREATED="1568738075354" MODIFIED="1568738075354"/>
</node>
<node TEXT="//" ID="ID_1339442385" CREATED="1568738075355" MODIFIED="1568738075355"/>
<node TEXT="//        @RequestMapping(&quot;/logout&quot;)" ID="ID_699454020" CREATED="1568738075355" MODIFIED="1568738075355"/>
<node TEXT="//        public String logoutPage() {" ID="ID_1252420838" CREATED="1568738075357" MODIFIED="1568738075357"/>
<node TEXT="//                return &quot;/&quot;;" ID="ID_1413645941" CREATED="1568738075357" MODIFIED="1568738075357"/>
<node TEXT="//        }" ID="ID_3172789" CREATED="1568738075358" MODIFIED="1568738075358"/>
<node TEXT="}" ID="ID_1009708938" CREATED="1568738075359" MODIFIED="1568738075359"/>
</node>
<node TEXT="해당 토큰을 받았으면 이 토큰을 헤더에 붙이거나 파라미터에 붙여서 같이 보내야 한다." ID="ID_1726759042" CREATED="1568669653157" MODIFIED="1568669692610"/>
<node TEXT="이걸 자동화 하려면 angular httpInterceptor 기능을 이용하면 된다. 거기에 대한 내용은 이곳을 참조하면 된다." FOLDED="true" ID="ID_1591915430" CREATED="1568669708340" MODIFIED="1602138257805">
<node TEXT="https://angular.io/api/common/http/HttpInterceptor" ID="ID_369433407" CREATED="1568624295861" MODIFIED="1568624295861" LINK="https://angular.io/api/common/http/HttpInterceptor"/>
<node TEXT="https://blog.angularindepth.com/top-10-ways-to-use-interceptors-in-angular-db450f8a62d6" ID="ID_574785617" CREATED="1568628813376" MODIFIED="1568628813376" LINK="https://blog.angularindepth.com/top-10-ways-to-use-interceptors-in-angular-db450f8a62d6"/>
</node>
<node TEXT="일단 타입스크립트 상에 클래스 하나를 export로 만든다." FOLDED="true" ID="ID_686893131" CREATED="1568670098949" MODIFIED="1570820272160">
<node TEXT="import { HttpInterceptor, HttpRequest, HttpHandler, HttpEvent } from &quot;@angular/common/http&quot;;" ID="ID_357727187" CREATED="1568670125411" MODIFIED="1568670125411" LINK="mailto:%22@angular/common/http%22;"/>
<node TEXT="import { Injectable } from &apos;@angular/core&apos;;" ID="ID_729557233" CREATED="1568670125415" MODIFIED="1568670125415"/>
<node TEXT="import { Observable } from &apos;rxjs&apos;;" ID="ID_783014335" CREATED="1568670125416" MODIFIED="1568670125416"/>
<node TEXT="import { analyzeAndValidateNgModules } from &apos;@angular/compiler&apos;;" ID="ID_1325248354" CREATED="1568670125416" MODIFIED="1568670125416"/>
<node TEXT="declare const Cookies:any;" ID="ID_948306687" CREATED="1568670125417" MODIFIED="1568670125417"/>
<node TEXT="@Injectable()" ID="ID_1466203171" CREATED="1568670125417" MODIFIED="1568670125417"/>
<node TEXT="export class AuthInterceptor implements HttpInterceptor{" ID="ID_1089247549" CREATED="1568670125417" MODIFIED="1568670125417">
<node TEXT="intercept(req:HttpRequest&lt;any&gt;, next: HttpHandler): Observable&lt;HttpEvent&lt;any&gt;&gt; {" ID="ID_767517410" CREATED="1568670125418" MODIFIED="1568670125418">
<node TEXT="let headerSet:any = {};" ID="ID_1957186656" CREATED="1568670125418" MODIFIED="1568670125418"/>
<node TEXT="if(Cookies.get(&quot;XSRF-TOKEN&quot;) != undefined){" ID="ID_1890704981" CREATED="1568670125419" MODIFIED="1568670125419">
<node TEXT="headerSet[&quot;X-XSRF-TOKEN&quot;] = Cookies.get(&quot;XSRF-TOKEN&quot;);" ID="ID_432089754" CREATED="1568670125419" MODIFIED="1568670125419"/>
</node>
<node TEXT="}" ID="ID_1789706662" CREATED="1568670125419" MODIFIED="1568670125419"/>
<node TEXT="let clonedreq:HttpRequest&lt;any&gt; = req.clone({" ID="ID_649458384" CREATED="1568670125420" MODIFIED="1568670125420">
<node TEXT="setHeaders:headerSet" ID="ID_772448184" CREATED="1568670125420" MODIFIED="1568670125420"/>
</node>
<node TEXT="});" ID="ID_1851683546" CREATED="1568670125420" MODIFIED="1568670125420"/>
<node TEXT="console.log(Cookies.get(&quot;XSRF-TOKEN&quot;));" ID="ID_1037474034" CREATED="1568670125420" MODIFIED="1568670125420"/>
<node TEXT="return next.handle(clonedreq);" ID="ID_1846954500" CREATED="1568670125421" MODIFIED="1568670125421"/>
</node>
<node TEXT="}" ID="ID_967461625" CREATED="1568670125421" MODIFIED="1568670125421"/>
</node>
<node TEXT="}" ID="ID_1184829650" CREATED="1568670125421" MODIFIED="1568670125421"/>
</node>
<node TEXT="여기서 헤더 이름과 쿠키 이름에 대한 내용은 해당 class를 직접 찾아보면 다 정의가 되어 있으며, 이에 대한 내용을 따로 public으로 세팅 가능하게 해놓았다(이미지)" FOLDED="true" ID="ID_1100246973" CREATED="1568735927085" MODIFIED="1568737225430">
<node ID="ID_818666511" CREATED="1568735975347" MODIFIED="1568735975347"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_4496022502505085163.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="그리고 app.module.ts provider에 다음을 추가하면 된다." FOLDED="true" ID="ID_309333751" CREATED="1568670157254" MODIFIED="1568738020200">
<node TEXT="providers: [MyServiceService," ID="ID_1878878483" CREATED="1568735007005" MODIFIED="1568735007005">
<node TEXT="AlbumFetchService," ID="ID_760155269" CREATED="1568735007006" MODIFIED="1568735007006"/>
<node TEXT="CommonData," ID="ID_1803435393" CREATED="1568735007006" MODIFIED="1568735007006"/>
<node TEXT="ProductServiceService," ID="ID_1267283709" CREATED="1568735007007" MODIFIED="1568735007007"/>
<node TEXT="AuthService," ID="ID_1104222581" CREATED="1568735007007" MODIFIED="1568735007007"/>
<node TEXT="{provide:MAT_DATE_LOCALE,useValue:&apos;ko&apos;}," ID="ID_382047384" CREATED="1568735007007" MODIFIED="1568735007007"/>
<node TEXT="{provide:MAT_DATE_FORMATS,useValue:KoreaDateFormat}," ID="ID_1263472419" CREATED="1568735007008" MODIFIED="1568735007008"/>
<node TEXT="{provide:HTTP_INTERCEPTORS," ID="ID_1312059342" CREATED="1568735007008" MODIFIED="1568735009800" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="useClass:AuthInterceptor," ID="ID_679236962" CREATED="1568735007009" MODIFIED="1568735010123" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="multi:true" ID="ID_1206522857" CREATED="1568735007009" MODIFIED="1568735010974" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="}]," ID="ID_523911312" CREATED="1568735007009" MODIFIED="1568735014708" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
</node>
</node>
<node TEXT="formHTML" ID="ID_1749454765" CREATED="1568741228095" MODIFIED="1602138257943">
<node TEXT="&lt;form [formGroup]=&quot;loginData&quot; (ngSubmit)=&quot;loginFunction(loginData.value)&quot;&gt;" ID="ID_1104694211" CREATED="1568741233256" MODIFIED="1568741233256">
<node TEXT="&lt;input required type=&quot;username&quot; name=&quot;username&quot; placeholder=&quot;username&quot; formControlName=&quot;username&quot;&gt;" ID="ID_1261357575" CREATED="1568741233256" MODIFIED="1568741233256"/>
<node TEXT="&lt;br&gt;" ID="ID_1739475338" CREATED="1568741233257" MODIFIED="1568741233257"/>
<node TEXT="&lt;input required type=&quot;password&quot; name=&quot;password&quot; placeholder=&quot;password&quot; formControlName=&quot;password&quot;&gt;" ID="ID_427819302" CREATED="1568741233258" MODIFIED="1568741233258"/>
<node TEXT="&lt;br&gt;" ID="ID_361267895" CREATED="1568741233259" MODIFIED="1568741233259"/>
<node TEXT="&lt;input [disabled]=&quot;!loginData.valid&quot; type=&quot;submit&quot; value=&quot;submit&quot;&gt;" ID="ID_50891559" CREATED="1568741233259" MODIFIED="1568741233259"/>
</node>
<node TEXT="&lt;/form&gt;" ID="ID_1382724874" CREATED="1568741233260" MODIFIED="1568741233260"/>
</node>
<node TEXT="form 타입스크립트 날리는거" FOLDED="true" ID="ID_864068231" CREATED="1568741234567" MODIFIED="1570820274989">
<node TEXT="loginFunction(data: any) {" ID="ID_234605240" CREATED="1568741315418" MODIFIED="1568741315418">
<node TEXT="// this.token.value = Cookies.get(&quot;XSRF-TOKEN&quot;)" ID="ID_1085024778" CREATED="1568741315421" MODIFIED="1568741315421">
<node TEXT="//console.log(data);" ID="ID_1610725365" CREATED="1568741315423" MODIFIED="1568741315423"/>
<node TEXT="let form_data = new FormData();" ID="ID_1847036840" CREATED="1568741315423" MODIFIED="1568741315423"/>
<node TEXT="for (var key in data) {" ID="ID_45567154" CREATED="1568741315424" MODIFIED="1568741315424">
<node TEXT="form_data.append(key, data[key]);" ID="ID_1704688550" CREATED="1568741315425" MODIFIED="1568741315425"/>
</node>
<node TEXT="}" ID="ID_712498093" CREATED="1568741315425" MODIFIED="1568741315425"/>
<node TEXT="//console.log(this.token.value);" ID="ID_809882250" CREATED="1568741315426" MODIFIED="1568741315426"/>
</node>
<node TEXT="// form_data.append(&quot;_csrf&quot;,this.token.value);" ID="ID_490071375" CREATED="1568741315426" MODIFIED="1568741315426">
<node TEXT="console.log(form_data);" ID="ID_11578472" CREATED="1568741315427" MODIFIED="1568741315427"/>
<node TEXT="this.authService.login(form_data).subscribe(" ID="ID_1287091697" CREATED="1568741315428" MODIFIED="1568741315428">
<node TEXT="(next) =&gt; {" ID="ID_1676923333" CREATED="1568741315429" MODIFIED="1568741315429">
<node TEXT="console.log(next);" ID="ID_1742170312" CREATED="1568741315429" MODIFIED="1568741315429"/>
</node>
<node TEXT="}, (error) =&gt; {" ID="ID_1037437416" CREATED="1568741315430" MODIFIED="1568741315430">
<node TEXT="console.log(error);" ID="ID_255869947" CREATED="1568741315430" MODIFIED="1568741315430"/>
</node>
<node TEXT="}" ID="ID_1803571619" CREATED="1568741315431" MODIFIED="1568741315431"/>
</node>
<node TEXT=")" ID="ID_1517375707" CREATED="1568741315432" MODIFIED="1568741315432"/>
</node>
<node TEXT="}" ID="ID_687616005" CREATED="1568741315432" MODIFIED="1568741315432"/>
</node>
</node>
<node TEXT="추가한 헤더의 모습(이미지)" FOLDED="true" ID="ID_1236794043" CREATED="1568702689480" MODIFIED="1568738020201">
<node ID="ID_1624008439" CREATED="1568702692968" MODIFIED="1568702692968"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_8883094490801992403.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="spring security basic REST" FOLDED="true" ID="ID_1720247770" CREATED="1568825025060" MODIFIED="1602652723460">
<node TEXT="참고" ID="ID_1441480668" CREATED="1568825056017" MODIFIED="1568827674590">
<node TEXT="https://medium.com/better-programming/secure-a-spring-boot-rest-api-with-json-web-token-reference-to-angular-integration-e57a25806c50" ID="ID_1158749410" CREATED="1568314309740" MODIFIED="1568314309740" LINK="https://medium.com/better-programming/secure-a-spring-boot-rest-api-with-json-web-token-reference-to-angular-integration-e57a25806c50"/>
<node TEXT="https://cusonar.tistory.com/17" ID="ID_131220175" CREATED="1568314315867" MODIFIED="1568314315867" LINK="https://cusonar.tistory.com/17"/>
</node>
<node TEXT="form login 주석처리" ID="ID_1162053566" CREATED="1568825137185" MODIFIED="1568827676423">
<node TEXT="http.cors().and()" ID="ID_1390774672" CREATED="1568825140508" MODIFIED="1568825140508">
<node TEXT="//.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS).and()" ID="ID_429236710" CREATED="1568825140509" MODIFIED="1568828074162"/>
<node TEXT="//.csrf().disable()" ID="ID_955624688" CREATED="1568825140510" MODIFIED="1568825140510"/>
<node TEXT=".csrf().csrfTokenRepository(getCookieCsfrTokenRepository()).and()" ID="ID_291433311" CREATED="1568825140510" MODIFIED="1568825140510"/>
<node TEXT="//.csrf().csrfTokenRepository(sessionCsrf).and()" ID="ID_1374450572" CREATED="1568825140511" MODIFIED="1568825140511"/>
<node TEXT=".authorizeRequests().antMatchers(&quot;/&quot;, &quot;/*.js&quot;, &quot;/*.css&quot;, &quot;/assets/**&quot;, &quot;/Home/**&quot;, &quot;/getCsrfToken&quot;,&quot;/login&quot;)" ID="ID_202140551" CREATED="1568825140511" MODIFIED="1568825140511"/>
<node TEXT=".permitAll()" ID="ID_365015028" CREATED="1568825140514" MODIFIED="1568825140514"/>
<node TEXT=".anyRequest().authenticated().and()" ID="ID_1622258184" CREATED="1568825140515" MODIFIED="1568825140515"/>
</node>
<node TEXT="//                                .formLogin()" ID="ID_1680683111" CREATED="1568825140515" MODIFIED="1568825146741" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="//                                .successHandler(successHandler())" ID="ID_1879245765" CREATED="1568825140516" MODIFIED="1568825147051" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="//                                .failureHandler(failureHandler())" ID="ID_4185786" CREATED="1568825140516" MODIFIED="1568825147370" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="//                            .loginPage(&quot;/login&quot;).permitAll().and()" ID="ID_1065124765" CREATED="1568825140516" MODIFIED="1568825148634" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT=".logout().permitAll();" ID="ID_972238839" CREATED="1568825140517" MODIFIED="1568825153306">
<font NAME="SansSerif" SIZE="12"/>
</node>
<node TEXT="}" ID="ID_1876401799" CREATED="1568825140517" MODIFIED="1568825148628"/>
</node>
</node>
<node TEXT="인증메니저 bean" ID="ID_977753099" CREATED="1568825174601" MODIFIED="1568827681011">
<node TEXT="@Bean" ID="ID_804932033" CREATED="1568825179884" MODIFIED="1568825179884"/>
<node TEXT="public AuthenticationManager getAuthenticationManager() throws Exception {" ID="ID_1713954377" CREATED="1568825179886" MODIFIED="1568825179886">
<node TEXT="return super.authenticationManager();" ID="ID_400910032" CREATED="1568825179888" MODIFIED="1568825179888"/>
</node>
<node TEXT="}" ID="ID_1061637935" CREATED="1568825179890" MODIFIED="1568825179890"/>
</node>
<node ID="ID_1399128282" CREATED="1568825257394" MODIFIED="1568828046675"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <p>
      loginCotroller &#47484; &#51228;&#50808;&#49884;&#53412;&#44256;, RestController login &#52628;&#44032; &#49884;&#53412;&#44592;<br />&#52628;&#44032;&#51201;&#51004;&#47196; csrf &#44081;&#49888;
    </p>
  </body>
</html>
</richcontent>
<node TEXT="package com.framework.Tct.login;" ID="ID_1988254913" CREATED="1568825310329" MODIFIED="1568825310329"/>
<node TEXT="import java.util.HashMap;" ID="ID_634375646" CREATED="1568825310333" MODIFIED="1568825310333"/>
<node TEXT="import java.util.Map;" ID="ID_27981646" CREATED="1568825310334" MODIFIED="1568825310334"/>
<node TEXT="import javax.servlet.http.HttpServletRequest;" ID="ID_573789406" CREATED="1568825310336" MODIFIED="1568825310336"/>
<node TEXT="import javax.servlet.http.HttpSession;" ID="ID_741474285" CREATED="1568825310337" MODIFIED="1568825310337"/>
<node TEXT="import org.apache.http.auth.UsernamePasswordCredentials;" ID="ID_1295060477" CREATED="1568825310339" MODIFIED="1568825310339"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_1109260268" CREATED="1568825310341" MODIFIED="1568825310341"/>
<node TEXT="import org.springframework.security.authentication.AuthenticationManager;" ID="ID_1374853026" CREATED="1568825310343" MODIFIED="1568825310343"/>
<node TEXT="import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;" ID="ID_520132826" CREATED="1568825310345" MODIFIED="1568825310345"/>
<node TEXT="import org.springframework.security.core.Authentication;" ID="ID_1873566733" CREATED="1568825310346" MODIFIED="1568825310346"/>
<node TEXT="import org.springframework.security.core.context.SecurityContextHolder;" ID="ID_65771405" CREATED="1568825310347" MODIFIED="1568825310347"/>
<node TEXT="import org.springframework.security.web.context.HttpSessionSecurityContextRepository;" ID="ID_1965540003" CREATED="1568825310348" MODIFIED="1568825310348"/>
<node TEXT="import org.springframework.security.web.csrf.CookieCsrfTokenRepository;" ID="ID_1132553339" CREATED="1568825310349" MODIFIED="1568825310349"/>
<node TEXT="import org.springframework.security.web.csrf.CsrfToken;" ID="ID_1168900203" CREATED="1568825310350" MODIFIED="1568825310350"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestBody;" ID="ID_680347443" CREATED="1568825310350" MODIFIED="1568825310350"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestMapping;" ID="ID_1268705462" CREATED="1568825310351" MODIFIED="1568825310351"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestMethod;" ID="ID_1671298651" CREATED="1568825310352" MODIFIED="1568825310352"/>
<node TEXT="import org.springframework.web.bind.annotation.RestController;" ID="ID_1103053946" CREATED="1568825310353" MODIFIED="1568825310353"/>
<node TEXT="import com.framework.Tct.Const.PublicConst;" ID="ID_304820509" CREATED="1568825310354" MODIFIED="1568825310354"/>
<node TEXT="@RestController" ID="ID_802774271" CREATED="1568825310355" MODIFIED="1568825310355"/>
<node TEXT="public class LoginRestController {" ID="ID_1727131001" CREATED="1568825310356" MODIFIED="1568828011367">
<node TEXT="@Autowired" ID="ID_966756169" CREATED="1568825310357" MODIFIED="1568825310357"/>
<node TEXT="HttpSession session;" ID="ID_1590607046" CREATED="1568825310357" MODIFIED="1568825310357"/>
<node TEXT="@Autowired" ID="ID_122251413" CREATED="1568825310358" MODIFIED="1568825310358"/>
<node TEXT="HttpServletRequest request;" ID="ID_598938782" CREATED="1568825310359" MODIFIED="1568825310359"/>
<node TEXT="@Autowired" ID="ID_1427639626" CREATED="1568825310360" MODIFIED="1568825310360"/>
<node TEXT="CookieCsrfTokenRepository cookieTokenMaker;" ID="ID_1966234402" CREATED="1568825310360" MODIFIED="1568825310360"/>
<node TEXT="@Autowired" ID="ID_1917189631" CREATED="1568825310361" MODIFIED="1568825310361"/>
<node TEXT="AuthenticationManager authenticationManager;" ID="ID_1983448288" CREATED="1568825310362" MODIFIED="1568825310362"/>
<node TEXT="@RequestMapping(value=&quot;/getCsrfToken&quot;,method=RequestMethod.GET)" ID="ID_650284674" CREATED="1568825310363" MODIFIED="1568825310363"/>
<node TEXT="public void getCsrf() {" ID="ID_584116984" CREATED="1568825310364" MODIFIED="1568825310364"/>
</node>
<node TEXT="//                CsrfToken csrfToken = (CsrfToken)session.getAttribute(PublicConst.SPRING_SCURITY.CSRF_TOKEN);" ID="ID_754779001" CREATED="1568825310364" MODIFIED="1568825310364"/>
<node TEXT="//                System.out.println(csrfToken.getToken());" FOLDED="true" ID="ID_522340042" CREATED="1568825310369" MODIFIED="1568828001153">
<node TEXT="Map&lt;String,Object&gt; map = new HashMap&lt;String,Object&gt;();" ID="ID_192953797" CREATED="1568825310370" MODIFIED="1568825310370"/>
<node TEXT="CsrfToken csrf = cookieTokenMaker.loadToken(request);" ID="ID_1122013874" CREATED="1568825310371" MODIFIED="1568825310371"/>
<node TEXT="if(csrf == null) {" ID="ID_396324856" CREATED="1568825310373" MODIFIED="1568825310373">
<node TEXT="csrf =cookieTokenMaker.generateToken(request);" ID="ID_1446604410" CREATED="1568825310374" MODIFIED="1568825310374"/>
</node>
<node TEXT="}" ID="ID_1475322725" CREATED="1568825310375" MODIFIED="1568825310375"/>
</node>
<node TEXT="//                map.put(&quot;value&quot;, cookieTokenMaker.loadToken(request).getToken());" ID="ID_1960375563" CREATED="1568825310375" MODIFIED="1568825310375"/>
<node TEXT="//                map.put(&quot;sessionId&quot;, session.getId());" ID="ID_789719606" CREATED="1568825310376" MODIFIED="1568828012857">
<node TEXT="//return map;" ID="ID_125326865" CREATED="1568825310376" MODIFIED="1568825310376"/>
<node TEXT="}" ID="ID_1386539875" CREATED="1568825310377" MODIFIED="1568825310377"/>
<node TEXT="@RequestMapping(value= &quot;/login&quot;,method=RequestMethod.POST)" ID="ID_276224499" CREATED="1568825310377" MODIFIED="1568825310377"/>
<node TEXT="public String login(@RequestBody Map&lt;String,Object&gt; authTry) {" ID="ID_478862451" CREATED="1568825310378" MODIFIED="1568827724797" LINK="mailto:login(@RequestBody" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="String username = authTry.get(&quot;username&quot;).toString();" ID="ID_1874560164" CREATED="1568825310378" MODIFIED="1568825328424"/>
<node TEXT="String password = authTry.get(&quot;password&quot;).toString();" ID="ID_546242844" CREATED="1568825310379" MODIFIED="1568825328424"/>
<node TEXT="UsernamePasswordAuthenticationToken token = new UsernamePasswordAuthenticationToken(username, password);" ID="ID_774592528" CREATED="1568825310379" MODIFIED="1568825332560" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="Authentication authentication = authenticationManager.authenticate(token);" ID="ID_1585150737" CREATED="1568825310381" MODIFIED="1568825332992" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="SecurityContextHolder.getContext().setAuthentication(authentication);" ID="ID_1235744496" CREATED="1568825310381" MODIFIED="1568825333376" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="session.setAttribute(HttpSessionSecurityContextRepository.SPRING_SECURITY_CONTEXT_KEY, SecurityContextHolder.getContext());" ID="ID_1125438437" CREATED="1568825310382" MODIFIED="1568825334606" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="CsrfToken csrfToken = cookieTokenMaker.generateToken(request);" ID="ID_1544370811" CREATED="1568828025137" MODIFIED="1568828029775" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="cookieTokenMaker.saveToken(csrfToken, request, response);" ID="ID_62759234" CREATED="1568828025137" MODIFIED="1568828030022" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="return &quot;성공&quot;;" ID="ID_763158046" CREATED="1568825310383" MODIFIED="1568825328432"/>
</node>
<node TEXT="}" ID="ID_246069304" CREATED="1568825310383" MODIFIED="1568825310383"/>
</node>
<node TEXT="}" ID="ID_1449539826" CREATED="1568825310384" MODIFIED="1568825310384"/>
</node>
<node TEXT="login을 던질 때 form에다가 넣지 말고 바로 json형태로 던지기" FOLDED="true" ID="ID_1532535906" CREATED="1568825414986" MODIFIED="1568827689161">
<node TEXT="loginFunction(data: any) {" ID="ID_480179018" CREATED="1568825454839" MODIFIED="1568825454839">
<node TEXT="// this.token.value = Cookies.get(&quot;XSRF-TOKEN&quot;)" ID="ID_946644850" CREATED="1568825454840" MODIFIED="1568825454840">
<node TEXT="//console.log(data);" ID="ID_755263309" CREATED="1568825454840" MODIFIED="1568825454840"/>
<node TEXT="// let form_data = new FormData();" ID="ID_1993174485" CREATED="1568825454841" MODIFIED="1568825454841"/>
<node TEXT="// for (var key in data) {" ID="ID_501271440" CREATED="1568825454841" MODIFIED="1568825454841"/>
<node TEXT="//   form_data.append(key, data[key]);" ID="ID_200690357" CREATED="1568825454842" MODIFIED="1568825454842"/>
<node TEXT="// }" ID="ID_475815853" CREATED="1568825454842" MODIFIED="1568825454842"/>
<node TEXT="//console.log(this.token.value);" ID="ID_1159744484" CREATED="1568825454843" MODIFIED="1568825454843"/>
</node>
<node TEXT="// form_data.append(&quot;_csrf&quot;,this.token.value);" ID="ID_230893676" CREATED="1568825454843" MODIFIED="1568825454843">
<node TEXT="console.log(data);" ID="ID_906357845" CREATED="1568825454844" MODIFIED="1568825454844"/>
<node TEXT="this.authService.login(data).subscribe(" ID="ID_135800159" CREATED="1568825454844" MODIFIED="1568825454844">
<node TEXT="(next) =&gt; {" ID="ID_642781995" CREATED="1568825454844" MODIFIED="1568825454844">
<node TEXT="console.log(next);" ID="ID_975084856" CREATED="1568825454845" MODIFIED="1568825454845"/>
</node>
<node TEXT="}, (error) =&gt; {" ID="ID_1252186937" CREATED="1568825454845" MODIFIED="1568825454845">
<node TEXT="console.log(error);" ID="ID_1678265204" CREATED="1568825454845" MODIFIED="1568825454845"/>
</node>
<node TEXT="}" ID="ID_1411322968" CREATED="1568825454846" MODIFIED="1568825454846"/>
</node>
<node TEXT=")" ID="ID_335245875" CREATED="1568825454846" MODIFIED="1568825454846"/>
</node>
<node TEXT="}" ID="ID_649927784" CREATED="1568825454846" MODIFIED="1568825454846"/>
</node>
</node>
</node>
</node>
<node TEXT="jstl추가 하는 방법" FOLDED="true" POSITION="right" ID="ID_1954893130" CREATED="1568609352220" MODIFIED="1621472968362">
<node TEXT="https://www.surasint.com/spring-boot-jsp/" ID="ID_1583850757" CREATED="1574352383337" MODIFIED="1574517728468" LINK="https://www.surasint.com/spring-boot-jsp/" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="pom" FOLDED="true" ID="ID_1000649344" CREATED="1568610011075" MODIFIED="1574350243389">
<node TEXT="&lt;!-- https://mvnrepository.com/artifact/javax.servlet.jsp.jstl/jstl --&gt;" ID="ID_138050505" CREATED="1568610014095" MODIFIED="1568610014095" LINK="https://mvnrepository.com/artifact/javax.servlet.jsp.jstl/jstl"/>
<node TEXT="&lt;dependency&gt;" ID="ID_177086477" CREATED="1568610014096" MODIFIED="1568610014096">
<node TEXT="&lt;groupId&gt;javax.servlet.jsp.jstl&lt;/groupId&gt;" ID="ID_1260267257" CREATED="1568610014097" MODIFIED="1568610014097"/>
<node TEXT="&lt;artifactId&gt;jstl-api&lt;/artifactId&gt;" ID="ID_230620530" CREATED="1568610014097" MODIFIED="1568610014097"/>
<node TEXT="&lt;version&gt;1.2&lt;/version&gt;" ID="ID_1263744193" CREATED="1568610014098" MODIFIED="1568610014098"/>
<node TEXT="&lt;type&gt;jar&lt;/type&gt;" ID="ID_1853988451" CREATED="1568610014098" MODIFIED="1568610014098"/>
</node>
<node TEXT="&lt;/dependency&gt;" ID="ID_554345018" CREATED="1568610014099" MODIFIED="1568610014099"/>
<node TEXT="&lt;!-- https://mvnrepository.com/artifact/org.apache.tomcat/tomcat-jasper --&gt;" ID="ID_1472472697" CREATED="1568610014099" MODIFIED="1568610014099" LINK="https://mvnrepository.com/artifact/org.apache.tomcat/tomcat-jasper"/>
<node TEXT="&lt;dependency&gt;" ID="ID_985045003" CREATED="1568610014100" MODIFIED="1568610014100">
<node TEXT="&lt;groupId&gt;org.apache.tomcat&lt;/groupId&gt;" ID="ID_1106864347" CREATED="1568610014100" MODIFIED="1568610014100"/>
<node TEXT="&lt;artifactId&gt;tomcat-jasper&lt;/artifactId&gt;" ID="ID_215042914" CREATED="1568610014101" MODIFIED="1568610014101"/>
<node TEXT="&lt;version&gt;9.0.24&lt;/version&gt;" ID="ID_1825736657" CREATED="1568610014101" MODIFIED="1568610014101"/>
</node>
<node TEXT="&lt;/dependency&gt;" ID="ID_1294652066" CREATED="1568610014101" MODIFIED="1568610014101"/>
<node TEXT="&lt;!-- https://mvnrepository.com/artifact/org.apache.taglibs/taglibs-standard-impl --&gt;" ID="ID_1633729513" CREATED="1568610014102" MODIFIED="1568610014102" LINK="https://mvnrepository.com/artifact/org.apache.taglibs/taglibs-standard-impl"/>
<node TEXT="&lt;dependency&gt;" ID="ID_848124168" CREATED="1568610014102" MODIFIED="1568610014102">
<node TEXT="&lt;groupId&gt;org.apache.taglibs&lt;/groupId&gt;" ID="ID_577885347" CREATED="1568610014102" MODIFIED="1568610014102"/>
<node TEXT="&lt;artifactId&gt;taglibs-standard-impl&lt;/artifactId&gt;" ID="ID_1433931482" CREATED="1568610014103" MODIFIED="1568610014103"/>
<node TEXT="&lt;version&gt;1.2.5&lt;/version&gt;" ID="ID_1482074576" CREATED="1568610014103" MODIFIED="1568610014103"/>
</node>
<node TEXT="&lt;/dependency&gt;" ID="ID_252788790" CREATED="1568610014103" MODIFIED="1568610014103"/>
</node>
<node TEXT="webconfig" FOLDED="true" ID="ID_552382587" CREATED="1568611695071" MODIFIED="1574350244413">
<node TEXT="@Configuration" ID="ID_1857665948" CREATED="1568611436233" MODIFIED="1574350198754"/>
<node TEXT="public class WebConfig implements WebMvcConfigurer{" ID="ID_194720283" CREATED="1568611436234" MODIFIED="1574350198754">
<node TEXT="@Override" ID="ID_1527594576" CREATED="1568611436234" MODIFIED="1574350198754"/>
<node TEXT="public void configureViewResolvers(ViewResolverRegistry registry) {" ID="ID_463172883" CREATED="1568611436235" MODIFIED="1574350198754">
<node TEXT="// TODO Auto-generated method stub" ID="ID_842311090" CREATED="1568611436235" MODIFIED="1574350198754"/>
<node TEXT="InternalResourceViewResolver resolver = new InternalResourceViewResolver();" ID="ID_60206946" CREATED="1568611436236" MODIFIED="1574350198754"/>
<node TEXT="resolver.setPrefix(&quot;/dontRemove/jsp/&quot;);" ID="ID_1201046036" CREATED="1568611436236" MODIFIED="1574350198754"/>
<node TEXT="resolver.setSuffix(&quot;.jsp&quot;);" ID="ID_381497516" CREATED="1568611436237" MODIFIED="1574350198754"/>
<node TEXT="resolver.setViewClass(JstlView.class);" ID="ID_681772772" CREATED="1568611436237" MODIFIED="1574350198754"/>
<node TEXT="registry.viewResolver(resolver);" ID="ID_1737006499" CREATED="1568611436238" MODIFIED="1574350198754"/>
<node TEXT="//WebMvcConfigurer.super.configureViewResolvers(registry);" ID="ID_1411999986" CREATED="1568611436238" MODIFIED="1574350198754"/>
</node>
<node TEXT="}" ID="ID_599495742" CREATED="1568611436238" MODIFIED="1574350198754"/>
</node>
<node TEXT="}" ID="ID_1401461355" CREATED="1568611436239" MODIFIED="1574350198754"/>
</node>
<node TEXT="컨트롤러" ID="ID_508338643" CREATED="1568612555769" MODIFIED="1579856808548">
<node TEXT="package com.framework.Tct.login;" ID="ID_124685164" CREATED="1568612569803" MODIFIED="1568612569803"/>
<node TEXT="import org.springframework.stereotype.Controller;" ID="ID_1018027193" CREATED="1568612569804" MODIFIED="1568612569804"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestMapping;" ID="ID_1560872057" CREATED="1568612569804" MODIFIED="1568612569804"/>
<node TEXT="@Controller" ID="ID_1872569244" CREATED="1568612569805" MODIFIED="1568612569805"/>
<node TEXT="public class LoginController {" ID="ID_245834792" CREATED="1568612569805" MODIFIED="1568612569805">
<node TEXT="@RequestMapping(&quot;/login&quot;)" ID="ID_37466638" CREATED="1568612569805" MODIFIED="1568612569805"/>
<node TEXT="public String loginPage() {" ID="ID_1206399884" CREATED="1568612569806" MODIFIED="1568612569806">
<node TEXT="return &quot;login&quot;;" ID="ID_1294766877" CREATED="1568612569806" MODIFIED="1568612569806"/>
</node>
<node TEXT="}" ID="ID_593298964" CREATED="1568612569806" MODIFIED="1568612569806"/>
</node>
<node TEXT="//" ID="ID_253006905" CREATED="1568612569807" MODIFIED="1568612569807"/>
<node TEXT="//        @RequestMapping(&quot;/logout&quot;)" ID="ID_1552911206" CREATED="1568612569807" MODIFIED="1568612569807"/>
<node TEXT="//        public String logoutPage() {" ID="ID_1547714558" CREATED="1568612569807" MODIFIED="1568612569807"/>
<node TEXT="//                return &quot;/&quot;;" ID="ID_423502428" CREATED="1568612569807" MODIFIED="1568612569807"/>
<node TEXT="//        }" ID="ID_1414971865" CREATED="1568612569808" MODIFIED="1568612569808"/>
<node TEXT="}" ID="ID_600266378" CREATED="1568612569808" MODIFIED="1568612569808"/>
</node>
<node TEXT="작동현황(이미지)" FOLDED="true" ID="ID_1075213642" CREATED="1568611711719" MODIFIED="1574350218013">
<node ID="ID_720807125" CREATED="1568611717860" MODIFIED="1568611717860"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_4882194666603207167.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="디렉토리(이미지)" FOLDED="true" ID="ID_114562010" CREATED="1568611833287" MODIFIED="1574350221455">
<node ID="ID_955168852" CREATED="1568611835881" MODIFIED="1568611835881"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_5617425528076212828.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="formdata는 reqeustBody로 가져올 수 없다. body에 있다고 볼 수 없기 때문이다." POSITION="right" ID="ID_1962285039" CREATED="1568740869679" MODIFIED="1568740892491" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
</node>
<node TEXT="openssl 설치" FOLDED="true" POSITION="right" ID="ID_973322506" CREATED="1568880514952" MODIFIED="1621472968362" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
<node TEXT="https://stackoverflow.com/questions/50625283/how-to-install-openssl-in-windows-10" ID="ID_1134304754" CREATED="1568880524080" MODIFIED="1568880719144" LINK="https://stackoverflow.com/questions/50625283/how-to-install-openssl-in-windows-10"/>
<node TEXT="만약 윈도우 환경이라면 따로 설치할 필요가 없다." ID="ID_1483232885" CREATED="1568880524973" MODIFIED="1568880719146"/>
<node TEXT="그냥 git bash를 설치할 떄 모두 다 설치됨을 알면 된다.(이미지)" ID="ID_357644128" CREATED="1568880531157" MODIFIED="1568880782378">
<node ID="ID_1997455035" CREATED="1568880782757" MODIFIED="1568880782757"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_6954297526257525724.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="스프링 boot 따라서 pem을 만들고 거기서 privateKey를 만든다." ID="ID_1112263460" CREATED="1568884250608" MODIFIED="1568884285161">
<node TEXT="openssl genrsa -out jwt.pem 2048" ID="ID_853017663" CREATED="1568884373241" MODIFIED="1568884373241"/>
</node>
<node TEXT="거기서 private key 추출" ID="ID_335630686" CREATED="1568884374773" MODIFIED="1568884378801">
<node TEXT="openssl rsa -in jwt.pem" ID="ID_1195655038" CREATED="1568884391633" MODIFIED="1568884391633"/>
</node>
<node TEXT="거기서 public key 추출" ID="ID_364892481" CREATED="1568884392732" MODIFIED="1568884396401">
<node TEXT="openssl rsa -in jwt.pem -pubout" ID="ID_349775473" CREATED="1568884406218" MODIFIED="1568884406218"/>
</node>
</node>
<node TEXT="개행문자 지우기" FOLDED="true" POSITION="right" ID="ID_1726029239" CREATED="1568911065417" MODIFIED="1621472968362">
<node TEXT="개행 문자 지우기 notepad++(이미지)" ID="ID_535232512" CREATED="1568911115503" MODIFIED="1568911130193">
<node ID="ID_1279780424" CREATED="1568911130938" MODIFIED="1568911130938"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_2727943150746540960.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="oauth(JWT)" FOLDED="true" POSITION="right" ID="ID_833007569" CREATED="1568918225556" MODIFIED="1621472968362">
<node TEXT="doc" FOLDED="true" ID="ID_95813070" CREATED="1568984205860" MODIFIED="1573370384104">
<node TEXT="https://docs.spring.io/spring-security-oauth2-boot/docs/current-SNAPSHOT/reference/htmlsingle/#enabling-the-resource-server" ID="ID_631503585" CREATED="1568984208440" MODIFIED="1568984208440" LINK="https://docs.spring.io/spring-security-oauth2-boot/docs/current-SNAPSHOT/reference/htmlsingle/#enabling-the-resource-server"/>
</node>
<node TEXT="문제" FOLDED="true" ID="ID_1582164662" CREATED="1568918232822" MODIFIED="1570810109344">
<node TEXT="No bean named &apos;org.springframework.context.annotation.ConfigurationClassPostProcessor.importRegistry&apos; available" ID="ID_1311045417" CREATED="1568918228220" MODIFIED="1568918229039"/>
</node>
<node TEXT="해결" FOLDED="true" ID="ID_834943750" CREATED="1568920457930" MODIFIED="1570810109927">
<node TEXT="서비스 부분에 대한 @service 어노테이션을 달지 않았고, @configutaion oauth2config 에 달지 않았음" ID="ID_347286064" CREATED="1568920459280" MODIFIED="1568920481147"/>
</node>
<node TEXT="문제" FOLDED="true" ID="ID_908622973" CREATED="1568922790104" MODIFIED="1570810110424">
<node TEXT="Caused by: java.lang.IllegalStateException: For MAC signing you do not need to specify the verifier key separately, and if you do it must match the signing key" ID="ID_1148115271" CREATED="1568923870183" MODIFIED="1568923870183"/>
</node>
<node TEXT="해결" FOLDED="true" ID="ID_863756350" CREATED="1568922826771" MODIFIED="1570810110975">
<node TEXT="https://stackoverflow.com/questions/48098186/spring-boot-using-jwt-oauth-and-separate-resource-and-auth-servers" ID="ID_331066822" CREATED="1568922827807" MODIFIED="1568922827807" LINK="https://stackoverflow.com/questions/48098186/spring-boot-using-jwt-oauth-and-separate-resource-and-auth-servers"/>
</node>
<node TEXT="문제" FOLDED="true" ID="ID_526075385" CREATED="1568923056891" MODIFIED="1614246084922">
<node TEXT="java.lang.ClassNotFoundException: org.bouncycastle.asn1.ASN1Sequence" ID="ID_1580866076" CREATED="1568923057856" MODIFIED="1568923057856"/>
<node TEXT="https://www.baeldung.com/spring-security-oauth-jwt" ID="ID_800262678" CREATED="1568957106797" MODIFIED="1568957106797" LINK="https://www.baeldung.com/spring-security-oauth-jwt"/>
</node>
<node TEXT="해결" FOLDED="true" ID="ID_1052690647" CREATED="1568959912187" MODIFIED="1620638753866">
<node TEXT="https://mvnrepository.com/artifact/org.bouncycastle/bcprov-jdk15on" ID="ID_1328546110" CREATED="1568959922741" MODIFIED="1568959923490" LINK="https://mvnrepository.com/artifact/org.bouncycastle/bcprov-jdk15on"/>
<node TEXT="이걸 maven에 추가한다." ID="ID_1937587826" CREATED="1568959915086" MODIFIED="1568959928449"/>
</node>
<node TEXT="문제" FOLDED="true" ID="ID_1022003305" CREATED="1568962358401" MODIFIED="1570810112734">
<node TEXT="Full authentication is required to access this resource" ID="ID_1271851195" CREATED="1568962359606" MODIFIED="1568962359606"/>
</node>
<node TEXT="해결" FOLDED="true" ID="ID_1492305742" CREATED="1568989435546" MODIFIED="1570810113965">
<node TEXT="@Override" ID="ID_1766619895" CREATED="1568992363531" MODIFIED="1568992363531">
<node TEXT="public void configure(ClientDetailsServiceConfigurer clients) throws Exception {" ID="ID_1427761178" CREATED="1568992363550" MODIFIED="1568992363550">
<node TEXT="// TODO Auto-generated method stub" ID="ID_304507383" CREATED="1568992363552" MODIFIED="1568992363552"/>
<node TEXT="//super.configure(clients);" ID="ID_205137449" CREATED="1568992363553" MODIFIED="1568992363553"/>
<node TEXT="System.out.println(&quot;passsssssssssssssssssssssssssssssssssss&quot;);" ID="ID_204030711" CREATED="1568992363554" MODIFIED="1568992363554"/>
<node TEXT="System.out.println(encoder.encode(clientSeceret));" ID="ID_1048679446" CREATED="1568992363555" MODIFIED="1568992379124">
<font NAME="SansSerif" SIZE="12"/>
</node>
<node TEXT="clients.inMemory().withClient(clinetId).secret(encoder.encode(clientSeceret)).scopes(&quot;read&quot;,&quot;write&quot;)" ID="ID_1308294342" CREATED="1568992363556" MODIFIED="1568992381086" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT=".authorizedGrantTypes(&quot;password&quot;,&quot;refresh_token&quot;).accessTokenValiditySeconds(tokenValidSec)" ID="ID_724364072" CREATED="1568992363557" MODIFIED="1568992363557"/>
<node TEXT=".refreshTokenValiditySeconds(refreshTokenValidSec);" ID="ID_760109143" CREATED="1568992363558" MODIFIED="1568992363558"/>
</node>
<node TEXT="}" ID="ID_1035418504" CREATED="1568992363559" MODIFIED="1568992363559"/>
</node>
<node TEXT="여기서 secret(encoder.encode(clientSeceret))을 추가해야함. encoder는 autowired로 securitry에 있는 암호화를 가져오면 됨" ID="ID_1384300650" CREATED="1568992372921" MODIFIED="1568992420803"/>
</node>
<node TEXT="정리" FOLDED="true" ID="ID_1005013779" CREATED="1568994925956" MODIFIED="1573370384104">
<node TEXT="기본적으로 oauth2를 한번 더 진행 할 것이기 때문에 여기서는 사용 방법에 대해서만 작성한다." ID="ID_113729251" CREATED="1568994927886" MODIFIED="1568995368816"/>
<node TEXT="우선 ciientId와 secrect를 clientid:secrect 만들어 basic 형태로 만든 후에 세가지 파라미터에 (grant_type,password,username) 알맞은 value 값을 넣고 accesstoken을 가져온 다음에, authorization 헤더에 bearer accesstoken을 넣고 api를 이용하면 된다. (이미지)" ID="ID_877197554" CREATED="1568995369467" MODIFIED="1570810118167">
<node ID="ID_1789330702" CREATED="1568996002952" MODIFIED="1568996002952"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_869543031503194885.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
</node>
<node TEXT="oauthJDBC" FOLDED="true" POSITION="right" ID="ID_273830192" CREATED="1569182120317" MODIFIED="1621472968362">
<node TEXT="해당링크" FOLDED="true" ID="ID_1959524425" CREATED="1569189995745" MODIFIED="1569926454057">
<node TEXT="https://www.baeldung.com/rest-api-spring-oauth2-angular" ID="ID_103840936" CREATED="1569190011486" MODIFIED="1569190011486" LINK="https://www.baeldung.com/rest-api-spring-oauth2-angular"/>
</node>
<node TEXT="문제" FOLDED="true" ID="ID_307240783" CREATED="1569182125895" MODIFIED="1569926453092">
<node TEXT="Authentication request for failed: org.springframework.security.authentication.InternalAuthenticationServiceException: Error creating bean with name &apos;scopedTarget.clientDetailsService&apos; defined in class path resource [org/springframework/security/oauth2/config/annotation/configuration/ClientDetailsServiceConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.springframework.security.oauth2.provider.ClientDetailsService]: Factory method &apos;clientDetailsService&apos; threw exception; nested exception is org.springframework.security.oauth2.provider.ClientAlreadyExistsException: Client already exists: TctTest" ID="ID_1053245326" CREATED="1569182847929" MODIFIED="1569182847929"/>
<node TEXT="이미지" ID="ID_251305138" CREATED="1569182854854" MODIFIED="1569182855826">
<node ID="ID_1383633660" CREATED="1569182872288" MODIFIED="1569182872288"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_5074486276794753573.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="해결" FOLDED="true" ID="ID_633062079" CREATED="1569183183182" MODIFIED="1620638793485">
<node TEXT="해당 테이블은 서버를 다시 시작 할 때 다시 싹 다 갈아 엎는 의도이다." ID="ID_731658508" CREATED="1569189881547" MODIFIED="1569189933942"/>
<node TEXT="문제는 해당 테이블에 이미 값이 있고, 그 값을 추가하는데 primary키라서 중복 오류가 된다는 것" ID="ID_805933713" CREATED="1569190332930" MODIFIED="1569190377062"/>
<node TEXT="방금 말했듯이 월래는 해당 테이블에 아무것도 없어야 한다." ID="ID_222843852" CREATED="1569190377345" MODIFIED="1569190395078"/>
<node TEXT="이를 생각하여 h2를 메이븐에 추가한 것이며, 해당하는 나름의 일회용 테이블을 추가하라고 한것" ID="ID_73619602" CREATED="1569187353433" MODIFIED="1569190021630"/>
<node TEXT="https://stackoverflow.com/questions/49438517/why-spring-boot-2-0-application-does-not-run-schema-sql" ID="ID_480313969" CREATED="1569190110918" MODIFIED="1569190110918" LINK="https://stackoverflow.com/questions/49438517/why-spring-boot-2-0-application-does-not-run-schema-sql"/>
<node TEXT="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#howto-initialize-a-database-using-spring-jdbc" ID="ID_282100233" CREATED="1569190126516" MODIFIED="1569190126516" LINK="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#howto-initialize-a-database-using-spring-jdbc"/>
<node TEXT="기본 값으로 datasource 상에서 설정하지 않으면 schema든지 data 든지 다 씨알도 안먹힘을 알아둬야 한다." ID="ID_1087650846" CREATED="1569190127393" MODIFIED="1569190172413"/>
<node TEXT="고로 flyway를 쓰지 않고 h2를 써야만 한다." ID="ID_443288571" CREATED="1569190178378" MODIFIED="1569190189533"/>
<node TEXT="다음 이미지를 참고하라(이미지)" ID="ID_773192455" CREATED="1569190197026" MODIFIED="1569190205614">
<node ID="ID_1105340084" CREATED="1569190313266" MODIFIED="1569190313266"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_234679354504626992.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="저걸 설정을 해줘야만 한다." ID="ID_1198867567" CREATED="1569190314489" MODIFIED="1569190320054"/>
</node>
<node TEXT="리소스 서버 하는 중" ID="ID_891564721" CREATED="1569314919575" MODIFIED="1569314923417"/>
<node TEXT="JWT 토큰을 DEFAULT로 바꾸기 (이미지)" FOLDED="true" ID="ID_362783454" CREATED="1569356590770" MODIFIED="1569926447293" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node ID="ID_613712406" CREATED="1569356619502" MODIFIED="1569356619502"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_7678059689927167856.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="AccessToken post 복습" ID="ID_1885558135" CREATED="1569358000995" MODIFIED="1605442372142" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="POST /oauth/token HTTP/1.1" ID="ID_1154356471" CREATED="1569358010759" MODIFIED="1569358012436"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_1728293024" CREATED="1569358010760" MODIFIED="1569358012436"/>
<node TEXT="Content-Type: application/x-www-form-urlencoded" ID="ID_183407932" CREATED="1569358010760" MODIFIED="1569358012436"/>
<node TEXT="Authorization: Basic VGN0VGVzdDoxMjM0MTIzNGFh" ID="ID_169407856" CREATED="1569358010760" MODIFIED="1569358012436"/>
<node TEXT="User-Agent: PostmanRuntime/7.17.1" ID="ID_1404043297" CREATED="1569358010761" MODIFIED="1569358012436"/>
<node TEXT="Accept: */*" ID="ID_5260105" CREATED="1569358010761" MODIFIED="1569358012436"/>
<node TEXT="Cache-Control: no-cache" ID="ID_730791196" CREATED="1569358010762" MODIFIED="1569358012436"/>
<node TEXT="Postman-Token: 6f7f1110-6413-458e-8f11-1328b028c2dc,0114c4a6-be73-4b67-bd93-a1c54bcca679" ID="ID_1630039304" CREATED="1569358010762" MODIFIED="1569358012436"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_621062806" CREATED="1569358010763" MODIFIED="1569358012437"/>
<node TEXT="Accept-Encoding: gzip, deflate" ID="ID_1684361195" CREATED="1569358010763" MODIFIED="1569358012437"/>
<node TEXT="Content-Length: 66" ID="ID_112519331" CREATED="1569358010764" MODIFIED="1569358012437"/>
<node TEXT="Cookie: XSRF-TOKEN=595b50c4-9980-4fe8-b83a-a1983f68a7f3; JSESSIONID=1817A39B33358B70F32F806E893067B7" ID="ID_1122417947" CREATED="1569358010764" MODIFIED="1569358012437"/>
<node TEXT="Connection: keep-alive" ID="ID_1889257805" CREATED="1569358010765" MODIFIED="1569358012438"/>
<node TEXT="cache-control: no-cache" ID="ID_1526194269" CREATED="1569358010766" MODIFIED="1569358012438"/>
<node TEXT="username=TctTest%40gmail.com&amp;password=password&amp;grant_type=password" ID="ID_1316504536" CREATED="1569358010766" MODIFIED="1569358012438"/>
</node>
<node TEXT="문제" FOLDED="true" ID="ID_1588639229" CREATED="1569314924540" MODIFIED="1584338387702">
<node TEXT="Failed to determine a suitable driver class" ID="ID_1068000342" CREATED="1569314925497" MODIFIED="1569321848030"/>
</node>
<node TEXT="해결" FOLDED="true" ID="ID_1428543512" CREATED="1569321735177" MODIFIED="1584338387702">
<node TEXT="https://www.baeldung.com/configuration-properties-in-spring-boot" ID="ID_101254332" CREATED="1569321736591" MODIFIED="1569321736591" LINK="https://www.baeldung.com/configuration-properties-in-spring-boot"/>
<node TEXT="해결이미지" FOLDED="true" ID="ID_157240482" CREATED="1569322516778" MODIFIED="1570217533229">
<node ID="ID_1454887887" CREATED="1569322528396" MODIFIED="1569322528396"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_5988415282852065745.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="@PropertySource 를 설정해주니 된다." ID="ID_1074607135" CREATED="1569322531450" MODIFIED="1569322690829"/>
</node>
<node TEXT="문제" FOLDED="true" ID="ID_143134286" CREATED="1569355458667" MODIFIED="1569926459396">
<node TEXT="UserDetailsService is required." ID="ID_156888643" CREATED="1569355537339" MODIFIED="1569355537339"/>
<node TEXT="토큰을 리프레시 할 떄 필요하다." ID="ID_1501813198" CREATED="1569355538570" MODIFIED="1569355549366"/>
</node>
<node TEXT="해결" FOLDED="true" ID="ID_674534722" CREATED="1569356056890" MODIFIED="1569926460884">
<node TEXT="https://github.com/royclarkson/spring-rest-service-oauth/issues/19" ID="ID_1737402588" CREATED="1569356084771" MODIFIED="1569356085488" LINK="https://github.com/royclarkson/spring-rest-service-oauth/issues/19"/>
<node TEXT="다음을 추가해주면 된다.(이미지)" ID="ID_104616719" CREATED="1569356059115" MODIFIED="1569356064414">
<node ID="ID_1386452620" CREATED="1569356064767" MODIFIED="1569356064767"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_3622374039303424758.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="REFRESH_TOKEN" FOLDED="true" ID="ID_1967440812" CREATED="1569356133394" MODIFIED="1572219191898" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="POST /oauth/token HTTP/1.1" ID="ID_953661259" CREATED="1569356139692" MODIFIED="1569356604019"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_221709081" CREATED="1569356139693" MODIFIED="1569356604019"/>
<node TEXT="Content-Type: application/x-www-form-urlencoded" ID="ID_927625781" CREATED="1569356139693" MODIFIED="1569356604019"/>
<node TEXT="Authorization: Basic VGN0VGVzdDoxMjM0MTIzNGFh" ID="ID_1543559826" CREATED="1569356139693" MODIFIED="1569356604019"/>
<node TEXT="User-Agent: PostmanRuntime/7.17.1" ID="ID_1446236296" CREATED="1569356139694" MODIFIED="1569356604019"/>
<node TEXT="Accept: */*" ID="ID_1974893302" CREATED="1569356139694" MODIFIED="1569356604019"/>
<node TEXT="Cache-Control: no-cache" ID="ID_87571103" CREATED="1569356139699" MODIFIED="1569356604019"/>
<node TEXT="Postman-Token: 0ed66a1d-b465-46a1-a685-e33f97a47725,9772331a-22cb-4566-9f63-a79492895088" ID="ID_722777271" CREATED="1569356139699" MODIFIED="1569356604019"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_1894064322" CREATED="1569356139700" MODIFIED="1569356604020"/>
<node TEXT="Accept-Encoding: gzip, deflate" ID="ID_784385941" CREATED="1569356139701" MODIFIED="1569356604020"/>
<node TEXT="Content-Length: 75" ID="ID_1152453760" CREATED="1569356139701" MODIFIED="1569356604020"/>
<node TEXT="Cookie: XSRF-TOKEN=595b50c4-9980-4fe8-b83a-a1983f68a7f3; JSESSIONID=1817A39B33358B70F32F806E893067B7" ID="ID_1123913880" CREATED="1569356139701" MODIFIED="1569356604020"/>
<node TEXT="Connection: keep-alive" ID="ID_1283196692" CREATED="1569356139703" MODIFIED="1569356604021"/>
<node TEXT="cache-control: no-cache" ID="ID_1039023168" CREATED="1569356139703" MODIFIED="1569356604021"/>
<node TEXT="refresh_token=1c21e606-bd8a-410c-bf51-2bc4d660dc19&amp;grant_type=refresh_token" ID="ID_1859626672" CREATED="1569356139704" MODIFIED="1569356604021"/>
</node>
<node TEXT="리프레시 토큰 uri" FOLDED="true" ID="ID_1847255640" CREATED="1569356265811" MODIFIED="1569926463436" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://stackoverflow.com/questions/19655911/request-new-access-token-using-refresh-token-in-username-password-grant-in-sprin" ID="ID_1204017705" CREATED="1569356282164" MODIFIED="1569356602900" LINK="https://stackoverflow.com/questions/19655911/request-new-access-token-using-refresh-token-in-username-password-grant-in-sprin"/>
</node>
<node TEXT="문제" FOLDED="true" ID="ID_1526678411" CREATED="1569407834151" MODIFIED="1569926464260">
<node TEXT="oauth2가 잘 작동하지 않고, 추가적인 인증이 필요하다고 계속 뜸" ID="ID_776611989" CREATED="1569407836853" MODIFIED="1569428451034"/>
</node>
<node TEXT="해결" FOLDED="true" ID="ID_213631079" CREATED="1569428453264" MODIFIED="1619770121069">
<node TEXT="ResouseServer가 어노테이션으로 설정 되어 있었음" ID="ID_501048959" CREATED="1569428497890" MODIFIED="1569428521140"/>
<node TEXT="이것을 해제하고, formLogin을 켜야함(이미지)" FOLDED="true" ID="ID_1919136611" CREATED="1569428565143" MODIFIED="1569429507928">
<node ID="ID_1991924484" CREATED="1569429339062" MODIFIED="1569429339062"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_2573133784619504032.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="https://stackoverflow.com/questions/52804707/spring-boot2-oauth2-implicit-flow-http-localhost8080-oauth-authorize-gettin" ID="ID_119445813" CREATED="1569428633769" MODIFIED="1569428633769" LINK="https://stackoverflow.com/questions/52804707/spring-boot2-oauth2-implicit-flow-http-localhost8080-oauth-authorize-gettin"/>
<node TEXT="그리고 redirect를 설정해줌(이미지)" FOLDED="true" ID="ID_1946738061" CREATED="1569428751752" MODIFIED="1569429507929">
<node ID="ID_1051608730" CREATED="1569428760153" MODIFIED="1569428760153"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_5686005425267045823.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="다음으로 접속" ID="ID_277947720" CREATED="1569428833592" MODIFIED="1569429523926">
<node TEXT="127.0.0.1:8081/oauth/authorize?response_type=token&amp;client_id=sampleClinetId&amp;redirect_uri=https://daum.net&amp;scope=read" ID="ID_499503536" CREATED="1569855157076" MODIFIED="1569855157076" LINK="https://daum.net&amp;scope=read"/>
</node>
<node TEXT="로그인 form으로 갈텐데 로그인을 잘하고" ID="ID_1446441694" CREATED="1569428839536" MODIFIED="1569428956436"/>
<node TEXT="그러면 다음으로 이동(이미지)" FOLDED="true" ID="ID_884132352" CREATED="1569429011072" MODIFIED="1569621459208">
<node ID="ID_837103360" CREATED="1569429680171" MODIFIED="1569429680171"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_3501115479965751572.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="해당 accestocken과 token_type을 적절히 운용 빼서 쓰면 끝" ID="ID_1249131693" CREATED="1569429022456" MODIFIED="1569429052166"/>
<node TEXT="그러나 해당 방법은 formLogin을 키는 방법이므로 그다지 추천하지는 않는 방법이지 않을까?" ID="ID_1598037229" CREATED="1569429369465" MODIFIED="1569429502141"/>
</node>
<node TEXT="check_token" FOLDED="true" ID="ID_601173233" CREATED="1569429796881" MODIFIED="1572219192570" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="GET /oauth/check_token?token=7e067652-d8c0-4ebf-9384-9aeab578deaf HTTP/1.1" ID="ID_649266617" CREATED="1569492847761" MODIFIED="1569492847761"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_1237616765" CREATED="1569492847762" MODIFIED="1569492847762"/>
<node TEXT="Authorization: Basic VGN0VGVzdDoxMjM0MTIzNGFh" ID="ID_1292137141" CREATED="1569492847763" MODIFIED="1569492847763"/>
<node TEXT="User-Agent: PostmanRuntime/7.17.1" ID="ID_1656969570" CREATED="1569492847763" MODIFIED="1569492847763"/>
<node TEXT="Accept: */*" ID="ID_130833398" CREATED="1569492847763" MODIFIED="1569492847763"/>
<node TEXT="Cache-Control: no-cache" ID="ID_578386903" CREATED="1569492847764" MODIFIED="1569492847764"/>
<node TEXT="Postman-Token: a9fd731c-c4b8-4acb-928b-5cb7d7f42eaf,8779024c-f0bb-4b6e-a458-2eb9571115da" ID="ID_85469511" CREATED="1569492847764" MODIFIED="1569492847764"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_814058388" CREATED="1569492847765" MODIFIED="1569492847765"/>
<node TEXT="Accept-Encoding: gzip, deflate" ID="ID_994107560" CREATED="1569492847765" MODIFIED="1569492847765"/>
<node TEXT="Cookie: XSRF-TOKEN=392816f7-807c-42e4-b2fa-2cae2c20daba; JSESSIONID=BBB93BB62C368046F41CABD1F6F02089" ID="ID_1614042443" CREATED="1569492847766" MODIFIED="1569492847766"/>
<node TEXT="Connection: keep-alive" ID="ID_554864850" CREATED="1569492847767" MODIFIED="1569492847767"/>
<node TEXT="cache-control: no-cache" ID="ID_298976750" CREATED="1569492847768" MODIFIED="1569492847768"/>
</node>
<node TEXT="Extra Login Fields with Spring Security" FOLDED="true" ID="ID_1785546518" CREATED="1569432639848" MODIFIED="1602652731669" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://www.baeldung.com/spring-security-extra-login-fields" ID="ID_951366959" CREATED="1569432975815" MODIFIED="1569432975815" LINK="https://www.baeldung.com/spring-security-extra-login-fields"/>
<node TEXT="implicit를 할 때는 이게 맞음. formlogin을 사용한다면 여기서 4.1. Custom Authentication Filter을 사용하는게 맞음" ID="ID_229925820" CREATED="1569478835998" MODIFIED="1569482910620"/>
<node TEXT="일반적인access_token을 받을 때에는 4.3. Custom UserDetailsAuthenticationProvider 을 참고하는게 좋다." ID="ID_461783402" CREATED="1569482911688" MODIFIED="1569853737101">
<node TEXT="https://github.com/eugenp/tutorials/blob/master/spring-5-security/src/main/java/com/baeldung/loginextrafieldscustom/CustomUserDetailsAuthenticationProvider.java" ID="ID_610616126" CREATED="1569483281901" MODIFIED="1569483281901" LINK="https://github.com/eugenp/tutorials/blob/master/spring-5-security/src/main/java/com/baeldung/loginextrafieldscustom/CustomUserDetailsAuthenticationProvider.java"/>
</node>
<node TEXT="spring security에서 추가하는 방법" FOLDED="true" ID="ID_1899840850" CREATED="1569483385378" MODIFIED="1569484018315">
<node TEXT="https://github.com/eugenp/tutorials/blob/master/spring-5-security/src/main/java/com/baeldung/loginextrafieldscustom/SecurityConfig.java" ID="ID_1995095485" CREATED="1569483416292" MODIFIED="1569483416292" LINK="https://github.com/eugenp/tutorials/blob/master/spring-5-security/src/main/java/com/baeldung/loginextrafieldscustom/SecurityConfig.java"/>
<node TEXT="코드" FOLDED="true" ID="ID_1289682904" CREATED="1569483446833" MODIFIED="1569483571682">
<node TEXT="@Override" ID="ID_70913771" CREATED="1569483570589" MODIFIED="1569483570589"/>
<node TEXT="protected void configure(AuthenticationManagerBuilder auth) throws Exception {" ID="ID_1108537836" CREATED="1569483570590" MODIFIED="1569483570590">
<node TEXT="// TODO Auto-generated method stub" ID="ID_473669292" CREATED="1569483570591" MODIFIED="1569483570591"/>
<node TEXT="// super.configure(auth);" ID="ID_499508609" CREATED="1569483570592" MODIFIED="1569483570592"/>
<node TEXT="//auth.inMemoryAuthentication().withUser(&quot;user&quot;).password(&quot;{noop}password&quot;).roles(&quot;USER&quot;);" ID="ID_652754868" CREATED="1569483570592" MODIFIED="1569483570592"/>
<node TEXT="auth.authenticationProvider(customProvider);" ID="ID_1241267732" CREATED="1569483570593" MODIFIED="1569483570593"/>
</node>
<node TEXT="}" ID="ID_1462385082" CREATED="1569483570593" MODIFIED="1569483570593"/>
</node>
</node>
<node TEXT="추가적인 필드 보내기 및 처리" FOLDED="true" ID="ID_1325207438" CREATED="1569483601721" MODIFIED="1602652731669">
<node TEXT="보내기 헤더" ID="ID_349713834" CREATED="1569483612362" MODIFIED="1569483614606">
<node TEXT="POST /oauth/token HTTP/1.1" ID="ID_1145026535" CREATED="1569483614964" MODIFIED="1569483614964"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_42953555" CREATED="1569483614965" MODIFIED="1569483614965"/>
<node TEXT="Content-Type: application/x-www-form-urlencoded" ID="ID_1191665075" CREATED="1569483614965" MODIFIED="1569483614965"/>
<node TEXT="Authorization: Basic VGN0VGVzdDoxMjM0MTIzNGFh" ID="ID_1541554071" CREATED="1569483614966" MODIFIED="1569483614966"/>
<node TEXT="User-Agent: PostmanRuntime/7.17.1" ID="ID_1144687771" CREATED="1569483614966" MODIFIED="1569483614966"/>
<node TEXT="Accept: */*" ID="ID_1485831524" CREATED="1569483614967" MODIFIED="1569483614967"/>
<node TEXT="Cache-Control: no-cache" ID="ID_1396059300" CREATED="1569483614967" MODIFIED="1569483614967"/>
<node TEXT="Postman-Token: 279ad8c3-39cc-43f5-acb2-3ea67f511962,b82570cd-ffcc-42ee-8932-0044039c1805" ID="ID_1936814903" CREATED="1569483614968" MODIFIED="1569483614968"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_12226678" CREATED="1569483614968" MODIFIED="1569483614968"/>
<node TEXT="Accept-Encoding: gzip, deflate" ID="ID_1166281168" CREATED="1569483614969" MODIFIED="1569483614969"/>
<node TEXT="Content-Length: 103" ID="ID_809340388" CREATED="1569483614969" MODIFIED="1569483614969"/>
<node TEXT="Cookie: XSRF-TOKEN=392816f7-807c-42e4-b2fa-2cae2c20daba; JSESSIONID=6BB3351BEBA8DA08D5FBFEEF28C8007C" ID="ID_1739265848" CREATED="1569483614969" MODIFIED="1569483614969"/>
<node TEXT="Connection: keep-alive" ID="ID_1442267340" CREATED="1569483614970" MODIFIED="1569483614970"/>
<node TEXT="cache-control: no-cache" ID="ID_992435537" CREATED="1569483614971" MODIFIED="1569483614971"/>
<node TEXT="username=TctTest%40gmail.com&amp;password=12341234aa&amp;grant_type=password&amp;domain33=wfwefwefwef" ID="ID_1883900168" CREATED="1569483614971" MODIFIED="1569483614971"/>
</node>
<node TEXT="처리" FOLDED="true" ID="ID_564048405" CREATED="1569483701977" MODIFIED="1602652731669">
<node TEXT="@Override" ID="ID_1177226558" CREATED="1569483725773" MODIFIED="1569483725773"/>
<node TEXT="protected UserDetails retrieveUser(String arg0, UsernamePasswordAuthenticationToken authentication)" ID="ID_253538131" CREATED="1569483725774" MODIFIED="1569483725774">
<node TEXT="throws AuthenticationException {" ID="ID_1093092069" CREATED="1569483725775" MODIFIED="1569483725775"/>
<node TEXT="// TODO Auto-generated method stub" ID="ID_1870822513" CREATED="1569483725775" MODIFIED="1569483725775"/>
</node>
<node TEXT="//                CustomAuthentication auth = (CustomAuthentication)authentication;" ID="ID_181193812" CREATED="1569483725776" MODIFIED="1569483725776"/>
<node TEXT="//" ID="ID_1275233571" CREATED="1569483725776" MODIFIED="1569483725776"/>
<node TEXT="//                String username = auth.getName();" ID="ID_1063647986" CREATED="1569483725777" MODIFIED="1569483725777"/>
<node TEXT="//                String domain = auth.getDomain();" ID="ID_694575556" CREATED="1569483725777" MODIFIED="1569483725777">
<node TEXT="Map&lt;String,Object&gt; authMap = (Map&lt;String,Object&gt;)authentication.getDetails();" ID="ID_303037430" CREATED="1569483725777" MODIFIED="1569483733901" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="String username = authentication.getName();" ID="ID_1370972772" CREATED="1569483725778" MODIFIED="1569483725778"/>
<node TEXT="String domain33 = &quot;&quot;;" ID="ID_1670222284" CREATED="1569483725778" MODIFIED="1569483725778"/>
<node TEXT="if(authMap.get(&quot;domain33&quot;) != null) {" ID="ID_1096097570" CREATED="1569483725779" MODIFIED="1569483732363" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="domain33 = authMap.get(&quot;domain33&quot;).toString();" ID="ID_11050934" CREATED="1569483725779" MODIFIED="1569483734916" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
</node>
<node TEXT="}" ID="ID_1030396327" CREATED="1569483725780" MODIFIED="1569483735532" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="System.out.println(domain33);" ID="ID_570277983" CREATED="1569483725780" MODIFIED="1569483725780"/>
<node TEXT="CustomUser user = customDetailService.loadUserByUsername(username);" ID="ID_1256911960" CREATED="1569483725780" MODIFIED="1569483725780"/>
<node TEXT="//System.out.println(authentication.getDetails().toString());" ID="ID_812326044" CREATED="1569483725781" MODIFIED="1569483725781"/>
<node TEXT="return user;" ID="ID_1921822866" CREATED="1569483725781" MODIFIED="1569483725781"/>
<node TEXT="}" ID="ID_799983988" CREATED="1569483725782" MODIFIED="1569483725782"/>
</node>
</node>
<node TEXT="이미지" ID="ID_189855922" CREATED="1569483748689" MODIFIED="1569483749454">
<node ID="ID_1825655808" CREATED="1569483974088" MODIFIED="1569483974088"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_2056602428520170283.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
</node>
<node TEXT="doc" FOLDED="true" ID="ID_197233335" CREATED="1569483397633" MODIFIED="1569926476370">
<node TEXT="endPoint" ID="ID_1544116189" CREATED="1569446837234" MODIFIED="1569478994729">
<node TEXT="https://docs.spring.io/spring-security/site/docs/5.0.7.RELEASE/reference/html/oauth2login-advanced.html" ID="ID_725707027" CREATED="1569446839942" MODIFIED="1569446839942" LINK="https://docs.spring.io/spring-security/site/docs/5.0.7.RELEASE/reference/html/oauth2login-advanced.html"/>
</node>
<node TEXT="oauth2 extra parameter" ID="ID_514581130" CREATED="1569478658847" MODIFIED="1569479037838">
<node TEXT="https://www.baeldung.com/spring-security-custom-oauth-requests" ID="ID_1336107973" CREATED="1569478863006" MODIFIED="1569478863006" LINK="https://www.baeldung.com/spring-security-custom-oauth-requests"/>
<node TEXT="oauth2 spring security doc endpoint" ID="ID_860864076" CREATED="1569478864216" MODIFIED="1569479347404">
<node TEXT="https://auth0.com/docs/protocols/oauth2" ID="ID_147553007" CREATED="1569478939203" MODIFIED="1569478939203" LINK="https://auth0.com/docs/protocols/oauth2"/>
</node>
</node>
</node>
<node TEXT="문제" FOLDED="true" ID="ID_984500070" CREATED="1569479043599" MODIFIED="1602138247981">
<node TEXT="oauth2Login()을 추가했는데 The type org.springframework.security.oauth2.client.web.OAuth2LoginAuthenticationFilter cannot be resolved. It is indirectly referenced from required .class files 라는 오류가 발생" ID="ID_1266656448" CREATED="1569479047615" MODIFIED="1569479141043"/>
</node>
<node TEXT="해결" FOLDED="true" ID="ID_1741898395" CREATED="1569482447628" MODIFIED="1569926474085">
<node TEXT="해당 문제는 다른 웹 서비스의 oauth 서비스를 이용하기 위한 설정이 필요하기 때문에 이러한 현상이 일어나는 것" ID="ID_483010174" CREATED="1569482452392" MODIFIED="1569482583909"/>
</node>
<node TEXT="문제" FOLDED="true" ID="ID_1047031447" CREATED="1569506171079" MODIFIED="1569926473251">
<node TEXT="check_token할 때 또 resouse Server에서 pricipal을 가지고 올 때,  원하는 정보가 껴 있어야 하는데 해당 정보가 없음(예를 들어 userid가 있어야 할 때)" ID="ID_1384708259" CREATED="1569506173206" MODIFIED="1569506340762"/>
</node>
<node TEXT="해결" FOLDED="true" ID="ID_546854735" CREATED="1569528077127" MODIFIED="1614153220600">
<node TEXT="기본적인 토큰" FOLDED="true" ID="ID_1629823081" CREATED="1569531232384" MODIFIED="1602652733366">
<node TEXT="https://stackoverflow.com/questions/28492116/can-i-include-user-information-while-issuing-an-access-token" ID="ID_293254892" CREATED="1569531229315" MODIFIED="1569531230075" LINK="https://stackoverflow.com/questions/28492116/can-i-include-user-information-while-issuing-an-access-token"/>
<node TEXT="일단 아주 기본적으로 이러한 토큰이 가리키는 정보에 대해서 변경하려면 TokenEnhence 인터페이스에 대한 수정이 진행되어야 한다." ID="ID_1082339042" CREATED="1569531694445" MODIFIED="1569535891541"/>
<node TEXT="코드" ID="ID_1898161185" CREATED="1569535963799" MODIFIED="1569536103309">
<node TEXT="oauth2 config의 tokenEnhance에 대한 설정을 봐야 한다." ID="ID_1448700382" CREATED="1569535902761" MODIFIED="1569609655706">
<node TEXT="@Override" ID="ID_816887619" CREATED="1569535907239" MODIFIED="1569535907239">
<node TEXT="public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {" ID="ID_533027172" CREATED="1569535907240" MODIFIED="1569535907240">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1596029768" CREATED="1569535907240" MODIFIED="1569535907240"/>
<node TEXT="//super.configure(endpoints);" ID="ID_1150234498" CREATED="1569535907241" MODIFIED="1569535907241"/>
<node TEXT="endpoints" ID="ID_1714160046" CREATED="1569535907241" MODIFIED="1569535907241"/>
<node TEXT=".authenticationManager(authenticationManager)" ID="ID_14497371" CREATED="1569535907241" MODIFIED="1569535907241"/>
<node TEXT=".tokenStore(tokenStore())" ID="ID_1493573769" CREATED="1569535907242" MODIFIED="1569535907242"/>
<node TEXT=".accessTokenConverter(new DefaultAccessTokenConverter())" ID="ID_319505057" CREATED="1569535907242" MODIFIED="1569535907242"/>
<node TEXT=".userDetailsService(userDetailsService)" ID="ID_205591805" CREATED="1569535907242" MODIFIED="1569535907242"/>
<node TEXT=".tokenEnhancer(tokenEnhancer());" ID="ID_106823264" CREATED="1569535907243" MODIFIED="1569535979399" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
</node>
<node TEXT="}" ID="ID_484356563" CREATED="1569535907243" MODIFIED="1569535907243"/>
</node>
</node>
<node TEXT="커스텀 Enhence를 리턴" ID="ID_772891175" CREATED="1569536005919" MODIFIED="1569609726270">
<node TEXT="@Bean" ID="ID_394585844" CREATED="1569536013197" MODIFIED="1569536013197"/>
<node TEXT="public TokenEnhancer tokenEnhancer() {" ID="ID_374864091" CREATED="1569536013198" MODIFIED="1569536013198">
<node TEXT="return new CustomDefaultTokenEnhancer();" ID="ID_1263297893" CREATED="1569536013199" MODIFIED="1569536013199"/>
</node>
<node TEXT="}" ID="ID_1939593921" CREATED="1569536013199" MODIFIED="1569536013199"/>
</node>
<node TEXT="커스텀 TokenEnhencer" FOLDED="true" ID="ID_1843174734" CREATED="1569536018791" MODIFIED="1569609683224">
<node TEXT="package com.framework.Tct.oAuth2;" ID="ID_567747568" CREATED="1569536049115" MODIFIED="1569536049115"/>
<node TEXT="import java.util.HashMap;" ID="ID_1930413013" CREATED="1569536049116" MODIFIED="1569536049116"/>
<node TEXT="import java.util.Map;" ID="ID_1927127498" CREATED="1569536049116" MODIFIED="1569536049116"/>
<node TEXT="import org.springframework.security.oauth2.common.DefaultOAuth2AccessToken;" ID="ID_428139116" CREATED="1569536049117" MODIFIED="1569536049117"/>
<node TEXT="import org.springframework.security.oauth2.common.OAuth2AccessToken;" ID="ID_1909876610" CREATED="1569536049117" MODIFIED="1569536049117"/>
<node TEXT="import org.springframework.security.oauth2.provider.OAuth2Authentication;" ID="ID_1631290925" CREATED="1569536049117" MODIFIED="1569536049117"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.DefaultAccessTokenConverter;" ID="ID_988344173" CREATED="1569536049118" MODIFIED="1569536049118"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.TokenEnhancer;" ID="ID_1999938918" CREATED="1569536049118" MODIFIED="1569536049118"/>
<node TEXT="public class CustomDefaultTokenEnhancer implements TokenEnhancer {" ID="ID_1415088455" CREATED="1569536049118" MODIFIED="1569536049118">
<node TEXT="@Override" ID="ID_301939987" CREATED="1569536049119" MODIFIED="1569536049119"/>
<node TEXT="public OAuth2AccessToken enhance(OAuth2AccessToken accessToken, OAuth2Authentication authentication) {" ID="ID_1015892546" CREATED="1569536049119" MODIFIED="1569536049119">
<node TEXT="// TODO Auto-generated method stub" ID="ID_695814615" CREATED="1569536049120" MODIFIED="1569536049120"/>
<node TEXT="CustomUser user = (CustomUser)authentication.getPrincipal();" ID="ID_320149145" CREATED="1569536049121" MODIFIED="1569536049121"/>
<node TEXT="Map&lt;String,Object&gt; map = new HashMap&lt;String, Object&gt;();" ID="ID_1665023597" CREATED="1569536049121" MODIFIED="1569536049121"/>
<node TEXT="map.put(&quot;userId&quot;, user.getUserId());" ID="ID_1503496172" CREATED="1569536049121" MODIFIED="1569536049121"/>
<node TEXT="((DefaultOAuth2AccessToken)accessToken).setAdditionalInformation(map);" ID="ID_238754883" CREATED="1569536049122" MODIFIED="1569536049122"/>
<node TEXT="return accessToken;" ID="ID_1634412071" CREATED="1569536049122" MODIFIED="1569536049122"/>
</node>
<node TEXT="}" ID="ID_1694056595" CREATED="1569536049122" MODIFIED="1569536049122"/>
</node>
<node TEXT="}" ID="ID_1523134212" CREATED="1569536049122" MODIFIED="1569536049122"/>
</node>
</node>
<node TEXT="oauth2 보내기" ID="ID_1624893328" CREATED="1569535909576" MODIFIED="1569536202060">
<node TEXT="헤더" FOLDED="true" ID="ID_780912997" CREATED="1569536202695" MODIFIED="1572219197776">
<node TEXT="POST /oauth/token HTTP/1.1" ID="ID_858858605" CREATED="1569536221778" MODIFIED="1569536221778"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_430041297" CREATED="1569536221779" MODIFIED="1569536221779"/>
<node TEXT="Content-Type: application/x-www-form-urlencoded" ID="ID_92304748" CREATED="1569536221779" MODIFIED="1569536221779"/>
<node TEXT="Authorization: Basic VGN0VGVzdDoxMjM0MTIzNGFh" ID="ID_1060346752" CREATED="1569536221780" MODIFIED="1569536221780"/>
<node TEXT="User-Agent: PostmanRuntime/7.17.1" ID="ID_1592811859" CREATED="1569536221780" MODIFIED="1569536221780"/>
<node TEXT="Accept: */*" ID="ID_157144642" CREATED="1569536221781" MODIFIED="1569536221781"/>
<node TEXT="Cache-Control: no-cache" ID="ID_441311727" CREATED="1569536221781" MODIFIED="1569536221781"/>
<node TEXT="Postman-Token: 4ad45809-d603-41f8-88ce-f246c4826205,232c7fb4-564e-4b58-8518-43e61ee16d33" ID="ID_1125533715" CREATED="1569536221781" MODIFIED="1569536221781"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_512240947" CREATED="1569536221782" MODIFIED="1569536221782"/>
<node TEXT="Accept-Encoding: gzip, deflate" ID="ID_913323179" CREATED="1569536221782" MODIFIED="1569536221782"/>
<node TEXT="Content-Length: 89" ID="ID_76282539" CREATED="1569536221782" MODIFIED="1569536221782"/>
<node TEXT="Cookie: XSRF-TOKEN=392816f7-807c-42e4-b2fa-2cae2c20daba; JSESSIONID=01EF6878340E2EB53870B35251AE3854" ID="ID_620604448" CREATED="1569536221782" MODIFIED="1569536221782"/>
<node TEXT="Connection: keep-alive" ID="ID_1498925424" CREATED="1569536221783" MODIFIED="1569536221783"/>
<node TEXT="cache-control: no-cache" ID="ID_1048682015" CREATED="1569536221784" MODIFIED="1569536221784"/>
<node TEXT="username=TctTest%40gmail.com&amp;password=12341234aa&amp;grant_type=password&amp;domain33=wfwefwefwef" ID="ID_445435829" CREATED="1569536221784" MODIFIED="1569536221784"/>
</node>
<node TEXT="결과(userid가 보이고 있다.)" ID="ID_1186689507" CREATED="1569536223232" MODIFIED="1569543858962">
<node TEXT="{" ID="ID_268701735" CREATED="1569543848834" MODIFIED="1569543848834">
<node TEXT="&quot;access_token&quot;: &quot;d35f3b43-052f-4e65-9532-31a49b2acd39&quot;," ID="ID_944990240" CREATED="1569543848847" MODIFIED="1569543848847"/>
<node TEXT="&quot;token_type&quot;: &quot;bearer&quot;," ID="ID_1674061111" CREATED="1569543848847" MODIFIED="1569543848847"/>
<node TEXT="&quot;refresh_token&quot;: &quot;d4b35b54-da64-49c9-b6f7-3f477368f202&quot;," ID="ID_492456701" CREATED="1569543848848" MODIFIED="1569543848848"/>
<node TEXT="&quot;expires_in&quot;: 43158," ID="ID_1381667381" CREATED="1569543848848" MODIFIED="1569543848848"/>
<node TEXT="&quot;scope&quot;: &quot;read write&quot;," ID="ID_1622818357" CREATED="1569543848848" MODIFIED="1569543848848"/>
<node TEXT="&quot;userId&quot;: &quot;123123&quot;" ID="ID_1077167314" CREATED="1569543848849" MODIFIED="1569543848849"/>
</node>
<node TEXT="}" ID="ID_982972377" CREATED="1569543848849" MODIFIED="1569543848849"/>
</node>
</node>
<node TEXT="리소스 서버" ID="ID_1277217754" CREATED="1569597558362" MODIFIED="1569597562518">
<node TEXT="resourceConfig" FOLDED="true" ID="ID_1115719955" CREATED="1569598240427" MODIFIED="1569616811586">
<node TEXT="package com.example.demo.oAuth2;" ID="ID_328160602" CREATED="1569598250846" MODIFIED="1569598250846"/>
<node TEXT="import org.aopalliance.intercept.MethodInterceptor;" ID="ID_32115445" CREATED="1569598250847" MODIFIED="1569598250847"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_517232455" CREATED="1569598250847" MODIFIED="1569598250847"/>
<node TEXT="import org.springframework.context.annotation.Bean;" ID="ID_1381888811" CREATED="1569598250848" MODIFIED="1569598250848"/>
<node TEXT="import org.springframework.context.annotation.Configuration;" ID="ID_1273018250" CREATED="1569598250849" MODIFIED="1569598250849"/>
<node TEXT="import org.springframework.context.annotation.Primary;" ID="ID_1848561592" CREATED="1569598250849" MODIFIED="1569598250849"/>
<node TEXT="import org.springframework.security.access.expression.method.MethodSecurityExpressionHandler;" ID="ID_1082224766" CREATED="1569598250850" MODIFIED="1569598250850"/>
<node TEXT="import org.springframework.security.authentication.AuthenticationManager;" ID="ID_1663882360" CREATED="1569598250851" MODIFIED="1569598250851"/>
<node TEXT="import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;" ID="ID_484569451" CREATED="1569598250851" MODIFIED="1569598250851"/>
<node TEXT="import org.springframework.security.config.annotation.method.configuration.GlobalMethodSecurityConfiguration;" ID="ID_1018399364" CREATED="1569598250852" MODIFIED="1569598250852"/>
<node TEXT="import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;" ID="ID_583924583" CREATED="1569598250854" MODIFIED="1569598250854"/>
<node TEXT="import org.springframework.security.oauth2.provider.expression.OAuth2MethodSecurityExpressionHandler;" ID="ID_1038193973" CREATED="1569598250854" MODIFIED="1569598250854"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.RemoteTokenServices;" ID="ID_1829683876" CREATED="1569598250855" MODIFIED="1569598250855"/>
<node TEXT="import com.example.demo.config.CheckTokenConverter;" ID="ID_686125660" CREATED="1569598250855" MODIFIED="1569598250855"/>
<node TEXT="@Configuration" ID="ID_1379146886" CREATED="1569598250856" MODIFIED="1569598250856"/>
<node TEXT="@EnableResourceServer" ID="ID_1719610989" CREATED="1569598250856" MODIFIED="1569598250856"/>
<node TEXT="@EnableGlobalMethodSecurity(prePostEnabled = true)" ID="ID_1941302432" CREATED="1569598250857" MODIFIED="1569598250857"/>
<node TEXT="public class ResoureConfig extends GlobalMethodSecurityConfiguration {" FOLDED="true" ID="ID_682698313" CREATED="1569598250857" MODIFIED="1569598535578">
<node TEXT="@Autowired" ID="ID_296267253" CREATED="1569598250858" MODIFIED="1569598250858"/>
<node TEXT="CheckTokenConverter converter;" ID="ID_985867627" CREATED="1569598250858" MODIFIED="1569598250858"/>
<node TEXT="@Override" ID="ID_1881289917" CREATED="1569598250858" MODIFIED="1569598250858"/>
<node TEXT="protected MethodSecurityExpressionHandler createExpressionHandler() {" ID="ID_992309205" CREATED="1569598250859" MODIFIED="1569598250859">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1994291408" CREATED="1569598250859" MODIFIED="1569598250859"/>
<node TEXT="return new OAuth2MethodSecurityExpressionHandler();" ID="ID_1791375091" CREATED="1569598250860" MODIFIED="1569598250860"/>
</node>
<node TEXT="}" ID="ID_43081080" CREATED="1569598250860" MODIFIED="1569598250860"/>
<node TEXT="@Override" ID="ID_1796890556" CREATED="1569598250860" MODIFIED="1569598250860"/>
<node TEXT="public MethodInterceptor methodSecurityInterceptor() throws Exception {" ID="ID_18725671" CREATED="1569598250861" MODIFIED="1569598250861">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1397565305" CREATED="1569598250861" MODIFIED="1569598250861"/>
<node TEXT="return super.methodSecurityInterceptor();" ID="ID_990808606" CREATED="1569598250862" MODIFIED="1569598250862"/>
</node>
<node TEXT="}" ID="ID_248281856" CREATED="1569598250862" MODIFIED="1569598250862"/>
<node TEXT="@Primary" ID="ID_1389154095" CREATED="1569598250862" MODIFIED="1569598250862"/>
<node TEXT="@Bean" ID="ID_1125427497" CREATED="1569598250863" MODIFIED="1569598250863"/>
<node TEXT="public RemoteTokenServices tokenService() {" ID="ID_545171241" CREATED="1569598250863" MODIFIED="1569598250863">
<node TEXT="RemoteTokenServices tokenService = new RemoteTokenServices();" ID="ID_1179378273" CREATED="1569598250864" MODIFIED="1569598250864"/>
<node TEXT="tokenService.setCheckTokenEndpointUrl(&quot;http://localhost:8081/oauth/check_token&quot;);" ID="ID_378001698" CREATED="1569598250864" MODIFIED="1569598250864" LINK="http://localhost:8081/oauth/check_token"/>
<node TEXT="tokenService.setClientId(&quot;TctTest&quot;);" ID="ID_47866879" CREATED="1569598250865" MODIFIED="1569598250865"/>
<node TEXT="tokenService.setClientSecret(&quot;12341234aa&quot;);" ID="ID_77791140" CREATED="1569598250865" MODIFIED="1569598250865"/>
<node TEXT="tokenService.setAccessTokenConverter(converter);" ID="ID_575097433" CREATED="1569598250866" MODIFIED="1569598250866"/>
<node TEXT="return tokenService;" ID="ID_1421618302" CREATED="1569598250866" MODIFIED="1569598250866"/>
</node>
<node TEXT="}" ID="ID_857146582" CREATED="1569598250867" MODIFIED="1569598250867"/>
</node>
<node TEXT="}" ID="ID_1134507969" CREATED="1569598250867" MODIFIED="1569598250867"/>
</node>
<node TEXT="여기서 RemoteTokenService가 있다." FOLDED="true" ID="ID_1160894467" CREATED="1569598567115" MODIFIED="1569600782256">
<node TEXT="어떤 요청이 들어올 때 authorization Server의 check_token으로 접속하여 현재 존재하는 토큰이 실체하는지를 검토하는 것을 말함. " ID="ID_1715034106" CREATED="1569598582506" MODIFIED="1569598786934"/>
<node TEXT="bean으로 만들시에 해당하는 서버에 접속 할때 자동으로 tokenService가 가동되는 것" ID="ID_1021176366" CREATED="1569598787426" MODIFIED="1569599320680"/>
<node TEXT="여기서 중요한 건 tokenService converter를 커스텀으로 새로 만들어야 한다는 것 그래서 check_token에서 가지고 오는 정보에 대해서 저장하는 기능을 따로 만들어야 한다." ID="ID_1790516541" CREATED="1569599320893" MODIFIED="1569599776792"/>
</node>
<node TEXT="CustomAccessTokenConverter" ID="ID_599332254" CREATED="1569599782133" MODIFIED="1569618336765">
<node TEXT="package com.example.demo.config;" ID="ID_286960590" CREATED="1569599853798" MODIFIED="1569599853798"/>
<node TEXT="import java.util.HashMap;" ID="ID_1132352385" CREATED="1569599853799" MODIFIED="1569599853799"/>
<node TEXT="import java.util.Map;" ID="ID_1306369816" CREATED="1569599853799" MODIFIED="1569599853799"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_63205453" CREATED="1569599853800" MODIFIED="1569599853800"/>
<node TEXT="import org.springframework.security.oauth2.provider.OAuth2Authentication;" ID="ID_259300905" CREATED="1569599853800" MODIFIED="1569599853800"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.DefaultAccessTokenConverter;" ID="ID_491067186" CREATED="1569599853801" MODIFIED="1569599853801"/>
<node TEXT="import org.springframework.stereotype.Component;" ID="ID_275124690" CREATED="1569599853801" MODIFIED="1569599853801"/>
<node TEXT="@Component" ID="ID_101839400" CREATED="1569599853802" MODIFIED="1569599853802"/>
<node TEXT="public class CheckTokenConverter extends DefaultAccessTokenConverter {" ID="ID_154966335" CREATED="1569599853802" MODIFIED="1569599918088">
<node TEXT="private Map checkTokenResult;" ID="ID_1135670718" CREATED="1569599853802" MODIFIED="1569599853802"/>
<node TEXT="@Override" ID="ID_750885227" CREATED="1569599853803" MODIFIED="1569599853803"/>
<node TEXT="public OAuth2Authentication extractAuthentication(Map&lt;String, ?&gt; map) {" ID="ID_1810417286" CREATED="1569599853803" MODIFIED="1569599911470">
<node TEXT="// TODO Auto-generated method stub" ID="ID_185524455" CREATED="1569599853804" MODIFIED="1569599853804"/>
<node TEXT="OAuth2Authentication auth = super.extractAuthentication(map);" ID="ID_468698848" CREATED="1569599853804" MODIFIED="1569599853804"/>
<node TEXT="this.checkTokenResult = new HashMap(map);" ID="ID_700276169" CREATED="1569599853805" MODIFIED="1569599853805"/>
<node TEXT="return auth;" ID="ID_843398844" CREATED="1569599853805" MODIFIED="1569599853805"/>
</node>
<node TEXT="}" ID="ID_983597261" CREATED="1569599853806" MODIFIED="1569599853806"/>
<node TEXT="public Map getCheckTokenResult() {" FOLDED="true" ID="ID_1800259584" CREATED="1569599853806" MODIFIED="1569599910734">
<node TEXT="return checkTokenResult;" ID="ID_1562733600" CREATED="1569599853806" MODIFIED="1569599853806"/>
</node>
<node TEXT="}" ID="ID_1708751304" CREATED="1569599853807" MODIFIED="1569599853807"/>
<node TEXT="public void setCheckTokenResult(Map checkTokenResult) {" FOLDED="true" ID="ID_1234297836" CREATED="1569599853807" MODIFIED="1569599910734">
<node TEXT="this.checkTokenResult = checkTokenResult;" ID="ID_390336709" CREATED="1569599853808" MODIFIED="1569599853808"/>
</node>
<node TEXT="}" ID="ID_219509033" CREATED="1569599853808" MODIFIED="1569599853808"/>
</node>
<node TEXT="}" ID="ID_1665113500" CREATED="1569599853809" MODIFIED="1569599853809"/>
</node>
<node TEXT="cehck_token으로 가지고 오는 정보를 실제 컨트롤러에서 가지고 오기" FOLDED="true" ID="ID_318068557" CREATED="1569599936069" MODIFIED="1602652733366">
<node TEXT="package com.example.demo.oAuth2;" ID="ID_169064397" CREATED="1569599987900" MODIFIED="1569599987900"/>
<node TEXT="import java.security.Principal;" ID="ID_132062653" CREATED="1569599987902" MODIFIED="1569599987902"/>
<node TEXT="import javax.servlet.http.HttpServletRequest;" ID="ID_1190413134" CREATED="1569599987903" MODIFIED="1569599987903"/>
<node TEXT="import org.apache.commons.lang3.RandomStringUtils;" ID="ID_1877129911" CREATED="1569599987903" MODIFIED="1569599987903"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_652119199" CREATED="1569599987905" MODIFIED="1569599987905"/>
<node TEXT="import org.springframework.security.access.prepost.PreAuthorize;" ID="ID_856658360" CREATED="1569599987906" MODIFIED="1569599987906"/>
<node TEXT="import org.springframework.security.oauth2.provider.OAuth2Authentication;" ID="ID_763686415" CREATED="1569599987907" MODIFIED="1569599987907"/>
<node TEXT="import org.springframework.web.bind.annotation.PathVariable;" ID="ID_1235724492" CREATED="1569599987908" MODIFIED="1569599987908"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestHeader;" ID="ID_1200626761" CREATED="1569599987909" MODIFIED="1569599987909"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestMapping;" ID="ID_1039745147" CREATED="1569599987910" MODIFIED="1569599987910"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestMethod;" ID="ID_708577007" CREATED="1569599987911" MODIFIED="1569599987911"/>
<node TEXT="import org.springframework.web.bind.annotation.RestController;" ID="ID_1503270022" CREATED="1569599987913" MODIFIED="1569599987913"/>
<node TEXT="import com.example.demo.config.CheckTokenConverter;" ID="ID_793096207" CREATED="1569599987914" MODIFIED="1569599987914"/>
<node TEXT="@RestController" ID="ID_1066693146" CREATED="1569599987915" MODIFIED="1569599987915"/>
<node TEXT="public class FooContoroller {" FOLDED="true" ID="ID_941641098" CREATED="1569599987915" MODIFIED="1569600443695">
<node TEXT="@Autowired" ID="ID_837325268" CREATED="1569599987917" MODIFIED="1569599987917"/>
<node TEXT="HttpServletRequest reqeust;" ID="ID_1303030082" CREATED="1569599987918" MODIFIED="1569599987918"/>
<node TEXT="@Autowired" ID="ID_784048340" CREATED="1569599987919" MODIFIED="1569600097305" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="CheckTokenConverter checkConverter;" ID="ID_1865912240" CREATED="1569599987919" MODIFIED="1569600075162" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="@PreAuthorize(&quot;#oauth2.hasScope(&apos;read&apos;)&quot;)" ID="ID_985161224" CREATED="1569599987920" MODIFIED="1569599987920"/>
<node TEXT="@RequestMapping(method = RequestMethod.GET,value = &quot;/foo/{id}&quot;)" ID="ID_197184591" CREATED="1569599987921" MODIFIED="1569599987921"/>
<node TEXT="public Foo FindById(@PathVariable long id, @RequestHeader(value=&quot;Authorization&quot;) String accessToken) {" ID="ID_36413675" CREATED="1569599987922" MODIFIED="1569599987922" LINK="mailto:FindById(@PathVariable"/>
</node>
<node TEXT="//                OAuth2Authentication oauth2Auth = tokenService.loadAuthentication(&quot;ccf1abc5-67af-4fc9-a775-893a23632671&quot;);" ID="ID_712403314" CREATED="1569599987925" MODIFIED="1569599987925"/>
<node TEXT="//" ID="ID_243896660" CREATED="1569599987926" MODIFIED="1569599987926"/>
<node TEXT="//                System.out.println(oauth2Auth.getPrincipal());" FOLDED="true" ID="ID_1093454404" CREATED="1569599987927" MODIFIED="1602652733366">
<node TEXT="//System.out.println(reqeust.getUserPrincipal().toString());" ID="ID_1187267348" CREATED="1569599987927" MODIFIED="1569599987927"/>
<node TEXT="//tokenService.readAccessToken(oauth_user_data.)" ID="ID_56623430" CREATED="1569599987928" MODIFIED="1569599987928"/>
<node TEXT="System.out.println(checkConverter.getCheckTokenResult().toString());" ID="ID_694463134" CREATED="1569599987928" MODIFIED="1569599987928"/>
<node TEXT="return" ID="ID_333992726" CREATED="1569599987929" MODIFIED="1569599987929">
<node TEXT="new Foo(Long.parseLong(RandomStringUtils.randomNumeric(2)),RandomStringUtils.randomAlphabetic(4));" ID="ID_1206732043" CREATED="1569599987929" MODIFIED="1569599987929"/>
</node>
<node TEXT="}" ID="ID_1882232710" CREATED="1569599987930" MODIFIED="1569599987930"/>
</node>
<node TEXT="}" ID="ID_55094498" CREATED="1569599987931" MODIFIED="1569599987931"/>
</node>
<node TEXT="헤더" FOLDED="true" ID="ID_545417017" CREATED="1569600462398" MODIFIED="1572219198535">
<node TEXT="GET /foo/1 HTTP/1.1" ID="ID_1251007574" CREATED="1569600746309" MODIFIED="1569600746309"/>
<node TEXT="Host: 127.0.0.1:8082" ID="ID_835265969" CREATED="1569600746310" MODIFIED="1569600746310"/>
<node TEXT="Authorization: Bearer 952e9a2b-1d1b-486d-9f3b-83bc8737bbf3" ID="ID_1498077661" CREATED="1569600746311" MODIFIED="1569600746311"/>
<node TEXT="User-Agent: PostmanRuntime/7.17.1" ID="ID_1803314975" CREATED="1569600746312" MODIFIED="1569600746312"/>
<node TEXT="Accept: */*" ID="ID_833229577" CREATED="1569600746313" MODIFIED="1569600746313"/>
<node TEXT="Cache-Control: no-cache" ID="ID_312818477" CREATED="1569600746313" MODIFIED="1569600746313"/>
<node TEXT="Postman-Token: d99b961a-a113-4eea-9928-2080c5892558,5f59c3b5-c076-4d68-a713-27e7a1a1af2b" ID="ID_819249788" CREATED="1569600746314" MODIFIED="1569600746314"/>
<node TEXT="Host: 127.0.0.1:8082" ID="ID_1159128225" CREATED="1569600746315" MODIFIED="1569600746315"/>
<node TEXT="Accept-Encoding: gzip, deflate" ID="ID_1168527544" CREATED="1569600746316" MODIFIED="1569600746316"/>
<node TEXT="Connection: keep-alive" ID="ID_25240134" CREATED="1569600746317" MODIFIED="1569600746317"/>
<node TEXT="cache-control: no-cache" ID="ID_745276810" CREATED="1569600746318" MODIFIED="1569600746318"/>
</node>
<node TEXT="결과 userId가 있다. (이미지)" FOLDED="true" ID="ID_1089390039" CREATED="1569600717854" MODIFIED="1569620070423">
<node ID="ID_1270582518" CREATED="1569600770610" MODIFIED="1569600770610"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_4542293115046307788.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
</node>
<node TEXT="jwt" ID="ID_1871991522" CREATED="1569531236301" MODIFIED="1569926486344">
<node TEXT="https://www.baeldung.com/spring-security-oauth-jwt" ID="ID_384813015" CREATED="1569528171850" MODIFIED="1569528171850" LINK="https://www.baeldung.com/spring-security-oauth-jwt"/>
<node TEXT="이전에 있던 tokenEnhencer 사용" ID="ID_936735526" CREATED="1569609701952" MODIFIED="1569609729386" LINK="#ID_772891175"/>
<node TEXT="oauthConfig" FOLDED="true" ID="ID_161569109" CREATED="1569609499087" MODIFIED="1599021554864">
<node TEXT="@Override" ID="ID_684615933" CREATED="1569609663512" MODIFIED="1569609663512"/>
<node TEXT="public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {" ID="ID_593157637" CREATED="1569609663513" MODIFIED="1569620171694">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1299722001" CREATED="1569609663514" MODIFIED="1569609663514"/>
<node TEXT="//super.configure(endpoints);" ID="ID_1937797986" CREATED="1569609663514" MODIFIED="1569609663514"/>
<node TEXT="List&lt;TokenEnhancer&gt; tokenEnhancerList = new ArrayList&lt;&gt;();" ID="ID_1834880210" CREATED="1569609663516" MODIFIED="1569609663516"/>
<node TEXT="tokenEnhancerList.add(tokenEnhancer());" ID="ID_1200078945" CREATED="1569609663517" MODIFIED="1569609663517"/>
<node TEXT="tokenEnhancerList.add(tokenEnhancerJwt());" ID="ID_233508437" CREATED="1569609663518" MODIFIED="1569609663518"/>
<node TEXT="TokenEnhancerChain enhacerChain = new TokenEnhancerChain();" ID="ID_1958061557" CREATED="1569609663519" MODIFIED="1569609663519"/>
<node TEXT="enhacerChain.setTokenEnhancers(tokenEnhancerList);" ID="ID_1067848991" CREATED="1569609663520" MODIFIED="1569609663520"/>
<node TEXT="endpoints" ID="ID_1506488909" CREATED="1569609663521" MODIFIED="1569609663521"/>
<node TEXT=".authenticationManager(authenticationManager)" ID="ID_1235283990" CREATED="1569609663522" MODIFIED="1569609663522"/>
<node TEXT=".tokenStore(tokenStore())" ID="ID_570116852" CREATED="1569609663523" MODIFIED="1569609663523"/>
<node TEXT=".userDetailsService(userDetailsService)" ID="ID_14584031" CREATED="1569609663524" MODIFIED="1569609663524"/>
<node TEXT=".tokenEnhancer(enhacerChain);" ID="ID_68399120" CREATED="1569609663525" MODIFIED="1569609663525"/>
</node>
<node TEXT="}" ID="ID_372254141" CREATED="1569609663525" MODIFIED="1569609663525"/>
</node>
<node TEXT="jwtconverter" FOLDED="true" ID="ID_1163224752" CREATED="1569609792056" MODIFIED="1569926495148">
<node TEXT="@Bean" ID="ID_953190704" CREATED="1569610225900" MODIFIED="1569610225900"/>
<node TEXT="public JwtAccessTokenConverter tokenEnhancerJwt() {" ID="ID_746516676" CREATED="1569610225901" MODIFIED="1569618763458">
<node TEXT="JwtAccessTokenConverter converter = new JwtAccessTokenConverter();" ID="ID_184993485" CREATED="1569610225901" MODIFIED="1569610225901"/>
<node TEXT="converter.setSigningKey(privateKey);" ID="ID_196632926" CREATED="1569610225901" MODIFIED="1569610225901"/>
<node TEXT="converter.setVerifierKey(publicKey);" ID="ID_1035598525" CREATED="1569610225902" MODIFIED="1569610225902"/>
<node TEXT="return converter;" ID="ID_868919890" CREATED="1569610225902" MODIFIED="1569610225902"/>
</node>
<node TEXT="}" ID="ID_1882195348" CREATED="1569610225902" MODIFIED="1569610225902"/>
</node>
<node TEXT="여기서 중요한건 JwtAccessTokenConverter가 tokenEnhencer도 구현하고 있다는 것 그래서 tokenEnhencer도 들어간다.(이미지)" FOLDED="true" ID="ID_300608105" CREATED="1569610227841" MODIFIED="1569853724975">
<node ID="ID_770638353" CREATED="1569610432057" MODIFIED="1569610432057"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_5507269181330230836.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="따라서 해당 jwtAccessTokenConverter를 tokenEnhecer로 취급하여 tokenEnhancerList에 이전에 사용했던 tokenEnhencer와 이어붙인다." ID="ID_990122521" CREATED="1569620130317" MODIFIED="1569620279897"/>
<node TEXT="그리고 TokenEnhancerChain 메소드 setTokenEnhancers를 사용하여 tokenEnhencer를 넓힌다." ID="ID_1606322945" CREATED="1569620280397" MODIFIED="1569620395489"/>
<node TEXT="이로써 추가적인 파라미터가 jwt에 추가된다." ID="ID_1200658591" CREATED="1569620337005" MODIFIED="1569620408434"/>
<node TEXT="헤더" FOLDED="true" ID="ID_1163802430" CREATED="1569620463765" MODIFIED="1572219197116">
<node TEXT="POST /oauth/token HTTP/1.1" ID="ID_1402554814" CREATED="1569620464880" MODIFIED="1569620464880"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_1356152370" CREATED="1569620464881" MODIFIED="1569620464881"/>
<node TEXT="Content-Type: application/x-www-form-urlencoded" ID="ID_434923073" CREATED="1569620464882" MODIFIED="1569620464882"/>
<node TEXT="Authorization: Basic VGN0VGVzdDoxMjM0MTIzNGFh" ID="ID_571567987" CREATED="1569620464883" MODIFIED="1569620464883"/>
<node TEXT="User-Agent: PostmanRuntime/7.17.1" ID="ID_650564116" CREATED="1569620464883" MODIFIED="1569620464883"/>
<node TEXT="Accept: */*" ID="ID_841287680" CREATED="1569620464884" MODIFIED="1569620464884"/>
<node TEXT="Cache-Control: no-cache" ID="ID_1585593923" CREATED="1569620464885" MODIFIED="1569620464885"/>
<node TEXT="Postman-Token: 7f47acdc-588f-4e1b-9b82-c3305e8bbb4c,831c9991-9920-4234-b959-f0f4a146449d" ID="ID_575228916" CREATED="1569620464886" MODIFIED="1569620464886"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_1876943011" CREATED="1569620464887" MODIFIED="1569620464887"/>
<node TEXT="Accept-Encoding: gzip, deflate" ID="ID_434760454" CREATED="1569620464888" MODIFIED="1569620464888"/>
<node TEXT="Content-Length: 89" ID="ID_569007745" CREATED="1569620464889" MODIFIED="1569620464889"/>
<node TEXT="Connection: keep-alive" ID="ID_1834553936" CREATED="1569620464889" MODIFIED="1569620464889"/>
<node TEXT="cache-control: no-cache" ID="ID_427989382" CREATED="1569620464890" MODIFIED="1569620464890"/>
<node TEXT="username=TctTest%40gmail.com&amp;password=12341234aa&amp;grant_type=password&amp;domain33=wfwefwefwef" ID="ID_1362182063" CREATED="1569620464891" MODIFIED="1569620464891"/>
</node>
<node TEXT="인증서버에서 받은 jwt(이미지)" FOLDED="true" ID="ID_1895676295" CREATED="1569620086669" MODIFIED="1569926490428">
<node ID="ID_1725241943" CREATED="1569620094447" MODIFIED="1569620094447"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_9039677760378855911.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="리소스 서버" ID="ID_1139932463" CREATED="1569616803550" MODIFIED="1569926497899">
<node TEXT="resourceConfig" FOLDED="true" ID="ID_551247477" CREATED="1569617110937" MODIFIED="1569853705144">
<node TEXT="package com.example.demo.oAuth2;" ID="ID_210430738" CREATED="1569617264716" MODIFIED="1569617264716"/>
<node TEXT="import org.aopalliance.intercept.MethodInterceptor;" ID="ID_101284724" CREATED="1569617264717" MODIFIED="1569617264717"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_435513653" CREATED="1569617264718" MODIFIED="1569617264718"/>
<node TEXT="import org.springframework.context.annotation.Bean;" ID="ID_869152706" CREATED="1569617264718" MODIFIED="1569617264718"/>
<node TEXT="import org.springframework.context.annotation.Configuration;" ID="ID_1570267959" CREATED="1569617264719" MODIFIED="1569617264719"/>
<node TEXT="import org.springframework.context.annotation.Primary;" ID="ID_959011995" CREATED="1569617264720" MODIFIED="1569617264720"/>
<node TEXT="import org.springframework.security.access.expression.method.MethodSecurityExpressionHandler;" ID="ID_387885442" CREATED="1569617264720" MODIFIED="1569617264720"/>
<node TEXT="import org.springframework.security.authentication.AuthenticationManager;" ID="ID_474481770" CREATED="1569617264721" MODIFIED="1569617264721"/>
<node TEXT="import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;" ID="ID_1173598628" CREATED="1569617264722" MODIFIED="1569617264722"/>
<node TEXT="import org.springframework.security.config.annotation.method.configuration.GlobalMethodSecurityConfiguration;" ID="ID_1026087474" CREATED="1569617264723" MODIFIED="1569617264723"/>
<node TEXT="import org.springframework.security.core.token.DefaultToken;" ID="ID_487051982" CREATED="1569617264725" MODIFIED="1569617264725"/>
<node TEXT="import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;" ID="ID_693813665" CREATED="1569617264726" MODIFIED="1569617264726"/>
<node TEXT="import org.springframework.security.oauth2.provider.expression.OAuth2MethodSecurityExpressionHandler;" ID="ID_1835857479" CREATED="1569617264726" MODIFIED="1569617264726"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.DefaultTokenServices;" ID="ID_968172561" CREATED="1569617264727" MODIFIED="1569617264727"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.RemoteTokenServices;" ID="ID_324117687" CREATED="1569617264728" MODIFIED="1569617264728"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.TokenStore;" ID="ID_1476377993" CREATED="1569617264728" MODIFIED="1569617264728"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.store.JwtAccessTokenConverter;" ID="ID_1719895642" CREATED="1569617264729" MODIFIED="1569617264729"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.store.JwtTokenStore;" ID="ID_1791471715" CREATED="1569617264730" MODIFIED="1569617264730"/>
<node TEXT="import com.example.demo.config.CheckTokenConverter;" ID="ID_1507527463" CREATED="1569617264730" MODIFIED="1569617264730"/>
<node TEXT="@Configuration" ID="ID_1171967953" CREATED="1569617264731" MODIFIED="1569617264731"/>
<node TEXT="@EnableResourceServer" ID="ID_1964116365" CREATED="1569617264732" MODIFIED="1569617264732"/>
<node TEXT="@EnableGlobalMethodSecurity(prePostEnabled = true)" ID="ID_888028885" CREATED="1569617264732" MODIFIED="1569617264732"/>
<node TEXT="public class ResoureConfig extends GlobalMethodSecurityConfiguration {" FOLDED="true" ID="ID_1726367276" CREATED="1569617264733" MODIFIED="1569617265864">
<node TEXT="@Autowired" ID="ID_1991374525" CREATED="1569617264734" MODIFIED="1569617264734"/>
<node TEXT="CheckTokenConverter converter;" ID="ID_1974533851" CREATED="1569617264735" MODIFIED="1569617264735"/>
<node TEXT="private String publicKey =" ID="ID_1949260577" CREATED="1569617264735" MODIFIED="1569617264735">
<node TEXT="&quot;-----BEGIN PUBLIC KEY-----\r\n&quot; +" ID="ID_72382398" CREATED="1569617264736" MODIFIED="1569617264736"/>
<node TEXT="&quot;MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA2qQGJcfx1pC3zRmfTxzQ\r\n&quot; +" ID="ID_666542734" CREATED="1569617264737" MODIFIED="1569617264737"/>
<node TEXT="&quot;k+FBZlqrlLJrZr0rTKyTJxbxDNA7uUxXTerRFlwEJZAClFvrAW/5zDkZ5bn3hvuF\r\n&quot; +" ID="ID_1414190569" CREATED="1569617264738" MODIFIED="1569617264738"/>
<node TEXT="&quot;zqWrEIQVx+UzmuOL8EiLzhG47PWFzCUCYqjLPFQg9HO5ZdOWBZQVM/ntEO5iwvpW\r\n&quot; +" ID="ID_1038407728" CREATED="1569617264738" MODIFIED="1569617264738"/>
<node TEXT="&quot;KUzO9BWuPuSxGQUQ1NqQqZKctakFRiroL0BVJu3uqWSTRhFquH6enN6g6Eqv14uu\r\n&quot; +" ID="ID_571344053" CREATED="1569617264739" MODIFIED="1569617264739"/>
<node TEXT="&quot;JIWj6rBeEuWXkTSq7prmCDor86Cy1HU9FSIYkhdsXc8xe2spat5W12b3DxiuzHW6\r\n&quot; +" ID="ID_1833890024" CREATED="1569617264739" MODIFIED="1569617264739"/>
<node TEXT="&quot;cFBrVn1GZcfsYyqyRJzAC94/3fEJOAXqjiMWC+X81jbulRvfSFp5KOK2dchPXqU8\r\n&quot; +" ID="ID_694921440" CREATED="1569617264740" MODIFIED="1569617264740"/>
<node TEXT="&quot;SQIDAQAB\r\n&quot; +" ID="ID_40982136" CREATED="1569617264741" MODIFIED="1569617264741"/>
<node TEXT="&quot;-----END PUBLIC KEY-----&quot;;" ID="ID_443449397" CREATED="1569617264742" MODIFIED="1569617264742"/>
</node>
<node TEXT="@Override" ID="ID_1872714594" CREATED="1569617264743" MODIFIED="1569617264743"/>
<node TEXT="protected MethodSecurityExpressionHandler createExpressionHandler() {" ID="ID_1323240695" CREATED="1569617264743" MODIFIED="1569617264743">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1793284371" CREATED="1569617264744" MODIFIED="1569617264744"/>
<node TEXT="return new OAuth2MethodSecurityExpressionHandler();" ID="ID_1453407034" CREATED="1569617264745" MODIFIED="1569617264745"/>
</node>
<node TEXT="}" ID="ID_630226703" CREATED="1569617264745" MODIFIED="1569617264745"/>
<node TEXT="@Override" ID="ID_1650451290" CREATED="1569617264745" MODIFIED="1569617264745"/>
<node TEXT="public MethodInterceptor methodSecurityInterceptor() throws Exception {" ID="ID_827766354" CREATED="1569617264746" MODIFIED="1569617264746">
<node TEXT="// TODO Auto-generated method stub" ID="ID_377957880" CREATED="1569617264746" MODIFIED="1569617264746"/>
<node TEXT="return super.methodSecurityInterceptor();" ID="ID_493051336" CREATED="1569617264747" MODIFIED="1569617264747"/>
</node>
<node TEXT="}" ID="ID_1589612923" CREATED="1569617264747" MODIFIED="1569617264747"/>
<node TEXT="@Bean" ID="ID_703157552" CREATED="1569617264747" MODIFIED="1569617264747"/>
<node TEXT="public JwtAccessTokenConverter tokenConvter() {" ID="ID_53286173" CREATED="1569617264748" MODIFIED="1569617264748">
<node TEXT="JwtAccessTokenConverter jwtAccessTokenConverter = new JwtAccessTokenConverter();" ID="ID_373835223" CREATED="1569617264748" MODIFIED="1569617264748"/>
<node TEXT="jwtAccessTokenConverter.setVerifierKey(publicKey);" ID="ID_1666581968" CREATED="1569617264749" MODIFIED="1569617264749"/>
<node TEXT="jwtAccessTokenConverter.setAccessTokenConverter(converter);" ID="ID_1335814091" CREATED="1569617264750" MODIFIED="1569617264750"/>
<node TEXT="return jwtAccessTokenConverter;" ID="ID_605698572" CREATED="1569617264750" MODIFIED="1569617264750"/>
</node>
<node TEXT="}" ID="ID_491468331" CREATED="1569617264750" MODIFIED="1569617264750"/>
<node TEXT="@Bean" ID="ID_1568273194" CREATED="1569617264751" MODIFIED="1569617264751"/>
<node TEXT="public TokenStore jwtTokenStore() {" ID="ID_386475638" CREATED="1569617264751" MODIFIED="1569617264751">
<node TEXT="return new JwtTokenStore(tokenConvter());" ID="ID_1184613767" CREATED="1569617264751" MODIFIED="1569617264751"/>
</node>
<node TEXT="}" ID="ID_1432538304" CREATED="1569617264752" MODIFIED="1569617264752"/>
<node TEXT="@Primary" ID="ID_1600150630" CREATED="1569617264752" MODIFIED="1569617264752"/>
<node TEXT="@Bean" ID="ID_1584884205" CREATED="1569617264753" MODIFIED="1569617264753"/>
<node TEXT="public DefaultTokenServices tokenService() {" ID="ID_145380087" CREATED="1569617264753" MODIFIED="1569617264753">
<node TEXT="DefaultTokenServices tokenService = new DefaultTokenServices();" ID="ID_1371306269" CREATED="1569617264753" MODIFIED="1569617264753"/>
<node TEXT="tokenService.setTokenStore(jwtTokenStore());" ID="ID_1405542859" CREATED="1569617264754" MODIFIED="1569617264754"/>
<node TEXT="return tokenService;" ID="ID_1240495779" CREATED="1569617264754" MODIFIED="1569617264754"/>
</node>
<node TEXT="}" ID="ID_1081035271" CREATED="1569617264755" MODIFIED="1569617264755"/>
</node>
<node TEXT="//        @Primary" ID="ID_559180600" CREATED="1569617264755" MODIFIED="1569617264755"/>
<node TEXT="//        @Bean" ID="ID_1552631492" CREATED="1569617264755" MODIFIED="1569617264755"/>
<node TEXT="//        public RemoteTokenServices tokenService() {" ID="ID_28648691" CREATED="1569617264756" MODIFIED="1569617264756"/>
<node TEXT="//" ID="ID_1226858689" CREATED="1569617264756" MODIFIED="1569617264756"/>
<node TEXT="//                RemoteTokenServices tokenService = new RemoteTokenServices();" ID="ID_565306374" CREATED="1569617264757" MODIFIED="1569617264757"/>
<node TEXT="//                tokenService.setCheckTokenEndpointUrl(&quot;http://localhost:8081/oauth/check_token&quot;);" ID="ID_618692506" CREATED="1569617264757" MODIFIED="1569617264757" LINK="http://localhost:8081/oauth/check_token"/>
<node TEXT="//                tokenService.setClientId(&quot;TctTest&quot;);" ID="ID_729686921" CREATED="1569617264759" MODIFIED="1569617264759"/>
<node TEXT="//                tokenService.setClientSecret(&quot;12341234aa&quot;);" ID="ID_231204058" CREATED="1569617264759" MODIFIED="1569617264759"/>
<node TEXT="//                tokenService.setAccessTokenConverter(converter);" ID="ID_210676299" CREATED="1569617264760" MODIFIED="1569617264760"/>
<node TEXT="//                return tokenService;" ID="ID_1553094660" CREATED="1569617264760" MODIFIED="1569617264760"/>
<node TEXT="//" ID="ID_1780146246" CREATED="1569617264761" MODIFIED="1569617264761"/>
<node TEXT="//        }" ID="ID_1818509761" CREATED="1569617264761" MODIFIED="1569617264761"/>
<node TEXT="}" ID="ID_627315393" CREATED="1569617264761" MODIFIED="1569617264761"/>
</node>
<node TEXT="중요한것 RemoteTokenService를 사용" ID="ID_126396975" CREATED="1569617266815" MODIFIED="1569853705438">
<node TEXT="publicKey를 추가함" ID="ID_1030356084" CREATED="1569617391344" MODIFIED="1569617398084"/>
<node TEXT="remoteTokenService를 안쓰고 DefaultTokenService를 사용한다. 이 말은 authorization server에서 check_token을 사용하지 않는 다는 것. RemoteTokenService를 사용하면 jwt 자체 인증을 하지 않고, 인증서버에 의존한다.&#xa;아무튼 여기서 중요한것은 JwtTokenStore 를 사용한다는 것" FOLDED="true" ID="ID_901617287" CREATED="1569617687791" MODIFIED="1569619805406">
<node TEXT="@Primary" ID="ID_1199102886" CREATED="1569618007348" MODIFIED="1569618007348"/>
<node TEXT="@Bean" ID="ID_525165440" CREATED="1569618007349" MODIFIED="1569618007349"/>
<node TEXT="public DefaultTokenServices tokenService() {" ID="ID_368430232" CREATED="1569618007350" MODIFIED="1569618007350">
<node TEXT="DefaultTokenServices tokenService = new DefaultTokenServices();" ID="ID_893041486" CREATED="1569618007350" MODIFIED="1569618007350"/>
<node TEXT="tokenService.setTokenStore(jwtTokenStore());" ID="ID_1705075723" CREATED="1569618007351" MODIFIED="1569618007351"/>
<node TEXT="return tokenService;" ID="ID_1833519524" CREATED="1569618007351" MODIFIED="1569618007351"/>
</node>
<node TEXT="}" ID="ID_1612694520" CREATED="1569618007351" MODIFIED="1569618007351"/>
</node>
<node TEXT="JwtToketStore는 어떠한 JwtTokenConverter를 사용할 것인지 명확한 설정이 필요하다." FOLDED="true" ID="ID_442540319" CREATED="1569618097728" MODIFIED="1569619805408">
<node TEXT="@Bean" ID="ID_962996332" CREATED="1569618225583" MODIFIED="1569618225583"/>
<node TEXT="public TokenStore jwtTokenStore() {" ID="ID_1544403095" CREATED="1569618225585" MODIFIED="1569618225585">
<node TEXT="return new JwtTokenStore(tokenConvter());" ID="ID_919617199" CREATED="1569618225585" MODIFIED="1569618225585"/>
</node>
<node TEXT="}" ID="ID_1959895045" CREATED="1569618225586" MODIFIED="1569618225586"/>
</node>
<node TEXT="JwtTokenConverter는 이전에 사용했던 customConvter를 사용한다." ID="ID_141622727" CREATED="1569618311242" MODIFIED="1569618344465" LINK="#ID_599332254"/>
<node TEXT="JwtTokenConverter는 publickey 그러니까 jwt를 인증하는 역할을 하는 키를 세팅하고 customConverter도 세팅한다." FOLDED="true" ID="ID_1947638458" CREATED="1569618227273" MODIFIED="1569619805408">
<node TEXT="@Bean" ID="ID_1576295268" CREATED="1569618675749" MODIFIED="1569618675749"/>
<node TEXT="public JwtAccessTokenConverter tokenConvter() {" ID="ID_909368576" CREATED="1569618675750" MODIFIED="1569618675750">
<node TEXT="JwtAccessTokenConverter jwtAccessTokenConverter = new JwtAccessTokenConverter();" ID="ID_672034783" CREATED="1569618675751" MODIFIED="1569618675751"/>
<node TEXT="jwtAccessTokenConverter.setVerifierKey(publicKey);" ID="ID_927485964" CREATED="1569618675751" MODIFIED="1569618675751"/>
<node TEXT="jwtAccessTokenConverter.setAccessTokenConverter(converter);" ID="ID_1704816106" CREATED="1569618675752" MODIFIED="1569618675752"/>
<node TEXT="return jwtAccessTokenConverter;" ID="ID_1991286710" CREATED="1569618675752" MODIFIED="1569618675752"/>
</node>
<node TEXT="}" ID="ID_1471865054" CREATED="1569618675752" MODIFIED="1569618675752"/>
</node>
</node>
<node TEXT="결과" ID="ID_424083237" CREATED="1569619367012" MODIFIED="1569926514475">
<node TEXT="헤더" FOLDED="true" ID="ID_1792075871" CREATED="1569620479534" MODIFIED="1572219199445">
<node TEXT="GET /foo/1 HTTP/1.1" ID="ID_1595077203" CREATED="1569620480575" MODIFIED="1569620480575"/>
<node TEXT="Host: 127.0.0.1:8082" ID="ID_78572515" CREATED="1569620480576" MODIFIED="1569620480576"/>
<node TEXT="Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJUY3RUZXN0QGdtYWlsLmNvbSIsInNjb3BlIjpbInJlYWQiLCJ3cml0ZSJdLCJleHAiOjE1Njk2NTI0NDIsInVzZXJJZCI6IjEyMzEyMyIsImF1dGhvcml0aWVzIjpbIlJPTEVfU1lTVEVNQURNSU4iXSwianRpIjoiMjcxZTgwMTUtZTY2OS00YTY1LWI5MzMtZThmYmRjNDRhY2E3IiwiY2xpZW50X2lkIjoiVGN0VGVzdCJ9.2Nhb9YuCDuBZVa3T0_KyoewMU7PcQJh4uprItqOLw_3b9rz33s8x8Jv2yNnGjKVberc3PaXu2QpaeXMemsQADjeVIUyInVwb0abIWKzaqBInwVbuSWltqURgSu4xchMf0UVjNjy3-M3b2dOW8pXRv2XuBQO39BQHaJcx0H-gz49Y5U2Qst14zhttwb7G5cj5TYb3jdx1GakNlZ1_e1a0IrA_tOvz9tpt18jg8_OyG1zsuzLexJrtUanEY58NbtkGR0mGfXRt7wf4muHvC56ewJFGri7nD7-RPNX8M9w81lnlyumBq3Ysmo9VWuB-JVJgpcAqKtSwE-k1wViFSqubLw" ID="ID_1187543377" CREATED="1569620480577" MODIFIED="1569620480577"/>
<node TEXT="User-Agent: PostmanRuntime/7.17.1" ID="ID_685077693" CREATED="1569620480592" MODIFIED="1569620480592"/>
<node TEXT="Accept: */*" ID="ID_1836542649" CREATED="1569620480593" MODIFIED="1569620480593"/>
<node TEXT="Cache-Control: no-cache" ID="ID_1655812523" CREATED="1569620480594" MODIFIED="1569620480594"/>
<node TEXT="Postman-Token: 7087e8a2-943d-43f3-b720-6bd35f59a255,92899045-c9e4-4d25-a008-9ca6632ec26e" ID="ID_1835474008" CREATED="1569620480595" MODIFIED="1569620480595"/>
<node TEXT="Host: 127.0.0.1:8082" ID="ID_1360162589" CREATED="1569620480595" MODIFIED="1569620480595"/>
<node TEXT="Accept-Encoding: gzip, deflate" ID="ID_1867678054" CREATED="1569620480596" MODIFIED="1569620480596"/>
<node TEXT="Connection: keep-alive" ID="ID_1658515623" CREATED="1569620480597" MODIFIED="1569620480597"/>
<node TEXT="cache-control: no-cache" ID="ID_1499993187" CREATED="1569620480597" MODIFIED="1569620480597"/>
</node>
<node TEXT="실제 controller에서는 checkConverter를 사용한다." ID="ID_160010231" CREATED="1569619823485" MODIFIED="1569926515418">
<node TEXT="System.out.println(checkConverter.getCheckTokenResult().toString());" ID="ID_593659689" CREATED="1569619854949" MODIFIED="1569619854949"/>
<node TEXT="출력(이미지)" ID="ID_1782714638" CREATED="1569619859868" MODIFIED="1569926516656">
<node ID="ID_1048027385" CREATED="1569619863335" MODIFIED="1569619863335"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_3266117786422938642.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
</node>
</node>
</node>
</node>
<node TEXT="publicKey와 privateKey txt로 만들기" FOLDED="true" ID="ID_1875519948" CREATED="1569621605496" MODIFIED="1614153221488" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="resouse에 해당 키 만들기(이미지)" FOLDED="true" ID="ID_37482009" CREATED="1569626030243" MODIFIED="1569926482692">
<node ID="ID_12881029" CREATED="1569626046432" MODIFIED="1569626046432"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_8526119998227521526.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="가지고 오기(코드)" FOLDED="true" ID="ID_1506803125" CREATED="1569626063408" MODIFIED="1614153221488">
<node TEXT="@Bean" ID="ID_1090912689" CREATED="1569626074120" MODIFIED="1569626074120"/>
<node TEXT="public JwtAccessTokenConverter tokenEnhancerJwt() {" ID="ID_1681638383" CREATED="1569626074121" MODIFIED="1569626074121">
<node TEXT="Resource privateKeyRes = new ClassPathResource(&quot;key/privateKey.txt&quot;);" ID="ID_337525174" CREATED="1569626074122" MODIFIED="1569626074122"/>
<node TEXT="Resource publicKeyRes = new ClassPathResource(&quot;key/publicKey.txt&quot;);" ID="ID_1440958443" CREATED="1569626074123" MODIFIED="1569626074123"/>
<node TEXT="try {" ID="ID_461184156" CREATED="1569626074124" MODIFIED="1569626074124">
<node TEXT="this.privateKey = new String(IOUtils.toByteArray(privateKeyRes.getInputStream()));" ID="ID_1058940709" CREATED="1569626074125" MODIFIED="1569626074125"/>
<node TEXT="this.publicKey = new String(IOUtils.toByteArray(publicKeyRes.getInputStream()));" ID="ID_1255329422" CREATED="1569626074126" MODIFIED="1569626074126"/>
</node>
<node TEXT="} catch (IOException e) {" ID="ID_1622482761" CREATED="1569626074127" MODIFIED="1569626074127">
<node TEXT="// TODO Auto-generated catch block" ID="ID_519425084" CREATED="1569626074128" MODIFIED="1569626074128"/>
<node TEXT="e.printStackTrace();" ID="ID_1700724565" CREATED="1569626074128" MODIFIED="1569626074128"/>
</node>
<node TEXT="}" ID="ID_630669784" CREATED="1569626074129" MODIFIED="1569626074129"/>
<node TEXT="JwtAccessTokenConverter converter = new JwtAccessTokenConverter();" ID="ID_970866091" CREATED="1569626074130" MODIFIED="1569626074130"/>
<node TEXT="converter.setSigningKey(privateKey);" ID="ID_511246688" CREATED="1569626074131" MODIFIED="1569626074131"/>
<node TEXT="converter.setVerifierKey(publicKey);" ID="ID_1381938106" CREATED="1569626074131" MODIFIED="1569626074131"/>
<node TEXT="return converter;" ID="ID_436912301" CREATED="1569626074132" MODIFIED="1569626074132"/>
</node>
<node TEXT="}" ID="ID_389724725" CREATED="1569626074133" MODIFIED="1569626074133"/>
</node>
<node TEXT="리소스 서버는 publickey만 똑같이 설정한다." ID="ID_1834659066" CREATED="1569631391291" MODIFIED="1569631411704"/>
</node>
</node>
<node TEXT="oauth2 csrf" FOLDED="true" POSITION="right" ID="ID_271718587" CREATED="1570816979000" MODIFIED="1621472968362">
<node TEXT="스프링 보안 상에서 csrf를 정확히 지정을 안하거나 disable을 시키지 않으면 csrfFilter를 무조건 들어가게 되어있다." ID="ID_1145826729" CREATED="1570816985120" MODIFIED="1570817992028"/>
<node TEXT="관련로그" ID="ID_402518492" CREATED="1570818001247" MODIFIED="1570818005180">
<node TEXT="o.s.security.web.csrf.CsrfFilter         : Invalid CSRF token found for http://127.0.0.1:8085/member/joinMember_common" ID="ID_887229671" CREATED="1570817995679" MODIFIED="1570817995679" LINK="http://127.0.0.1:8085/member/joinMember_common"/>
</node>
<node TEXT="그럼 어떻게 해야 하는가?" ID="ID_1158679750" CREATED="1570818008864" MODIFIED="1570818012259"/>
<node TEXT="명시적으로 csrf를 지정해 주어서 csrf 토큰을 따로 가지고 오는 방법을 택해야 한다." ID="ID_1302441079" CREATED="1570818012497" MODIFIED="1570819169973" LINK="#ID_1842175976"/>
<node TEXT="csrf의 permitAll은 get만 허용된다. post는 허용 되지 않는다. 토큰이 있어야 한다." ID="ID_459888442" CREATED="1570820280004" MODIFIED="1570820398932"/>
<node TEXT="그러나 토큰이 생성될 때는 쿠키로 했으르 때 현재 경로에서 생성되지 않고 &quot;/&quot; 루트에서 생성됨으로 정확한 경로 설정이 필요하다." ID="ID_1633839874" CREATED="1570822064313" MODIFIED="1570822220332"/>
</node>
<node TEXT="oauth 정리" FOLDED="true" POSITION="right" ID="ID_1594071695" CREATED="1569486116611" MODIFIED="1621472968362">
<node TEXT="이 정리는 authorization server와 resource server 전용으로 한다." ID="ID_1004995870" CREATED="1569486121620" MODIFIED="1569486326063"/>
<node TEXT="참조한 링크" FOLDED="true" ID="ID_1918509835" CREATED="1569851795826" MODIFIED="1610433786409">
<node TEXT="https://www.tutorialspoint.com/spring_boot/spring_boot_oauth2_with_jwt.htm" ID="ID_239934634" CREATED="1569491563570" MODIFIED="1569491564360" LINK="https://www.tutorialspoint.com/spring_boot/spring_boot_oauth2_with_jwt.htm"/>
<node TEXT="https://www.baeldung.com/rest-api-spring-oauth2-angular" ID="ID_40553319" CREATED="1569190011486" MODIFIED="1569491618974" LINK="https://www.baeldung.com/rest-api-spring-oauth2-angular"/>
<node TEXT="https://www.baeldung.com/spring-security-oauth-jwt" ID="ID_1249422750" CREATED="1569528171850" MODIFIED="1569528171850" LINK="https://www.baeldung.com/spring-security-oauth-jwt"/>
</node>
<node TEXT="1.maven" ID="ID_516070361" CREATED="1569486326299" MODIFIED="1614246077259">
<node TEXT="&lt;!-- https://mvnrepository.com/artifact/com.h2database/h2 --&gt;" ID="ID_227904730" CREATED="1569486622040" MODIFIED="1569486622040" LINK="https://mvnrepository.com/artifact/com.h2database/h2"/>
<node TEXT="&lt;dependency&gt;" FOLDED="true" ID="ID_718077643" CREATED="1569486622045" MODIFIED="1606122066149">
<node TEXT="&lt;groupId&gt;com.h2database&lt;/groupId&gt;" ID="ID_1492004077" CREATED="1569486622048" MODIFIED="1569486622048"/>
<node TEXT="&lt;artifactId&gt;h2&lt;/artifactId&gt;" ID="ID_720591969" CREATED="1569486622050" MODIFIED="1569486622050"/>
<node TEXT="&lt;version&gt;1.4.199&lt;/version&gt;" ID="ID_285360319" CREATED="1569486622054" MODIFIED="1569486622054"/>
<node TEXT="&lt;scope&gt;test&lt;/scope&gt;" ID="ID_419699667" CREATED="1569486622056" MODIFIED="1569486622056"/>
</node>
<node TEXT="&lt;/dependency&gt;" ID="ID_1799743336" CREATED="1569486622058" MODIFIED="1569486622058"/>
<node TEXT="&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-security --&gt;" ID="ID_920619554" CREATED="1569486630585" MODIFIED="1569486630585" LINK="https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-security"/>
<node TEXT="&lt;dependency&gt;" FOLDED="true" ID="ID_1394287325" CREATED="1569486630589" MODIFIED="1606122066149">
<node TEXT="&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;" ID="ID_1772689673" CREATED="1569486630591" MODIFIED="1569486630591"/>
<node TEXT="&lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;" ID="ID_412514896" CREATED="1569486630593" MODIFIED="1569486630593"/>
</node>
<node TEXT="&lt;/dependency&gt;" ID="ID_661450990" CREATED="1569486630595" MODIFIED="1569486630595"/>
<node TEXT="&lt;!-- https://mvnrepository.com/artifact/org.springframework.security.oauth/spring-security-oauth2 --&gt;" ID="ID_1931279050" CREATED="1569486820199" MODIFIED="1569486820199" LINK="https://mvnrepository.com/artifact/org.springframework.security.oauth/spring-security-oauth2"/>
<node TEXT="&lt;dependency&gt;" FOLDED="true" ID="ID_1845577608" CREATED="1569486820204" MODIFIED="1606122066149">
<node TEXT="&lt;groupId&gt;org.springframework.security.oauth&lt;/groupId&gt;" ID="ID_1680161791" CREATED="1569486820205" MODIFIED="1569486820205"/>
<node TEXT="&lt;artifactId&gt;spring-security-oauth2&lt;/artifactId&gt;" ID="ID_1921111566" CREATED="1569486820208" MODIFIED="1569486820208"/>
<node TEXT="&lt;version&gt;2.3.6.RELEASE&lt;/version&gt;" ID="ID_910117941" CREATED="1569486820210" MODIFIED="1569486820210"/>
</node>
<node TEXT="&lt;/dependency&gt;" ID="ID_1850612837" CREATED="1569486820212" MODIFIED="1569486820212"/>
<node TEXT="&lt;!-- https://mvnrepository.com/artifact/org.springframework.security/spring-security-jwt --&gt;" ID="ID_951659819" CREATED="1569486820214" MODIFIED="1569486820214" LINK="https://mvnrepository.com/artifact/org.springframework.security/spring-security-jwt"/>
<node TEXT="&lt;dependency&gt;" FOLDED="true" ID="ID_1938334113" CREATED="1569486820216" MODIFIED="1606122066149">
<node TEXT="&lt;groupId&gt;org.springframework.security&lt;/groupId&gt;" ID="ID_601181225" CREATED="1569486820218" MODIFIED="1569486820218"/>
<node TEXT="&lt;artifactId&gt;spring-security-jwt&lt;/artifactId&gt;" ID="ID_1616073809" CREATED="1569486820220" MODIFIED="1569486820220"/>
<node TEXT="&lt;version&gt;1.0.10.RELEASE&lt;/version&gt;" ID="ID_1524645728" CREATED="1569486820222" MODIFIED="1569486820222"/>
</node>
<node TEXT="&lt;/dependency&gt;" ID="ID_323771097" CREATED="1569486820223" MODIFIED="1569486820223"/>
<node TEXT="&lt;!-- https://mvnrepository.com/artifact/org.bouncycastle/bcprov-jdk15on --&gt;" ID="ID_1363099635" CREATED="1569486820225" MODIFIED="1569486820225" LINK="https://mvnrepository.com/artifact/org.bouncycastle/bcprov-jdk15on"/>
<node TEXT="&lt;dependency&gt;" ID="ID_130587254" CREATED="1569486820227" MODIFIED="1614246077275">
<node TEXT="&lt;groupId&gt;org.bouncycastle&lt;/groupId&gt;" ID="ID_940743200" CREATED="1569486820230" MODIFIED="1569486820230"/>
<node TEXT="&lt;artifactId&gt;bcprov-jdk15on&lt;/artifactId&gt;" ID="ID_1634837365" CREATED="1569486820232" MODIFIED="1569486820232"/>
<node TEXT="&lt;version&gt;1.63&lt;/version&gt;" ID="ID_215297043" CREATED="1569486820234" MODIFIED="1569486820234"/>
</node>
<node TEXT="&lt;/dependency&gt;" ID="ID_948662660" CREATED="1569486820235" MODIFIED="1569486820235"/>
<node TEXT="&lt;!-- https://mvnrepository.com/artifact/commons-io/commons-io --&gt;" ID="ID_1158284156" CREATED="1569851827080" MODIFIED="1569851827080" LINK="https://mvnrepository.com/artifact/commons-io/commons-io"/>
<node TEXT="&lt;dependency&gt;" FOLDED="true" ID="ID_1828228156" CREATED="1569851827083" MODIFIED="1606122066149">
<node TEXT="&lt;groupId&gt;commons-io&lt;/groupId&gt;" ID="ID_79009669" CREATED="1569851827084" MODIFIED="1569851827084"/>
<node TEXT="&lt;artifactId&gt;commons-io&lt;/artifactId&gt;" ID="ID_79067601" CREATED="1569851827087" MODIFIED="1569851827087"/>
<node TEXT="&lt;version&gt;2.6&lt;/version&gt;" ID="ID_1513922443" CREATED="1569851827089" MODIFIED="1569851827089"/>
</node>
<node TEXT="&lt;/dependency&gt;" ID="ID_494780542" CREATED="1569851827090" MODIFIED="1569851827090"/>
</node>
<node TEXT="2. authorizationServer" ID="ID_435723941" CREATED="1569486869099" MODIFIED="1614153221535">
<node TEXT="코드" ID="ID_1158556452" CREATED="1569488041996" MODIFIED="1569867930359">
<node TEXT="package com.framework.Tct.oAuth2;" ID="ID_1609509202" CREATED="1569868151413" MODIFIED="1569868151413"/>
<node TEXT="import java.io.IOException;" ID="ID_807616539" CREATED="1569868151416" MODIFIED="1569868151416"/>
<node TEXT="import java.util.ArrayList;" ID="ID_644889233" CREATED="1569868151418" MODIFIED="1569868151418"/>
<node TEXT="import java.util.List;" ID="ID_1902118232" CREATED="1569868151420" MODIFIED="1569868151420"/>
<node TEXT="import javax.sql.DataSource;" ID="ID_1324796756" CREATED="1569868151422" MODIFIED="1569868151422"/>
<node TEXT="import org.apache.commons.io.IOUtils;" ID="ID_1512110862" CREATED="1569868151424" MODIFIED="1569868151424"/>
<node TEXT="import org.mockito.internal.util.io.IOUtil;" ID="ID_61281955" CREATED="1569868151425" MODIFIED="1569868151425"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_1601306162" CREATED="1569868151427" MODIFIED="1569868151427"/>
<node TEXT="import org.springframework.beans.factory.annotation.Qualifier;" ID="ID_1905102304" CREATED="1569868151428" MODIFIED="1569868151428"/>
<node TEXT="import org.springframework.context.annotation.Bean;" ID="ID_1816425708" CREATED="1569868151432" MODIFIED="1569868151432"/>
<node TEXT="import org.springframework.context.annotation.Configuration;" ID="ID_318578177" CREATED="1569868151433" MODIFIED="1569868151433"/>
<node TEXT="import org.springframework.core.io.ClassPathResource;" ID="ID_679027415" CREATED="1569868151435" MODIFIED="1569868151435"/>
<node TEXT="import org.springframework.core.io.Resource;" ID="ID_1268879878" CREATED="1569868151437" MODIFIED="1569868151437"/>
<node TEXT="import org.springframework.security.authentication.AuthenticationManager;" ID="ID_1118003219" CREATED="1569868151440" MODIFIED="1569868151440"/>
<node TEXT="import org.springframework.security.crypto.password.PasswordEncoder;" ID="ID_46949733" CREATED="1569868151441" MODIFIED="1569868151441"/>
<node TEXT="import org.springframework.security.oauth2.config.annotation.configurers.ClientDetailsServiceConfigurer;" ID="ID_1593076932" CREATED="1569868151443" MODIFIED="1569868151443"/>
<node TEXT="import org.springframework.security.oauth2.config.annotation.web.configuration.AuthorizationServerConfigurerAdapter;" ID="ID_1412941387" CREATED="1569868151444" MODIFIED="1569868151444"/>
<node TEXT="import org.springframework.security.oauth2.config.annotation.web.configuration.EnableAuthorizationServer;" ID="ID_330932638" CREATED="1569868151445" MODIFIED="1569868151445"/>
<node TEXT="import org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerEndpointsConfigurer;" ID="ID_1536631897" CREATED="1569868151446" MODIFIED="1569868151446"/>
<node TEXT="import org.springframework.security.oauth2.config.annotation.web.configurers.AuthorizationServerSecurityConfigurer;" ID="ID_1831014863" CREATED="1569868151447" MODIFIED="1569868151447"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.TokenEnhancer;" ID="ID_38241691" CREATED="1569868151449" MODIFIED="1569868151449"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.TokenEnhancerChain;" ID="ID_86126638" CREATED="1569868151450" MODIFIED="1569868151450"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.TokenStore;" ID="ID_432955388" CREATED="1569868151451" MODIFIED="1569868151451"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.store.JdbcTokenStore;" ID="ID_1373559199" CREATED="1569868151451" MODIFIED="1569868151451"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.store.JwtAccessTokenConverter;" ID="ID_945461854" CREATED="1569868151452" MODIFIED="1569868151452"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.store.JwtTokenStore;" ID="ID_21314894" CREATED="1569868151453" MODIFIED="1569868151453"/>
<node TEXT="@Configuration" ID="ID_66777160" CREATED="1569868151453" MODIFIED="1569868151453"/>
<node TEXT="@EnableAuthorizationServer" ID="ID_4652886" CREATED="1569868151454" MODIFIED="1569868151454"/>
<node TEXT="//@EnableResourceServer" ID="ID_96642946" CREATED="1569868151455" MODIFIED="1569868151455" LINK="mailto://@EnableResourceServer"/>
<node TEXT="public class OAuth2Config extends AuthorizationServerConfigurerAdapter  {" FOLDED="true" ID="ID_1783500746" CREATED="1569868151455" MODIFIED="1570217406938">
<node TEXT="@Autowired" ID="ID_965584980" CREATED="1569868151456" MODIFIED="1569868151456"/>
<node TEXT="PasswordEncoder encoder;" ID="ID_1455986187" CREATED="1569868151456" MODIFIED="1569868151456"/>
<node TEXT="@Autowired" ID="ID_140122633" CREATED="1569868151457" MODIFIED="1569868151457"/>
<node TEXT="@Qualifier(&quot;primaryDataSource&quot;)" ID="ID_882019401" CREATED="1569868151457" MODIFIED="1569868151457"/>
<node TEXT="DataSource primaryDatasource;" ID="ID_1181186890" CREATED="1569868151458" MODIFIED="1569868151458"/>
<node TEXT="@Autowired" ID="ID_1222945177" CREATED="1569868151458" MODIFIED="1569868151458"/>
<node TEXT="CustomDetailService userDetailsService;" ID="ID_1081487456" CREATED="1569868151459" MODIFIED="1569868151459"/>
<node TEXT="private String clinetId = &quot;TctTest&quot;;" ID="ID_1224376666" CREATED="1569868151459" MODIFIED="1569868151459"/>
<node TEXT="private String clientSeceret = &quot;12341234aa&quot;;" ID="ID_56602322" CREATED="1569868151459" MODIFIED="1569868151459"/>
<node TEXT="private String privateKey = &quot;&quot;;" ID="ID_252172254" CREATED="1569868151460" MODIFIED="1569868151460"/>
<node TEXT="private String publicKey = &quot;&quot;;" ID="ID_908656518" CREATED="1569868151461" MODIFIED="1569868151461"/>
<node TEXT="private int tokenValidSec = 20000;" ID="ID_1119602162" CREATED="1569868151461" MODIFIED="1569868151461"/>
<node TEXT="private int refreshTokenValidSec = 20000;" ID="ID_1843789283" CREATED="1569868151462" MODIFIED="1569868151462"/>
<node TEXT="@Autowired" ID="ID_355167655" CREATED="1569868151462" MODIFIED="1569868151462"/>
<node TEXT="private AuthenticationManager authenticationManager;" ID="ID_779501431" CREATED="1569868151463" MODIFIED="1569868151463"/>
<node TEXT="@Bean" ID="ID_1563372013" CREATED="1569868151463" MODIFIED="1569868151463"/>
<node TEXT="public JwtAccessTokenConverter tokenEnhancerJwt() {" ID="ID_1224480310" CREATED="1569868151464" MODIFIED="1569868151464">
<node TEXT="Resource privateKeyRes = new ClassPathResource(&quot;key/privateKey.txt&quot;);" ID="ID_1176841119" CREATED="1569868151464" MODIFIED="1569868151464"/>
<node TEXT="Resource publicKeyRes = new ClassPathResource(&quot;key/publicKey.txt&quot;);" ID="ID_651732188" CREATED="1569868151465" MODIFIED="1569868151465"/>
<node TEXT="try {" ID="ID_1396978952" CREATED="1569868151465" MODIFIED="1569868151465">
<node TEXT="this.privateKey = new String(IOUtils.toByteArray(privateKeyRes.getInputStream()));" ID="ID_518152976" CREATED="1569868151466" MODIFIED="1569868151466"/>
<node TEXT="this.publicKey = new String(IOUtils.toByteArray(publicKeyRes.getInputStream()));" ID="ID_1668188376" CREATED="1569868151467" MODIFIED="1569868151467"/>
</node>
<node TEXT="} catch (IOException e) {" ID="ID_1715135464" CREATED="1569868151467" MODIFIED="1569868151467">
<node TEXT="// TODO Auto-generated catch block" ID="ID_210985682" CREATED="1569868151467" MODIFIED="1569868151467"/>
<node TEXT="e.printStackTrace();" ID="ID_1286639934" CREATED="1569868151468" MODIFIED="1569868151468"/>
</node>
<node TEXT="}" ID="ID_1597290735" CREATED="1569868151468" MODIFIED="1569868151468"/>
<node TEXT="JwtAccessTokenConverter converter = new JwtAccessTokenConverter();" ID="ID_1112769899" CREATED="1569868151469" MODIFIED="1569868151469"/>
<node TEXT="converter.setSigningKey(privateKey);" ID="ID_1701022200" CREATED="1569868151469" MODIFIED="1569868151469"/>
<node TEXT="converter.setVerifierKey(publicKey);" ID="ID_978300480" CREATED="1569868151470" MODIFIED="1569868151470"/>
<node TEXT="return converter;" ID="ID_1367995028" CREATED="1569868151470" MODIFIED="1569868151470"/>
</node>
<node TEXT="}" ID="ID_1070849856" CREATED="1569868151471" MODIFIED="1569868151471"/>
<node TEXT="@Bean" ID="ID_732498773" CREATED="1569868151471" MODIFIED="1569868151471"/>
<node TEXT="public TokenEnhancer tokenEnhancer() {" ID="ID_758452134" CREATED="1569868151472" MODIFIED="1569868151472">
<node TEXT="return new CustomDefaultTokenEnhancer();" ID="ID_1779164652" CREATED="1569868151472" MODIFIED="1569868151472"/>
</node>
<node TEXT="}" ID="ID_1258888028" CREATED="1569868151473" MODIFIED="1569868151473"/>
<node TEXT="@Override" ID="ID_1824747521" CREATED="1569868151473" MODIFIED="1569868151473"/>
<node TEXT="public void configure(AuthorizationServerSecurityConfigurer security) throws Exception {" ID="ID_409841412" CREATED="1569868151474" MODIFIED="1569868151474">
<node TEXT="// TODO Auto-generated method stub" ID="ID_648159269" CREATED="1569868151474" MODIFIED="1569868151474"/>
<node TEXT="//super.configure(security);" ID="ID_1305839102" CREATED="1569868151474" MODIFIED="1569868151474"/>
<node TEXT="security.tokenKeyAccess(&quot;permitAll()&quot;).checkTokenAccess(&quot;isAuthenticated()&quot;);" ID="ID_1964091237" CREATED="1569868151475" MODIFIED="1569868151475"/>
</node>
<node TEXT="}" ID="ID_592571980" CREATED="1569868151475" MODIFIED="1569868151475"/>
<node TEXT="@Override" ID="ID_1793006771" CREATED="1569868151476" MODIFIED="1569868151476"/>
<node TEXT="public void configure(ClientDetailsServiceConfigurer clients) throws Exception {" ID="ID_42796705" CREATED="1569868151476" MODIFIED="1569868151476">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1733501470" CREATED="1569868151476" MODIFIED="1569868151476"/>
<node TEXT="//super.configure(clients);" ID="ID_572982455" CREATED="1569868151477" MODIFIED="1569868151477"/>
<node TEXT="System.out.println(&quot;passsssssssssssssssssssssssssssssssssss&quot;);" ID="ID_1530179722" CREATED="1569868151477" MODIFIED="1569868151477"/>
<node TEXT="System.out.println(encoder.encode(clientSeceret));" ID="ID_970794862" CREATED="1569868151477" MODIFIED="1569868151477"/>
<node TEXT="clients.jdbc(primaryDatasource)" ID="ID_90539352" CREATED="1569868151478" MODIFIED="1569868151478"/>
<node TEXT=".withClient(&quot;sampleClinetId&quot;)" ID="ID_1554403293" CREATED="1569868151478" MODIFIED="1569868151478"/>
<node TEXT=".authorizedGrantTypes(&quot;implicit&quot;)" ID="ID_206673211" CREATED="1569868151478" MODIFIED="1569868151478"/>
<node TEXT=".scopes(&quot;read&quot;,&quot;write&quot;)" ID="ID_775361292" CREATED="1569868151479" MODIFIED="1569868151479"/>
<node TEXT=".autoApprove(true)" ID="ID_385121907" CREATED="1569868151479" MODIFIED="1569868151479"/>
<node TEXT=".redirectUris(&quot;https://daum.net&quot;)" ID="ID_751080473" CREATED="1569868151480" MODIFIED="1569868151480" LINK="https://daum.net"/>
<node TEXT=".and()" ID="ID_1845883980" CREATED="1569868151480" MODIFIED="1569868151480"/>
<node TEXT=".withClient(clinetId)" ID="ID_609064447" CREATED="1569868151480" MODIFIED="1569868151480"/>
<node TEXT=".secret(encoder.encode(clientSeceret))" ID="ID_778135790" CREATED="1569868151481" MODIFIED="1569868151481"/>
<node TEXT=".authorizedGrantTypes(" ID="ID_1055607149" CREATED="1569868151481" MODIFIED="1569868151481">
<node TEXT="&quot;password&quot;,&quot;authorization_code&quot;,&quot;refresh_token&quot;)" ID="ID_1211785933" CREATED="1569868151482" MODIFIED="1569868151482"/>
</node>
<node TEXT=".scopes(&quot;read&quot;,&quot;write&quot;);" ID="ID_629127886" CREATED="1569868151482" MODIFIED="1569868151482"/>
</node>
<node TEXT="}" ID="ID_1225353109" CREATED="1569868151483" MODIFIED="1569868151483"/>
</node>
<node TEXT="// jwt 말고 deault 토큰" ID="ID_1947509677" CREATED="1569868151483" MODIFIED="1569868151483"/>
<node TEXT="//        @Override" ID="ID_361365589" CREATED="1569868151484" MODIFIED="1569868151484"/>
<node TEXT="//        public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {" ID="ID_103147488" CREATED="1569868151484" MODIFIED="1569868151484"/>
<node TEXT="//                // TODO Auto-generated method stub" ID="ID_1987369597" CREATED="1569868151485" MODIFIED="1569868151485"/>
<node TEXT="//                //super.configure(endpoints);" ID="ID_1881520222" CREATED="1569868151485" MODIFIED="1569868151485"/>
<node TEXT="//                endpoints" ID="ID_1422105856" CREATED="1569868151485" MODIFIED="1569868151485"/>
<node TEXT="//                .authenticationManager(authenticationManager)" ID="ID_863824986" CREATED="1569868151486" MODIFIED="1569868151486"/>
<node TEXT="//                .tokenStore(tokenStore())" ID="ID_1562829535" CREATED="1569868151486" MODIFIED="1569868151486"/>
<node TEXT="//                .accessTokenConverter(new DefaultAccessTokenConverter())" ID="ID_661515842" CREATED="1569868151487" MODIFIED="1569868151487"/>
<node TEXT="//                .userDetailsService(userDetailsService)" ID="ID_928389912" CREATED="1569868151487" MODIFIED="1569868151487"/>
<node TEXT="//                .tokenEnhancer(tokenEnhancer());" ID="ID_1208989461" CREATED="1569868151488" MODIFIED="1569868151488"/>
<node TEXT="//        }" FOLDED="true" ID="ID_1056953318" CREATED="1569868151488" MODIFIED="1599021556533">
<node TEXT="@Override" ID="ID_1536893536" CREATED="1569868151489" MODIFIED="1569868151489"/>
<node TEXT="public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {" ID="ID_800785795" CREATED="1569868151489" MODIFIED="1569868151489">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1557894352" CREATED="1569868151490" MODIFIED="1569868151490"/>
<node TEXT="//super.configure(endpoints);" ID="ID_392365362" CREATED="1569868151490" MODIFIED="1569868151490"/>
<node TEXT="List&lt;TokenEnhancer&gt; tokenEnhancerList = new ArrayList&lt;&gt;();" ID="ID_996719544" CREATED="1569868151491" MODIFIED="1569868151491"/>
<node TEXT="tokenEnhancerList.add(tokenEnhancer());" ID="ID_701809420" CREATED="1569868151491" MODIFIED="1569868151491"/>
<node TEXT="tokenEnhancerList.add(tokenEnhancerJwt());" ID="ID_556547102" CREATED="1569868151491" MODIFIED="1569868151491"/>
<node TEXT="TokenEnhancerChain enhacerChain = new TokenEnhancerChain();" ID="ID_88434658" CREATED="1569868151492" MODIFIED="1569868151492"/>
<node TEXT="enhacerChain.setTokenEnhancers(tokenEnhancerList);" ID="ID_1542786655" CREATED="1569868151492" MODIFIED="1569868151492"/>
<node TEXT="endpoints" ID="ID_1071116970" CREATED="1569868151492" MODIFIED="1569868151492"/>
<node TEXT=".authenticationManager(authenticationManager)" ID="ID_46046183" CREATED="1569868151493" MODIFIED="1569868151493"/>
<node TEXT=".tokenStore(tokenStore())" ID="ID_1061547709" CREATED="1569868151493" MODIFIED="1569868151493"/>
<node TEXT=".userDetailsService(userDetailsService)" ID="ID_1647958821" CREATED="1569868151493" MODIFIED="1569868151493"/>
<node TEXT=".tokenEnhancer(enhacerChain);" ID="ID_412201310" CREATED="1569868151494" MODIFIED="1569868151494"/>
</node>
<node TEXT="}" ID="ID_1500782490" CREATED="1569868151494" MODIFIED="1569868151494"/>
<node TEXT="@Bean" ID="ID_1808871179" CREATED="1569868151495" MODIFIED="1569868151495"/>
<node TEXT="public TokenStore tokenStoreJwt() {" ID="ID_580469227" CREATED="1569868151495" MODIFIED="1569868151495">
<node TEXT="return new JwtTokenStore(tokenEnhancerJwt());" ID="ID_1533192332" CREATED="1569868151495" MODIFIED="1569868151495"/>
</node>
<node TEXT="}" ID="ID_863770594" CREATED="1569868151496" MODIFIED="1569868151496"/>
<node TEXT="@Bean" ID="ID_103417521" CREATED="1569868151496" MODIFIED="1569868151496"/>
<node TEXT="public TokenStore tokenStore() {" ID="ID_1020533831" CREATED="1569868151496" MODIFIED="1569868151496">
<node TEXT="return new JdbcTokenStore(primaryDatasource);" ID="ID_654130941" CREATED="1569868151497" MODIFIED="1569868151497"/>
</node>
<node TEXT="}" ID="ID_232472164" CREATED="1569868151497" MODIFIED="1569868151497"/>
</node>
<node TEXT="}" ID="ID_352466602" CREATED="1569868151497" MODIFIED="1569868151497"/>
</node>
<node TEXT="설명" ID="ID_371569491" CREATED="1569488036395" MODIFIED="1569801856529">
<node ID="ID_1784599909" CREATED="1569488116644" MODIFIED="1569631623267"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <p>
      public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception &#51060; &#51473;&#50836;&#54616;&#45796;. &#51648;&#44552; &#50668;&#44592;&#49436;&#45716; jdbc store&#50640; JWT&#47484; &#49324;&#50857;&#54616;&#44256; &#51080;&#45796;. jwt &#49324;&#50857;&#51008; &#44033;&#44033;&#51032; jwt store converter&#47484; &#49324;&#50857;&#54616;&#47732; &#46108;&#45796;. jdbc store&#47484; tokenEnhenser&#50640;&#49436; &#49464;&#54021;&#54616;&#47732;&#46108;&#45796;. &#51068;&#48152;&#51201;&#51064; &#53664;&#53360;&#51012; &#49324;&#50857;&#54616;&#47140;&#47732; default token converter &#51012; &#51060;&#50857;&#54616;&#47732; &#46108;&#45796;.
    </p>
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="3. websecurity" FOLDED="true" ID="ID_563097025" CREATED="1569488246196" MODIFIED="1610433786413">
<node TEXT="코드" ID="ID_1559625962" CREATED="1569850773739" MODIFIED="1606122160183">
<node TEXT="package com.framework.Tct.config;" ID="ID_1406013403" CREATED="1569850776349" MODIFIED="1569850776349"/>
<node TEXT="import java.io.IOException;" ID="ID_623403460" CREATED="1569850776350" MODIFIED="1569850776350"/>
<node TEXT="import javax.servlet.ServletException;" ID="ID_461450938" CREATED="1569850776350" MODIFIED="1569850776350"/>
<node TEXT="import javax.servlet.http.HttpServletRequest;" ID="ID_1791255362" CREATED="1569850776351" MODIFIED="1569850776351"/>
<node TEXT="import javax.servlet.http.HttpServletResponse;" ID="ID_1625162814" CREATED="1569850776351" MODIFIED="1569850776351"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_1109799316" CREATED="1569850776351" MODIFIED="1569850776351"/>
<node TEXT="import org.springframework.context.annotation.Bean;" ID="ID_978891143" CREATED="1569850776352" MODIFIED="1569850776352"/>
<node TEXT="import org.springframework.context.annotation.Configuration;" ID="ID_1402946977" CREATED="1569850776352" MODIFIED="1569850776352"/>
<node TEXT="import org.springframework.security.access.AccessDeniedException;" ID="ID_673362215" CREATED="1569850776352" MODIFIED="1569850776352"/>
<node TEXT="import org.springframework.security.authentication.AuthenticationManager;" ID="ID_565215927" CREATED="1569850776353" MODIFIED="1569850776353"/>
<node TEXT="import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;" ID="ID_327874549" CREATED="1569850776353" MODIFIED="1569850776353"/>
<node TEXT="import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;" ID="ID_681487399" CREATED="1569850776355" MODIFIED="1569850776355"/>
<node TEXT="import org.springframework.security.config.annotation.web.builders.HttpSecurity;" ID="ID_1988964452" CREATED="1569850776355" MODIFIED="1569850776355"/>
<node TEXT="import org.springframework.security.config.annotation.web.builders.WebSecurity;" ID="ID_1262119936" CREATED="1569850776356" MODIFIED="1569850776356"/>
<node TEXT="import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;" ID="ID_167361162" CREATED="1569850776356" MODIFIED="1569850776356"/>
<node TEXT="import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;" ID="ID_466062584" CREATED="1569850776357" MODIFIED="1569850776357"/>
<node TEXT="import org.springframework.security.config.http.SessionCreationPolicy;" ID="ID_1121326994" CREATED="1569850776357" MODIFIED="1569850776357"/>
<node TEXT="import org.springframework.security.core.Authentication;" ID="ID_1641395510" CREATED="1569850776357" MODIFIED="1569850776357"/>
<node TEXT="import org.springframework.security.core.AuthenticationException;" ID="ID_1771114813" CREATED="1569850776358" MODIFIED="1569850776358"/>
<node TEXT="import org.springframework.security.crypto.bcrypt.BCryptPasswordEncoder;" ID="ID_661967601" CREATED="1569850776358" MODIFIED="1569850776358"/>
<node TEXT="import org.springframework.security.crypto.password.PasswordEncoder;" ID="ID_1107283630" CREATED="1569850776358" MODIFIED="1569850776358"/>
<node TEXT="import org.springframework.security.web.AuthenticationEntryPoint;" ID="ID_1145156621" CREATED="1569850776359" MODIFIED="1569850776359"/>
<node TEXT="import org.springframework.security.web.access.AccessDeniedHandler;" ID="ID_238109980" CREATED="1569850776359" MODIFIED="1569850776359"/>
<node TEXT="import org.springframework.security.web.authentication.AuthenticationFailureHandler;" ID="ID_1132097428" CREATED="1569850776360" MODIFIED="1569850776360"/>
<node TEXT="import org.springframework.security.web.authentication.AuthenticationSuccessHandler;" ID="ID_213157045" CREATED="1569850776360" MODIFIED="1569850776360"/>
<node TEXT="import org.springframework.security.web.authentication.UsernamePasswordAuthenticationFilter;" ID="ID_1504335355" CREATED="1569850776361" MODIFIED="1569850776361"/>
<node TEXT="import org.springframework.security.web.csrf.CookieCsrfTokenRepository;" ID="ID_1493509528" CREATED="1569850776361" MODIFIED="1569850776361"/>
<node TEXT="import org.springframework.security.web.csrf.HttpSessionCsrfTokenRepository;" ID="ID_24127557" CREATED="1569850776361" MODIFIED="1569850776361"/>
<node TEXT="import org.springframework.web.server.session.HeaderWebSessionIdResolver;" ID="ID_332109152" CREATED="1569850776362" MODIFIED="1569850776362"/>
<node TEXT="import org.springframework.web.server.session.WebSessionIdResolver;" ID="ID_385885756" CREATED="1569850776362" MODIFIED="1569850776362"/>
<node TEXT="import com.framework.Tct.Const.PublicConst;" ID="ID_1379558249" CREATED="1569850776362" MODIFIED="1569850776362"/>
<node TEXT="import com.framework.Tct.oAuth2.CustomAuthFilter;" ID="ID_1455956246" CREATED="1569850776363" MODIFIED="1569850776363"/>
<node TEXT="import com.framework.Tct.oAuth2.CustomDetailService;" ID="ID_36917399" CREATED="1569850776363" MODIFIED="1569850776363"/>
<node TEXT="import com.framework.Tct.oAuth2.CustomProvider;" ID="ID_1131314943" CREATED="1569850776363" MODIFIED="1569850776363"/>
<node TEXT="@Configuration" ID="ID_1609171645" CREATED="1569850776363" MODIFIED="1569850776363"/>
<node TEXT="@EnableWebSecurity" ID="ID_179277427" CREATED="1569850776364" MODIFIED="1569850776364"/>
<node TEXT="@EnableGlobalMethodSecurity(prePostEnabled = true)" ID="ID_58870878" CREATED="1569850776364" MODIFIED="1569850776364"/>
<node TEXT="public class WebSecurityConfig extends WebSecurityConfigurerAdapter {" FOLDED="true" ID="ID_409068704" CREATED="1569850776364" MODIFIED="1606122161759">
<node TEXT="@Autowired" ID="ID_1794179373" CREATED="1569850776364" MODIFIED="1569850776364"/>
</node>
<node TEXT="//        CustomDetailService customDetailService;" FOLDED="true" ID="ID_1806519719" CREATED="1569850776365" MODIFIED="1606122161759">
<node TEXT="CustomProvider customProvider;" ID="ID_1324614869" CREATED="1569850776365" MODIFIED="1569850776365"/>
<node TEXT="@Override" ID="ID_829078801" CREATED="1569850776366" MODIFIED="1569850776366"/>
<node TEXT="protected void configure(HttpSecurity http) throws Exception {" ID="ID_586575409" CREATED="1569850776366" MODIFIED="1569850776366">
<node TEXT="// TODO Auto-generated method stub" ID="ID_505956932" CREATED="1569850776366" MODIFIED="1569850776366"/>
<node TEXT="// super.configure(http);" ID="ID_1692204662" CREATED="1569850776366" MODIFIED="1569850776366">
<node TEXT="HttpSessionCsrfTokenRepository sessionCsrf = new HttpSessionCsrfTokenRepository();" ID="ID_362557801" CREATED="1569850776367" MODIFIED="1569850776367"/>
<node TEXT="sessionCsrf.setSessionAttributeName(PublicConst.SPRING_SCURITY.CSRF_TOKEN);" ID="ID_260323015" CREATED="1569850776367" MODIFIED="1569850776367"/>
</node>
<node TEXT="CustomAuthFilter filter = new CustomAuthFilter();" ID="ID_858805763" CREATED="1569850776369" MODIFIED="1569850776369"/>
</node>
<node TEXT="filter.setAuthenticationManager(authenticationManagerBean());" ID="ID_1947237639" CREATED="1569850776369" MODIFIED="1569850776369"/>
<node TEXT="filter.setAuthenticationFailureHandler(failureHandler());" ID="ID_1750619936" CREATED="1569850776369" MODIFIED="1569850776369">
<node TEXT="/* 시큐리티 기본 베이직" ID="ID_55330891" CREATED="1569850776369" MODIFIED="1569850776369"/>
<node TEXT="http.cors().and()" ID="ID_904918618" CREATED="1569850776370" MODIFIED="1569850776370">
<node TEXT="//.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.NEVER).and()" ID="ID_872081999" CREATED="1569850776370" MODIFIED="1569850776370"/>
<node TEXT="//.csrf().disable()" ID="ID_1891067012" CREATED="1569850776371" MODIFIED="1569850776371"/>
<node TEXT=".csrf().csrfTokenRepository(getCookieCsfrTokenRepository()).and()" ID="ID_1469154460" CREATED="1569850776371" MODIFIED="1569850776371"/>
<node TEXT="//.csrf().csrfTokenRepository(sessionCsrf).and()" ID="ID_1497060717" CREATED="1569850776371" MODIFIED="1569850776371"/>
<node TEXT=".authorizeRequests().antMatchers(&quot;/&quot;, &quot;/*.js&quot;, &quot;/*.css&quot;, &quot;/assets/**&quot;, &quot;/Home/**&quot;, &quot;/getCsrfToken&quot;,&quot;/login&quot;)" ID="ID_234708960" CREATED="1569850776372" MODIFIED="1569850776372"/>
<node TEXT=".permitAll()" ID="ID_1432935257" CREATED="1569850776372" MODIFIED="1569850776372"/>
<node TEXT=".anyRequest().authenticated().and()" ID="ID_179100765" CREATED="1569850776372" MODIFIED="1569850776372"/>
</node>
</node>
</node>
<node TEXT="//                                .formLogin()" ID="ID_1646868974" CREATED="1569850776372" MODIFIED="1569850776372"/>
<node TEXT="//                                .successHandler(successHandler())" ID="ID_750940194" CREATED="1569850776373" MODIFIED="1569850776373"/>
<node TEXT="//                                .failureHandler(failureHandler())" ID="ID_1214549029" CREATED="1569850776373" MODIFIED="1569850776373"/>
<node TEXT="//                            .loginPage(&quot;/login&quot;).permitAll().and()" FOLDED="true" ID="ID_1050909738" CREATED="1569850776373" MODIFIED="1606122161759">
<node TEXT=".logout().permitAll();*/" ID="ID_731057883" CREATED="1569850776374" MODIFIED="1569850776374"/>
<node TEXT="//oAUth2 전용" ID="ID_1213510705" CREATED="1569850776374" MODIFIED="1569850776374"/>
<node TEXT="http.cors().and()" ID="ID_382826729" CREATED="1569850776374" MODIFIED="1569850776374"/>
<node TEXT=".addFilterBefore(filter, UsernamePasswordAuthenticationFilter.class)" ID="ID_286569121" CREATED="1569850776375" MODIFIED="1569850776375"/>
<node TEXT=".sessionManagement().sessionCreationPolicy(SessionCreationPolicy.NEVER).and()" ID="ID_126638876" CREATED="1569850776375" MODIFIED="1569850776375"/>
<node TEXT="//.csrf().disable()" ID="ID_1942355803" CREATED="1569850776375" MODIFIED="1569850776375"/>
<node TEXT=".csrf().csrfTokenRepository(getCookieCsfrTokenRepository()).and()" ID="ID_1748423987" CREATED="1569850776376" MODIFIED="1569850776376"/>
<node TEXT=".authorizeRequests().antMatchers(&quot;/&quot;, &quot;/*.js&quot;, &quot;/*.css&quot;, &quot;/assets/**&quot;, &quot;/Home/**&quot;, &quot;/getCsrfToken&quot;,&quot;/login&quot;,&quot;/oauth/authorize&quot;)" ID="ID_470716721" CREATED="1569850776376" MODIFIED="1569850776376"/>
<node TEXT=".permitAll()" ID="ID_900550404" CREATED="1569850776377" MODIFIED="1569850776377"/>
<node TEXT=".anyRequest().authenticated().and()" ID="ID_1716552511" CREATED="1569850776378" MODIFIED="1569850776378"/>
<node TEXT=".formLogin().permitAll().and()" ID="ID_538679164" CREATED="1569850776378" MODIFIED="1569850776378"/>
<node TEXT="//.oauth2Login().permitAll().and()" ID="ID_1073107300" CREATED="1569850776378" MODIFIED="1569850776378"/>
<node TEXT=".logout().permitAll();" ID="ID_916976748" CREATED="1569850776379" MODIFIED="1569850776379"/>
<node TEXT="}" ID="ID_1040295057" CREATED="1569850776379" MODIFIED="1569850776379"/>
<node TEXT="@Bean" ID="ID_1435282972" CREATED="1569850776379" MODIFIED="1569850776379"/>
<node TEXT="public PasswordEncoder encoder() {" ID="ID_109185232" CREATED="1569850776379" MODIFIED="1569850776379">
<node TEXT="return new BCryptPasswordEncoder();" ID="ID_619295722" CREATED="1569850776380" MODIFIED="1569850776380"/>
</node>
<node TEXT="}" ID="ID_1912275388" CREATED="1569850776380" MODIFIED="1569850776380"/>
</node>
<node TEXT="/*        @Override" FOLDED="true" ID="ID_160646085" CREATED="1569850776381" MODIFIED="1606122161759">
<node TEXT="public void configure(WebSecurity web) throws Exception {" ID="ID_1127360769" CREATED="1569850776381" MODIFIED="1569850776381">
<node TEXT="// TODO Auto-generated method stub" ID="ID_45556602" CREATED="1569850776381" MODIFIED="1569850776381"/>
<node TEXT="web.ignoring();" ID="ID_714294337" CREATED="1569850776382" MODIFIED="1569850776382"/>
</node>
<node TEXT="}*/" ID="ID_951376397" CREATED="1569850776382" MODIFIED="1569850776382"/>
<node TEXT="@Override" ID="ID_107684412" CREATED="1569850776382" MODIFIED="1569850776382"/>
<node TEXT="protected void configure(AuthenticationManagerBuilder auth) throws Exception {" ID="ID_530283325" CREATED="1569850776383" MODIFIED="1569850776383">
<node TEXT="// TODO Auto-generated method stub" ID="ID_959365996" CREATED="1569850776383" MODIFIED="1569850776383"/>
<node TEXT="// super.configure(auth);" ID="ID_1588640872" CREATED="1569850776383" MODIFIED="1569850776383"/>
<node TEXT="//auth.inMemoryAuthentication().withUser(&quot;user&quot;).password(&quot;{noop}password&quot;).roles(&quot;USER&quot;);" ID="ID_1335064426" CREATED="1569850776383" MODIFIED="1569850776383"/>
<node TEXT="auth.authenticationProvider(customProvider);" ID="ID_269367222" CREATED="1569850776384" MODIFIED="1569850776384"/>
</node>
<node TEXT="}" ID="ID_940699011" CREATED="1569850776384" MODIFIED="1569850776384"/>
<node TEXT="private AuthenticationSuccessHandler successHandler() {" ID="ID_510057265" CREATED="1569850776384" MODIFIED="1569850776384">
<node TEXT="return new AuthenticationSuccessHandler() {" ID="ID_1251210171" CREATED="1569850776385" MODIFIED="1569850776385">
<node TEXT="@Override" ID="ID_1193717901" CREATED="1569850776385" MODIFIED="1569850776385"/>
<node TEXT="public void onAuthenticationSuccess(HttpServletRequest httpServletRequest," ID="ID_1424211666" CREATED="1569850776386" MODIFIED="1569850776386">
<node TEXT="HttpServletResponse httpServletResponse, Authentication authentication)" ID="ID_1959226721" CREATED="1569850776386" MODIFIED="1569850776386"/>
<node TEXT="throws IOException, ServletException {" ID="ID_1875300510" CREATED="1569850776386" MODIFIED="1569850776386"/>
<node TEXT="System.out.println(&quot;성공&quot;);" ID="ID_1037038033" CREATED="1569850776387" MODIFIED="1569850776387"/>
<node TEXT="httpServletResponse.getWriter().append(&quot;OK&quot;);" ID="ID_1713102228" CREATED="1569850776387" MODIFIED="1569850776387"/>
<node TEXT="httpServletResponse.setStatus(200);" ID="ID_1307561656" CREATED="1569850776387" MODIFIED="1569850776387"/>
</node>
<node TEXT="}" ID="ID_1377523467" CREATED="1569850776388" MODIFIED="1569850776388"/>
</node>
<node TEXT="};" ID="ID_387245185" CREATED="1569850776388" MODIFIED="1569850776388"/>
</node>
<node TEXT="}" ID="ID_1605150033" CREATED="1569850776388" MODIFIED="1569850776388"/>
<node TEXT="private AuthenticationFailureHandler failureHandler() {" ID="ID_654707564" CREATED="1569850776388" MODIFIED="1569850776388">
<node TEXT="return new AuthenticationFailureHandler() {" ID="ID_814693672" CREATED="1569850776389" MODIFIED="1569850776389">
<node TEXT="@Override" ID="ID_1979469265" CREATED="1569850776389" MODIFIED="1569850776389"/>
<node TEXT="public void onAuthenticationFailure(HttpServletRequest httpServletRequest," ID="ID_676974801" CREATED="1569850776389" MODIFIED="1569850776389">
<node TEXT="HttpServletResponse httpServletResponse, AuthenticationException e)" ID="ID_1073180201" CREATED="1569850776390" MODIFIED="1569850776390"/>
<node TEXT="throws IOException, ServletException {" ID="ID_908817056" CREATED="1569850776390" MODIFIED="1569850776390"/>
<node TEXT="System.out.println(&quot;실패&quot;);" ID="ID_1323255740" CREATED="1569850776390" MODIFIED="1569850776390"/>
<node TEXT="httpServletResponse.getWriter().append(&quot;Authentication failure&quot;);" ID="ID_336248441" CREATED="1569850776391" MODIFIED="1569850776391"/>
<node TEXT="httpServletResponse.setStatus(401);" ID="ID_1785330382" CREATED="1569850776391" MODIFIED="1569850776391"/>
</node>
<node TEXT="}" ID="ID_1108745974" CREATED="1569850776391" MODIFIED="1569850776391"/>
</node>
<node TEXT="};" ID="ID_722307279" CREATED="1569850776392" MODIFIED="1569850776392"/>
</node>
<node TEXT="}" ID="ID_638283612" CREATED="1569850776392" MODIFIED="1569850776392"/>
<node TEXT="@Bean" ID="ID_1673048027" CREATED="1569850776392" MODIFIED="1569850776392"/>
<node TEXT="public CookieCsrfTokenRepository getCookieCsfrTokenRepository(){" ID="ID_1196117102" CREATED="1569850776392" MODIFIED="1569850776392">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1043210685" CREATED="1569850776393" MODIFIED="1569850776393"/>
<node TEXT="CookieCsrfTokenRepository cookieTokenConfig = CookieCsrfTokenRepository.withHttpOnlyFalse();" ID="ID_136013674" CREATED="1569850776393" MODIFIED="1569850776393"/>
<node TEXT="//cookieTokenConfig.setCookiePath(&quot;/&quot;);" ID="ID_1668942121" CREATED="1569850776393" MODIFIED="1569850776393"/>
<node TEXT="return cookieTokenConfig;" ID="ID_1806702496" CREATED="1569850776394" MODIFIED="1569850776394"/>
</node>
<node TEXT="}" ID="ID_699231786" CREATED="1569850776394" MODIFIED="1569850776394"/>
<node TEXT="@Bean" ID="ID_1588590324" CREATED="1569850776394" MODIFIED="1569850776394"/>
<node TEXT="public AuthenticationManager getAuthenticationManager() throws Exception {" ID="ID_1625103130" CREATED="1569850776395" MODIFIED="1569850776395">
<node TEXT="return super.authenticationManager();" ID="ID_39379142" CREATED="1569850776395" MODIFIED="1569850776395"/>
</node>
<node TEXT="}" ID="ID_1717304201" CREATED="1569850776396" MODIFIED="1569850776396"/>
</node>
<node TEXT="}" ID="ID_1728927783" CREATED="1569850776396" MODIFIED="1569850776396"/>
</node>
<node TEXT="설명" ID="ID_1044287730" CREATED="1569488435372" MODIFIED="1606122162628">
<node TEXT="https://www.tutorialspoint.com/spring_boot/spring_boot_oauth2_with_jwt.htm" ID="ID_828315265" CREATED="1569491563570" MODIFIED="1569491564360" LINK="https://www.tutorialspoint.com/spring_boot/spring_boot_oauth2_with_jwt.htm"/>
<node TEXT="https://www.baeldung.com/rest-api-spring-oauth2-angular" ID="ID_1416393849" CREATED="1569190011486" MODIFIED="1569491618974" LINK="https://www.baeldung.com/rest-api-spring-oauth2-angular"/>
<node TEXT="formlogin을 단것은 implicit grant type을 구현하기 위한 것" ID="ID_1123163526" CREATED="1569491472507" MODIFIED="1569491526067"/>
</node>
</node>
<node TEXT="4. access token" FOLDED="true" ID="ID_1216788914" CREATED="1569491621157" MODIFIED="1610433786413">
<node TEXT="헤더" ID="ID_1995640605" CREATED="1569850962016" MODIFIED="1569870806896">
<node TEXT="POST /oauth/token HTTP/1.1" ID="ID_1756678103" CREATED="1569850963876" MODIFIED="1569850963876"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_344878254" CREATED="1569850963879" MODIFIED="1569850963879"/>
<node TEXT="Content-Type: application/x-www-form-urlencoded" ID="ID_1508327375" CREATED="1569850963882" MODIFIED="1569850963882"/>
<node TEXT="Authorization: Basic VGN0VGVzdDoxMjM0MTIzNGFh" ID="ID_1274851835" CREATED="1569850963883" MODIFIED="1569850963883"/>
<node TEXT="User-Agent: PostmanRuntime/7.17.1" ID="ID_1335324316" CREATED="1569850963885" MODIFIED="1569850963885"/>
<node TEXT="Accept: */*" ID="ID_893707187" CREATED="1569850963886" MODIFIED="1569850963886"/>
<node TEXT="Cache-Control: no-cache" ID="ID_506453131" CREATED="1569850963888" MODIFIED="1569850963888"/>
<node TEXT="Postman-Token: f79797a4-298c-4da3-947b-299640feb1f9,557fb23a-4852-4cdc-98f0-fcdc027a5a33" ID="ID_245013208" CREATED="1569850963889" MODIFIED="1569850963889"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_566051909" CREATED="1569850963891" MODIFIED="1569850963891"/>
<node TEXT="Accept-Encoding: gzip, deflate" ID="ID_183123078" CREATED="1569850963892" MODIFIED="1569850963892"/>
<node TEXT="Content-Length: 89" ID="ID_1041789328" CREATED="1569850963894" MODIFIED="1569850963894"/>
<node TEXT="Connection: keep-alive" ID="ID_1912602043" CREATED="1569850963895" MODIFIED="1569850963895"/>
<node TEXT="cache-control: no-cache" ID="ID_1008509173" CREATED="1569850963897" MODIFIED="1569850963897"/>
<node TEXT="username=TctTest%40gmail.com&amp;password=12341234aa&amp;grant_type=password&amp;domain33=wfwefwefwef" ID="ID_992720492" CREATED="1569850963898" MODIFIED="1569850963898"/>
</node>
<node TEXT="결과" ID="ID_1896450679" CREATED="1569491672493" MODIFIED="1569870890192">
<node TEXT="{" ID="ID_1864140291" CREATED="1569850971841" MODIFIED="1569850971841">
<node TEXT="&quot;access_token&quot;: &quot;eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJUY3RUZXN0QGdtYWlsLmNvbSIsInNjb3BlIjpbInJlYWQiLCJ3cml0ZSJdLCJleHAiOjE1Njk4OTM3MjEsInVzZXJJZCI6IjEyMzEyMyIsImF1dGhvcml0aWVzIjpbIlJPTEVfU1lTVEVNQURNSU4iXSwianRpIjoiMmI3MTllYTctMWI4Zi00MGNiLWJmZWEtZWNhMjcxMWMwYmYyIiwiY2xpZW50X2lkIjoiVGN0VGVzdCJ9.tG0hFsOhuBwzAYhuDsgqJK7ZkD_cRQfzTETOoRsVLB3g6lCFlFt_Si6rCOCniAa4aQn-bsd5SAKnM1xpwSJ7yPYK3FIGUOhwVw3uXreDCBE00I1hRibGXRGtMTCdkjTMqR1u5rxxlysPyVwwyIottSkown71ueNAnnvfKrCwEQarJTDmMndQD5KgvMJMrgslK1du06NPU5yA01HPDDN1PYe2S5-MUFkDUyMo4N5_PKovX-us5OHeRKqkOiEBvprvJk_FXncuyidsZZVUHsDPojtJobKKoQ63OrldkJDD9nEhhcE-pTF78jvR0aUg1kmjs-ovyiMHzoAJc04anrk0Lg&quot;," ID="ID_930624071" CREATED="1569850971841" MODIFIED="1569850971841"/>
<node TEXT="&quot;token_type&quot;: &quot;bearer&quot;," ID="ID_1469768158" CREATED="1569850971848" MODIFIED="1569850971848"/>
<node TEXT="&quot;refresh_token&quot;: &quot;eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJUY3RUZXN0QGdtYWlsLmNvbSIsInNjb3BlIjpbInJlYWQiLCJ3cml0ZSJdLCJhdGkiOiIyYjcxOWVhNy0xYjhmLTQwY2ItYmZlYS1lY2EyNzExYzBiZjIiLCJleHAiOjE1NzI0NDI1MjEsInVzZXJJZCI6IjEyMzEyMyIsImF1dGhvcml0aWVzIjpbIlJPTEVfU1lTVEVNQURNSU4iXSwianRpIjoiN2JkMDkxNmUtMTQxOS00NDc5LTgxOWMtN2FmNGM5OGM5MGE0IiwiY2xpZW50X2lkIjoiVGN0VGVzdCJ9.HCbtWm1pT8aBe68q1-UHADmfU-g7DitT0HYBc27WUAFLxHtUQzKZI9e5HDWaPq2nkSpJrtI1FevHjeSiKvV-_q_ulNY_VGU-LV0BahZN3L5H-pEyRvIQctACUXijgyhP03b63PiNs6k80Z-1wIUVLves00e_DAxi1MnkWFbdvlgXjOGXt_CCdaR01ndM3pzx0sOIHBrZKdZAQwMzr-oZLrRxM6KWpXr1deviP9RUv7uf0cTAIAX768TdLQDeR9wrXUNGf9D_yPd37a52ndpdtoxq0G5JoNQlU8Nybh-HDxipPbTVy_OxofPY8FG8pcayhc5IYDGLyofM6bS-v-7b9Q&quot;," ID="ID_1129587796" CREATED="1569850971848" MODIFIED="1569850971848"/>
<node TEXT="&quot;expires_in&quot;: 43198," ID="ID_924802611" CREATED="1569850971855" MODIFIED="1569850971855"/>
<node TEXT="&quot;scope&quot;: &quot;read write&quot;," ID="ID_1576698481" CREATED="1569850971855" MODIFIED="1569850971855"/>
<node TEXT="&quot;userId&quot;: &quot;123123&quot;," ID="ID_378365969" CREATED="1569850971855" MODIFIED="1569850971855"/>
<node TEXT="&quot;jti&quot;: &quot;2b719ea7-1b8f-40cb-bfea-eca2711c0bf2&quot;" ID="ID_1411135229" CREATED="1569850971856" MODIFIED="1569850971856"/>
</node>
<node TEXT="}" ID="ID_313915641" CREATED="1569850971856" MODIFIED="1569850971856"/>
</node>
</node>
<node TEXT="5. refresh token" FOLDED="true" ID="ID_232019336" CREATED="1569491675765" MODIFIED="1610433786413">
<node TEXT="헤더" ID="ID_1970765616" CREATED="1569491680294" MODIFIED="1569491804304">
<node TEXT="POST /oauth/token HTTP/1.1" ID="ID_1741960645" CREATED="1569851141319" MODIFIED="1569851141319"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_590271066" CREATED="1569851141322" MODIFIED="1569851141322"/>
<node TEXT="Content-Type: application/x-www-form-urlencoded" ID="ID_1581864490" CREATED="1569851141323" MODIFIED="1569851141323"/>
<node TEXT="X-XSRF-TOKEN: 595b50c4-9980-4fe8-b83a-a1983f68a7f3" ID="ID_695398832" CREATED="1569851141325" MODIFIED="1569851141325"/>
<node TEXT="Authorization: Basic VGN0VGVzdDoxMjM0MTIzNGFh" ID="ID_285947324" CREATED="1569851141326" MODIFIED="1569851141326"/>
<node TEXT="User-Agent: PostmanRuntime/7.17.1" ID="ID_1861974097" CREATED="1569851141326" MODIFIED="1569851141326"/>
<node TEXT="Accept: */*" ID="ID_1308027782" CREATED="1569851141327" MODIFIED="1569851141327"/>
<node TEXT="Cache-Control: no-cache" ID="ID_488931712" CREATED="1569851141328" MODIFIED="1569851141328"/>
<node TEXT="Postman-Token: a9660373-719d-4833-aa7a-ee8f29661156,97aabf54-dd75-4564-a912-e65bd34c06b5" ID="ID_591406718" CREATED="1569851141328" MODIFIED="1569851141328"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_531247525" CREATED="1569851141329" MODIFIED="1569851141329"/>
<node TEXT="Accept-Encoding: gzip, deflate" ID="ID_1345889834" CREATED="1569851141329" MODIFIED="1569851141329"/>
<node TEXT="Content-Length: 739" ID="ID_473671566" CREATED="1569851141330" MODIFIED="1569851141330"/>
<node TEXT="Connection: keep-alive" ID="ID_984970352" CREATED="1569851141330" MODIFIED="1569851141330"/>
<node TEXT="cache-control: no-cache" ID="ID_1437752192" CREATED="1569851141331" MODIFIED="1569851141331"/>
<node TEXT="refresh_token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJUY3RUZXN0QGdtYWlsLmNvbSIsInNjb3BlIjpbInJlYWQiLCJ3cml0ZSJdLCJhdGkiOiIyYjcxOWVhNy0xYjhmLTQwY2ItYmZlYS1lY2EyNzExYzBiZjIiLCJleHAiOjE1NzI0NDI1MjEsInVzZXJJZCI6IjEyMzEyMyIsImF1dGhvcml0aWVzIjpbIlJPTEVfU1lTVEVNQURNSU4iXSwianRpIjoiN2JkMDkxNmUtMTQxOS00NDc5LTgxOWMtN2FmNGM5OGM5MGE0IiwiY2xpZW50X2lkIjoiVGN0VGVzdCJ9.HCbtWm1pT8aBe68q1-UHADmfU-g7DitT0HYBc27WUAFLxHtUQzKZI9e5HDWaPq2nkSpJrtI1FevHjeSiKvV-_q_ulNY_VGU-LV0BahZN3L5H-pEyRvIQctACUXijgyhP03b63PiNs6k80Z-1wIUVLves00e_DAxi1MnkWFbdvlgXjOGXt_CCdaR01ndM3pzx0sOIHBrZKdZAQwMzr-oZLrRxM6KWpXr1deviP9RUv7uf0cTAIAX768TdLQDeR9wrXUNGf9D_yPd37a52ndpdtoxq0G5JoNQlU8Nybh-HDxipPbTVy_OxofPY8FG8pcayhc5IYDGLyofM6bS-v-7b9Q&amp;grant_type=refresh_token" ID="ID_954440376" CREATED="1569851141332" MODIFIED="1569851141332"/>
</node>
<node TEXT="결과" ID="ID_148977533" CREATED="1569491696446" MODIFIED="1569491697589">
<node TEXT="{" ID="ID_1874888439" CREATED="1569851147907" MODIFIED="1569851147907">
<node TEXT="&quot;access_token&quot;: &quot;eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJUY3RUZXN0QGdtYWlsLmNvbSIsInNjb3BlIjpbInJlYWQiLCJ3cml0ZSJdLCJleHAiOjE1Njk4OTQzMjEsInVzZXJJZCI6IjEyMzEyMyIsImF1dGhvcml0aWVzIjpbIlJPTEVfU1lTVEVNQURNSU4iXSwianRpIjoiNmE5MWQwOGUtMzM4Yy00NTU4LWIxNmQtNTU1NzQ4ZGY1YTllIiwiY2xpZW50X2lkIjoiVGN0VGVzdCJ9.YQvg-ETJNvCRGLGjWrr3t7nHE0aN1waobUReAMgr9c6r2W9dj2OFCGC2Rmp-LpLCcw92jZBlp7RdE-Cqc0kZj_JGbgSU0GOi47PcXq7Q0OmBQKV68alqsbNHWnqjqjNedSbqvWWL-fkUVXb0dcjueZeiyM-xAgOP6wF9E_TnbHZLjNHQ3r1PIp50Kpas1mFWt4tmPZxHr18LsDcs2WHG17L6RhU2EuyIVVYbsnXXpWK331fwI_BtGaotKcwBVTZRoj51eY4HJK0ui6JHAzNIsKwztEPEvM0g6Yiq-yANJxqKk57P0HgJGtHDRlO_3wbLW8pnKsY3Rr4CY4nYylD-pg&quot;," ID="ID_718775643" CREATED="1569851147908" MODIFIED="1569851147908"/>
<node TEXT="&quot;token_type&quot;: &quot;bearer&quot;," ID="ID_1224892915" CREATED="1569851147919" MODIFIED="1569851147919"/>
<node TEXT="&quot;refresh_token&quot;: &quot;eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJUY3RUZXN0QGdtYWlsLmNvbSIsInNjb3BlIjpbInJlYWQiLCJ3cml0ZSJdLCJhdGkiOiI2YTkxZDA4ZS0zMzhjLTQ1NTgtYjE2ZC01NTU3NDhkZjVhOWUiLCJleHAiOjE1NzI0NDI1MjEsInVzZXJJZCI6IjEyMzEyMyIsImF1dGhvcml0aWVzIjpbIlJPTEVfU1lTVEVNQURNSU4iXSwianRpIjoiN2JkMDkxNmUtMTQxOS00NDc5LTgxOWMtN2FmNGM5OGM5MGE0IiwiY2xpZW50X2lkIjoiVGN0VGVzdCJ9.YKoBqTmcOhsDj20PQg6KviyM8wjWMnoiEG-15060hJUi16szfkhDWXZtyXHd6ra7qa7OjkIrOL1s9lwVWT23DtVxF8p8RLfJ-Yjxri7zieENoYWteFfsNE2kZYAmPEurtGQIIckpR-XBbobIj8B2Wuyhlx_tH9DHYYa36vtkvn253qqA8J3pOLVXcdRzF4BUKrof4hP5ortzA7hM_KP1zED8OA2259jyUyahvdlnQTydBqf1lO01c_IQ1PPbn_qpMiPLDL78BqxMPYXVngRacfTHwnPEn4ehKfAlBKhhT3ZLQujikmhfQaoCb5XkHsaipGCGJ3RAg1pYNZpRVuV6Tw&quot;," ID="ID_862685322" CREATED="1569851147920" MODIFIED="1569851147920"/>
<node TEXT="&quot;expires_in&quot;: 43198," ID="ID_765782908" CREATED="1569851147929" MODIFIED="1569851147929"/>
<node TEXT="&quot;scope&quot;: &quot;read write&quot;," ID="ID_404830657" CREATED="1569851147930" MODIFIED="1569851147930"/>
<node TEXT="&quot;userId&quot;: &quot;123123&quot;," ID="ID_38968396" CREATED="1569851147930" MODIFIED="1569851147930"/>
<node TEXT="&quot;jti&quot;: &quot;6a91d08e-338c-4558-b16d-555748df5a9e&quot;" ID="ID_877260036" CREATED="1569851147930" MODIFIED="1569851147930"/>
</node>
<node TEXT="}" ID="ID_1274587156" CREATED="1569851147931" MODIFIED="1569851147931"/>
</node>
</node>
<node TEXT="6. check_token" FOLDED="true" ID="ID_703905643" CREATED="1569492883942" MODIFIED="1610433786413">
<node TEXT="헤더" ID="ID_1068238089" CREATED="1569492889919" MODIFIED="1569492891387">
<node TEXT="GET /oauth/check_token?token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJUY3RUZXN0QGdtYWlsLmNvbSIsInNjb3BlIjpbInJlYWQiLCJ3cml0ZSJdLCJleHAiOjE1Njk4OTQzMjEsInVzZXJJZCI6IjEyMzEyMyIsImF1dGhvcml0aWVzIjpbIlJPTEVfU1lTVEVNQURNSU4iXSwianRpIjoiNmE5MWQwOGUtMzM4Yy00NTU4LWIxNmQtNTU1NzQ4ZGY1YTllIiwiY2xpZW50X2lkIjoiVGN0VGVzdCJ9.YQvg-ETJNvCRGLGjWrr3t7nHE0aN1waobUReAMgr9c6r2W9dj2OFCGC2Rmp-LpLCcw92jZBlp7RdE-Cqc0kZj_JGbgSU0GOi47PcXq7Q0OmBQKV68alqsbNHWnqjqjNedSbqvWWL-fkUVXb0dcjueZeiyM-xAgOP6wF9E_TnbHZLjNHQ3r1PIp50Kpas1mFWt4tmPZxHr18LsDcs2WHG17L6RhU2EuyIVVYbsnXXpWK331fwI_BtGaotKcwBVTZRoj51eY4HJK0ui6JHAzNIsKwztEPEvM0g6Yiq-yANJxqKk57P0HgJGtHDRlO_3wbLW8pnKsY3Rr4CY4nYylD-pg HTTP/1.1" ID="ID_611642438" CREATED="1569851375989" MODIFIED="1569851375989"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_22526389" CREATED="1569851376003" MODIFIED="1569851376003"/>
<node TEXT="Authorization: Basic VGN0VGVzdDoxMjM0MTIzNGFh" ID="ID_803590403" CREATED="1569851376003" MODIFIED="1569851376003"/>
<node TEXT="User-Agent: PostmanRuntime/7.17.1" ID="ID_256847179" CREATED="1569851376004" MODIFIED="1569851376004"/>
<node TEXT="Accept: */*" ID="ID_101862941" CREATED="1569851376005" MODIFIED="1569851376005"/>
<node TEXT="Cache-Control: no-cache" ID="ID_862766373" CREATED="1569851376006" MODIFIED="1569851376006"/>
<node TEXT="Postman-Token: 247c21f7-5b3b-431f-99de-6846a7ba9be1,459c41d4-638e-4616-aad0-b66829ac5001" ID="ID_1296845910" CREATED="1569851376007" MODIFIED="1569851376007"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_321150643" CREATED="1569851376008" MODIFIED="1569851376008"/>
<node TEXT="Accept-Encoding: gzip, deflate" ID="ID_610300590" CREATED="1569851376008" MODIFIED="1569851376008"/>
<node TEXT="Connection: keep-alive" ID="ID_308207196" CREATED="1569851376009" MODIFIED="1569851376009"/>
<node TEXT="cache-control: no-cache" ID="ID_695176784" CREATED="1569851376010" MODIFIED="1569851376010"/>
</node>
<node TEXT="결과" ID="ID_1323215982" CREATED="1569492892638" MODIFIED="1569851179776">
<node TEXT="{" ID="ID_1898277854" CREATED="1569851384209" MODIFIED="1569851384209">
<node TEXT="&quot;user_name&quot;: &quot;TctTest@gmail.com&quot;," ID="ID_1068402752" CREATED="1569851384211" MODIFIED="1569851384211" LINK="mailto:%22TctTest@gmail.com%22,"/>
<node TEXT="&quot;scope&quot;: [" ID="ID_4022793" CREATED="1569851384216" MODIFIED="1569851384216">
<node TEXT="&quot;read&quot;," ID="ID_1350719245" CREATED="1569851384217" MODIFIED="1569851384217"/>
<node TEXT="&quot;write&quot;" ID="ID_32297792" CREATED="1569851384219" MODIFIED="1569851384219"/>
</node>
<node TEXT="]," ID="ID_567576050" CREATED="1569851384221" MODIFIED="1569851384221"/>
<node TEXT="&quot;exp&quot;: 1569894321," ID="ID_119542114" CREATED="1569851384222" MODIFIED="1569851384222"/>
<node TEXT="&quot;userId&quot;: &quot;123123&quot;," ID="ID_88523116" CREATED="1569851384225" MODIFIED="1569851384225"/>
<node TEXT="&quot;authorities&quot;: [" ID="ID_1496301479" CREATED="1569851384226" MODIFIED="1569851384226">
<node TEXT="&quot;ROLE_SYSTEMADMIN&quot;" ID="ID_93272461" CREATED="1569851384228" MODIFIED="1569851384228"/>
</node>
<node TEXT="]," ID="ID_250419430" CREATED="1569851384230" MODIFIED="1569851384230"/>
<node TEXT="&quot;jti&quot;: &quot;6a91d08e-338c-4558-b16d-555748df5a9e&quot;," ID="ID_1899186551" CREATED="1569851384231" MODIFIED="1569851384231"/>
<node TEXT="&quot;client_id&quot;: &quot;TctTest&quot;" ID="ID_1815942292" CREATED="1569851384233" MODIFIED="1569851384233"/>
</node>
<node TEXT="}" ID="ID_843026294" CREATED="1569851384233" MODIFIED="1569851384233"/>
</node>
</node>
<node TEXT="7. implicit" FOLDED="true" ID="ID_1887485124" CREATED="1569854507655" MODIFIED="1619770122966">
<node TEXT="코드" ID="ID_495094094" CREATED="1569858624071" MODIFIED="1569863599043">
<node TEXT="//oAUth2 전용" ID="ID_60225774" CREATED="1569858625234" MODIFIED="1569858625234"/>
<node TEXT="http.cors().and()" ID="ID_1465521856" CREATED="1569858625237" MODIFIED="1569858625237"/>
<node TEXT=".addFilterBefore(filter, UsernamePasswordAuthenticationFilter.class)" ID="ID_1265418578" CREATED="1569858625238" MODIFIED="1569858625238"/>
<node TEXT=".sessionManagement().sessionCreationPolicy(SessionCreationPolicy.NEVER).and()" ID="ID_546416824" CREATED="1569858625240" MODIFIED="1569858625240"/>
<node TEXT="//.csrf().disable()" ID="ID_94164822" CREATED="1569858625242" MODIFIED="1569858625242"/>
<node TEXT=".csrf().csrfTokenRepository(getCookieCsfrTokenRepository()).and()" ID="ID_1783653590" CREATED="1569858625244" MODIFIED="1569858625244"/>
<node TEXT=".authorizeRequests().antMatchers(&quot;/&quot;, &quot;/*.js&quot;, &quot;/*.css&quot;, &quot;/assets/**&quot;, &quot;/Home/**&quot;, &quot;/getCsrfToken&quot;,&quot;/login&quot;,&quot;/oauth/authorize&quot;)" ID="ID_1718199875" CREATED="1569858625244" MODIFIED="1569858625244"/>
<node TEXT=".permitAll()" ID="ID_1682260142" CREATED="1569858625246" MODIFIED="1569858625246"/>
<node TEXT=".anyRequest().authenticated().and()" ID="ID_721799506" CREATED="1569858625247" MODIFIED="1569858625247"/>
<node TEXT=".formLogin().permitAll().and()" ID="ID_1716316977" CREATED="1569858625248" MODIFIED="1569858625248"/>
<node TEXT="//.oauth2Login().permitAll().and()" ID="ID_1434916657" CREATED="1569858625249" MODIFIED="1569858625249"/>
<node TEXT=".logout().permitAll();" ID="ID_1415753918" CREATED="1569858625249" MODIFIED="1569858625249"/>
</node>
<node TEXT="implicit에 대한 redirecturl 허용" ID="ID_927026698" CREATED="1569863601194" MODIFIED="1569863624570">
<node TEXT="@Override" ID="ID_369477582" CREATED="1569863613342" MODIFIED="1569863613342">
<node TEXT="public void configure(ClientDetailsServiceConfigurer clients) throws Exception {" ID="ID_64288046" CREATED="1569863613344" MODIFIED="1569863613344">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1984828606" CREATED="1569863613345" MODIFIED="1569863613345"/>
<node TEXT="//super.configure(clients);" ID="ID_198521074" CREATED="1569863613347" MODIFIED="1569863613347"/>
<node TEXT="System.out.println(&quot;passsssssssssssssssssssssssssssssssssss&quot;);" ID="ID_228512451" CREATED="1569863613349" MODIFIED="1569863613349"/>
<node TEXT="System.out.println(encoder.encode(clientSeceret));" ID="ID_1350622439" CREATED="1569863613350" MODIFIED="1569863613350"/>
<node TEXT="clients.jdbc(primaryDatasource)" ID="ID_1563371941" CREATED="1569863613351" MODIFIED="1569863613351"/>
<node TEXT=".withClient(&quot;sampleClinetId&quot;)" ID="ID_1034150683" CREATED="1569863613352" MODIFIED="1569863613352"/>
<node TEXT=".authorizedGrantTypes(&quot;implicit&quot;)" ID="ID_1920824538" CREATED="1569863613353" MODIFIED="1569863613353"/>
<node TEXT=".scopes(&quot;read&quot;,&quot;write&quot;)" ID="ID_1972647576" CREATED="1569863613354" MODIFIED="1569863613354"/>
<node TEXT=".autoApprove(true)" ID="ID_1550720706" CREATED="1569863613355" MODIFIED="1569863613355"/>
<node TEXT=".redirectUris(&quot;https://daum.net&quot;)" ID="ID_1736784985" CREATED="1569863613355" MODIFIED="1569863613355" LINK="https://daum.net"/>
<node TEXT=".and()" ID="ID_777665300" CREATED="1569863613360" MODIFIED="1569863613360"/>
<node TEXT=".withClient(clinetId)" ID="ID_70379595" CREATED="1569863613361" MODIFIED="1569863613361"/>
<node TEXT=".secret(encoder.encode(clientSeceret))" ID="ID_1612541080" CREATED="1569863613362" MODIFIED="1569863613362"/>
<node TEXT=".authorizedGrantTypes(" ID="ID_1854670591" CREATED="1569863613363" MODIFIED="1569863613363">
<node TEXT="&quot;password&quot;,&quot;authorization_code&quot;,&quot;refresh_token&quot;)" ID="ID_1112682791" CREATED="1569863613364" MODIFIED="1569863613364"/>
</node>
<node TEXT=".scopes(&quot;read&quot;,&quot;write&quot;);" ID="ID_1665929572" CREATED="1569863613365" MODIFIED="1569863613365"/>
</node>
<node TEXT="}" ID="ID_66394012" CREATED="1569863613366" MODIFIED="1569863613366"/>
</node>
</node>
<node TEXT="설명" ID="ID_1745498828" CREATED="1569858626111" MODIFIED="1569864613696">
<node TEXT="formLogin을 추가해야만 한다." ID="ID_540995301" CREATED="1569858627576" MODIFIED="1569858632963"/>
<node TEXT="implicit에 대한 sampleClient 클라이언트 유저 아이디를 추가하며, redirectUrl을 정확히 명시해야만 한다." ID="ID_1513714191" CREATED="1569864622115" MODIFIED="1569864721967"/>
</node>
<node TEXT="127.0.0.1:8081/oauth/authorize?response_type=token&amp;client_id=sampleClinetId&amp;redirect_uri=https://daum.net&amp;scope=read" ID="ID_1639794685" CREATED="1569858576370" MODIFIED="1569858577260"/>
<node TEXT="디폴트 로그인 화면이 나온다. " ID="ID_516009097" CREATED="1569858642743" MODIFIED="1569858698555"/>
<node TEXT="로그인을 하면 다음과 같은 redirecturi가 나오는데 여기에 있는 access_tokne을 똑 띠어다가 저장하고 접근하면 된다." ID="ID_699837797" CREATED="1569858690375" MODIFIED="1569859956214">
<node TEXT="https://www.daum.net/#access_token=eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJUY3RUZXN0QGdtYWlsLmNvbSIsInNjb3BlIjpbInJlYWQiXSwiZXhwIjoxNTY5ODk5OTU2LCJ1c2VySWQiOiIxMjMxMjMiLCJhdXRob3JpdGllcyI6WyJST0xFX1NZU1RFTUFETUlOIl0sImp0aSI6IjQzYTJhM2E3LTc0NDUtNDQxYS05YzNhLTJmMDU3NDVlMWFiNCIsImNsaWVudF9pZCI6InNhbXBsZUNsaW5ldElkIn0.FLPnydth_MiwTY-Bu9UzfH69uQljCbPdBXUT6HQxx_zvGV61n64Rn1PfCZL3u4G6U-L2mPoDovy-pkev-4sZzxrOxjF1xaarDDtJ1gtfmP4Eo763gmnfssbxEZxRC9zimN_-_exloky1ycfv84YSQxWHz60aJJNwA3Zv0ZRU7dlwG7qNSCLe9S1o8EjDZ4YBH3F0XxfOUeliRrmtcKAyxu-rF1_KgNu8WNM_wAEaXbEjQMM9NNb78ZkIySvSvf9EMrGniLuxWBpJ3wDoE1TRgYUn3kZZWKYQDwqWRPD68duVIZSlPsNDlaVl3G0m0Y9M-y5_qJlOUqWz39PLfCXW7g&amp;token_type=bearer&amp;expires_in=43199&amp;userId=123123&amp;jti=43a2a3a7-7445-441a-9c3a-2f05745e1ab4" ID="ID_1822720078" CREATED="1569858669648" MODIFIED="1569858706146"/>
</node>
</node>
<node TEXT="7, 리소스 서버 config" FOLDED="true" ID="ID_38472663" CREATED="1569850815584" MODIFIED="1606122216893">
<node TEXT="코드" FOLDED="true" ID="ID_371823389" CREATED="1569851589026" MODIFIED="1569874259326">
<node TEXT="package com.example.demo.oAuth2;" ID="ID_1115590666" CREATED="1569851592478" MODIFIED="1569851592478"/>
<node TEXT="import java.io.IOException;" ID="ID_1557595924" CREATED="1569851592480" MODIFIED="1569851592480"/>
<node TEXT="import org.aopalliance.intercept.MethodInterceptor;" ID="ID_367437289" CREATED="1569851592482" MODIFIED="1569851592482"/>
<node TEXT="import org.apache.commons.io.IOUtils;" ID="ID_1093031406" CREATED="1569851592483" MODIFIED="1569851592483"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_1707385426" CREATED="1569851592485" MODIFIED="1569851592485"/>
<node TEXT="import org.springframework.context.annotation.Bean;" ID="ID_1525781438" CREATED="1569851592486" MODIFIED="1569851592486"/>
<node TEXT="import org.springframework.context.annotation.Configuration;" ID="ID_767733436" CREATED="1569851592488" MODIFIED="1569851592488"/>
<node TEXT="import org.springframework.context.annotation.Primary;" ID="ID_166253680" CREATED="1569851592489" MODIFIED="1569851592489"/>
<node TEXT="import org.springframework.core.io.ClassPathResource;" ID="ID_248145264" CREATED="1569851592491" MODIFIED="1569851592491"/>
<node TEXT="import org.springframework.core.io.Resource;" ID="ID_976469553" CREATED="1569851592492" MODIFIED="1569851592492"/>
<node TEXT="import org.springframework.security.access.expression.method.MethodSecurityExpressionHandler;" ID="ID_910455403" CREATED="1569851592494" MODIFIED="1569851592494"/>
<node TEXT="import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;" ID="ID_319389153" CREATED="1569851592495" MODIFIED="1569851592495"/>
<node TEXT="import org.springframework.security.config.annotation.method.configuration.GlobalMethodSecurityConfiguration;" ID="ID_1885329867" CREATED="1569851592496" MODIFIED="1569851592496"/>
<node TEXT="import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;" ID="ID_1042128253" CREATED="1569851592498" MODIFIED="1569851592498"/>
<node TEXT="import org.springframework.security.oauth2.provider.expression.OAuth2MethodSecurityExpressionHandler;" ID="ID_1401981539" CREATED="1569851592499" MODIFIED="1569851592499"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.DefaultTokenServices;" ID="ID_881013060" CREATED="1569851592501" MODIFIED="1569851592501"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.TokenStore;" ID="ID_798018885" CREATED="1569851592502" MODIFIED="1569851592502"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.store.JwtAccessTokenConverter;" ID="ID_1630595744" CREATED="1569851592502" MODIFIED="1569851592502"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.store.JwtTokenStore;" ID="ID_907880560" CREATED="1569851592504" MODIFIED="1569851592504"/>
<node TEXT="import com.example.demo.config.CheckTokenConverter;" ID="ID_1570495899" CREATED="1569851592504" MODIFIED="1569851592504"/>
<node TEXT="@Configuration" ID="ID_1575430358" CREATED="1569851592505" MODIFIED="1569851592505"/>
<node TEXT="@EnableResourceServer" ID="ID_494749497" CREATED="1569851592506" MODIFIED="1569851592506"/>
<node TEXT="@EnableGlobalMethodSecurity(prePostEnabled = true)" ID="ID_1306756574" CREATED="1569851592507" MODIFIED="1569851592507"/>
<node TEXT="public class ResoureConfig extends GlobalMethodSecurityConfiguration {" FOLDED="true" ID="ID_1742306814" CREATED="1569851592508" MODIFIED="1569851997529">
<node TEXT="@Autowired" ID="ID_1480381702" CREATED="1569851592509" MODIFIED="1569851592509"/>
<node TEXT="CheckTokenConverter converter;" ID="ID_1657238734" CREATED="1569851592510" MODIFIED="1569851592510"/>
<node TEXT="private String publicKey;" ID="ID_1910109598" CREATED="1569851592510" MODIFIED="1569851592510"/>
<node TEXT="@Override" ID="ID_103974736" CREATED="1569851592511" MODIFIED="1569851592511"/>
<node TEXT="protected MethodSecurityExpressionHandler createExpressionHandler() {" ID="ID_1469340556" CREATED="1569851592512" MODIFIED="1569851592512">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1087476109" CREATED="1569851592513" MODIFIED="1569851592513"/>
<node TEXT="return new OAuth2MethodSecurityExpressionHandler();" ID="ID_228634566" CREATED="1569851592513" MODIFIED="1569851592513"/>
</node>
<node TEXT="}" ID="ID_1179967242" CREATED="1569851592514" MODIFIED="1569851592514"/>
<node TEXT="@Override" ID="ID_1873045128" CREATED="1569851592515" MODIFIED="1569851592515"/>
<node TEXT="public MethodInterceptor methodSecurityInterceptor() throws Exception {" ID="ID_550405373" CREATED="1569851592516" MODIFIED="1569851592516">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1651886647" CREATED="1569851592516" MODIFIED="1569851592516"/>
<node TEXT="return super.methodSecurityInterceptor();" ID="ID_1967948574" CREATED="1569851592517" MODIFIED="1569851592517"/>
</node>
<node TEXT="}" ID="ID_86115741" CREATED="1569851592518" MODIFIED="1569851592518"/>
<node TEXT="@Bean" ID="ID_1031211877" CREATED="1569851592519" MODIFIED="1569851592519"/>
<node TEXT="public JwtAccessTokenConverter tokenConvter() {" ID="ID_1849570071" CREATED="1569851592519" MODIFIED="1569851592519">
<node TEXT="Resource publicKeyRes = new ClassPathResource(&quot;key/publicKey.txt&quot;);" ID="ID_620509582" CREATED="1569851592520" MODIFIED="1569851592520"/>
<node TEXT="try {" ID="ID_82395692" CREATED="1569851592523" MODIFIED="1569851592523">
<node TEXT="this.publicKey = new String(IOUtils.toByteArray(publicKeyRes.getInputStream()));" ID="ID_819863071" CREATED="1569851592523" MODIFIED="1569851592523"/>
</node>
<node TEXT="} catch (IOException e) {" ID="ID_1203731685" CREATED="1569851592524" MODIFIED="1569851592524">
<node TEXT="// TODO Auto-generated catch block" ID="ID_1687086935" CREATED="1569851592525" MODIFIED="1569851592525"/>
<node TEXT="e.printStackTrace();" ID="ID_57522337" CREATED="1569851592526" MODIFIED="1569851592526"/>
</node>
<node TEXT="}" ID="ID_1147438051" CREATED="1569851592527" MODIFIED="1569851592527"/>
<node TEXT="JwtAccessTokenConverter jwtAccessTokenConverter = new JwtAccessTokenConverter();" ID="ID_49956698" CREATED="1569851592527" MODIFIED="1569851592527"/>
<node TEXT="jwtAccessTokenConverter.setVerifierKey(publicKey);" ID="ID_289366135" CREATED="1569851592528" MODIFIED="1569851592528"/>
<node TEXT="jwtAccessTokenConverter.setAccessTokenConverter(converter);" ID="ID_1958288797" CREATED="1569851592529" MODIFIED="1569851592529"/>
<node TEXT="return jwtAccessTokenConverter;" ID="ID_946755785" CREATED="1569851592529" MODIFIED="1569851592529"/>
</node>
<node TEXT="}" ID="ID_1169110345" CREATED="1569851592530" MODIFIED="1569851592530"/>
<node TEXT="@Bean" ID="ID_1563917302" CREATED="1569851592531" MODIFIED="1569851592531"/>
<node TEXT="public TokenStore jwtTokenStore() {" ID="ID_439774522" CREATED="1569851592532" MODIFIED="1569851592532">
<node TEXT="return new JwtTokenStore(tokenConvter());" ID="ID_818575913" CREATED="1569851592532" MODIFIED="1569851592532"/>
</node>
<node TEXT="}" ID="ID_1706246646" CREATED="1569851592533" MODIFIED="1569851592533"/>
<node TEXT="@Primary" ID="ID_1794296648" CREATED="1569851592534" MODIFIED="1569851592534"/>
<node TEXT="@Bean" ID="ID_97924679" CREATED="1569851592535" MODIFIED="1569851592535"/>
<node TEXT="public DefaultTokenServices tokenService() {" ID="ID_857727187" CREATED="1569851592535" MODIFIED="1569851592535">
<node TEXT="DefaultTokenServices tokenService = new DefaultTokenServices();" ID="ID_198201930" CREATED="1569851592536" MODIFIED="1569851592536"/>
<node TEXT="tokenService.setTokenStore(jwtTokenStore());" ID="ID_367986389" CREATED="1569851592537" MODIFIED="1569851592537"/>
<node TEXT="return tokenService;" ID="ID_1951547030" CREATED="1569851592538" MODIFIED="1569851592538"/>
</node>
<node TEXT="}" ID="ID_167643280" CREATED="1569851592538" MODIFIED="1569851592538"/>
</node>
<node TEXT="//        @Primary" ID="ID_570519564" CREATED="1569851592539" MODIFIED="1569851592539"/>
<node TEXT="//        @Bean" ID="ID_1045331191" CREATED="1569851592540" MODIFIED="1569851592540"/>
<node TEXT="//        public RemoteTokenServices tokenService() {" ID="ID_1798709059" CREATED="1569851592541" MODIFIED="1569851592541"/>
<node TEXT="//" ID="ID_1874723311" CREATED="1569851592542" MODIFIED="1569851592542"/>
<node TEXT="//                RemoteTokenServices tokenService = new RemoteTokenServices();" ID="ID_1764363754" CREATED="1569851592542" MODIFIED="1569851592542"/>
<node TEXT="//                tokenService.setCheckTokenEndpointUrl(&quot;http://localhost:8081/oauth/check_token&quot;);" ID="ID_1615846270" CREATED="1569851592543" MODIFIED="1569851592543" LINK="http://localhost:8081/oauth/check_token"/>
<node TEXT="//                tokenService.setClientId(&quot;TctTest&quot;);" ID="ID_226437311" CREATED="1569851592545" MODIFIED="1569851592545"/>
<node TEXT="//                tokenService.setClientSecret(&quot;12341234aa&quot;);" ID="ID_794139775" CREATED="1569851592546" MODIFIED="1569851592546"/>
<node TEXT="//                tokenService.setAccessTokenConverter(converter);" ID="ID_1120730192" CREATED="1569851592547" MODIFIED="1569851592547"/>
<node TEXT="//                return tokenService;" ID="ID_1529739026" CREATED="1569851592548" MODIFIED="1569851592548"/>
<node TEXT="//" ID="ID_1610947394" CREATED="1569851592548" MODIFIED="1569851592548"/>
<node TEXT="//        }" ID="ID_264539936" CREATED="1569851592549" MODIFIED="1569851592549"/>
<node TEXT="}" ID="ID_1873870086" CREATED="1569851592550" MODIFIED="1569851592550"/>
</node>
<node TEXT="설명" FOLDED="true" ID="ID_947243585" CREATED="1569851593512" MODIFIED="1599037248765">
<node TEXT="jwt를 자체적으로 토큰이 유효한지 판단한다." ID="ID_796872601" CREATED="1569851596274" MODIFIED="1569851696589"/>
<node TEXT="autorization 서버의 check_token으로 접속하여 일일이 따로 해당 토큰이 유효한지도 파악할 수 있다. 이럴 때에는 RemoteTokenServices를 이용하면 되며, 현재 코드에서는 주석처리 되어있다." ID="ID_1920380340" CREATED="1569851640728" MODIFIED="1569852098557"/>
<node TEXT="이에 대한 내용은 다음에 튜토리얼에서 중점적으로 진행이 된다." ID="ID_1751979313" CREATED="1569852157514" MODIFIED="1569872816472">
<node TEXT="https://www.tutorialspoint.com/spring_boot/spring_boot_oauth2_with_jwt.htm" ID="ID_1073354598" CREATED="1569491563570" MODIFIED="1569491564360" LINK="https://www.tutorialspoint.com/spring_boot/spring_boot_oauth2_with_jwt.htm"/>
</node>
</node>
<node TEXT="커스텀 컨버터 세팅" FOLDED="true" ID="ID_1334995201" CREATED="1569852577644" MODIFIED="1569874259327">
<node TEXT="@Autowired" ID="ID_144680134" CREATED="1569852616245" MODIFIED="1569852702156"/>
<node TEXT="CheckTokenConverter converter;" ID="ID_1292424387" CREATED="1569852616248" MODIFIED="1569852702157"/>
<node TEXT="@Bean" ID="ID_1070887902" CREATED="1569852603167" MODIFIED="1569852603167">
<node TEXT="public JwtAccessTokenConverter tokenConvter() {" ID="ID_299615945" CREATED="1569852603170" MODIFIED="1569852603170">
<node TEXT="Resource publicKeyRes = new ClassPathResource(&quot;key/publicKey.txt&quot;);" ID="ID_1724239864" CREATED="1569852603172" MODIFIED="1569852603172"/>
<node TEXT="try {" ID="ID_405293810" CREATED="1569852603174" MODIFIED="1569852603174">
<node TEXT="this.publicKey = new String(IOUtils.toByteArray(publicKeyRes.getInputStream()));" ID="ID_821993578" CREATED="1569852603176" MODIFIED="1569852603176"/>
</node>
<node TEXT="} catch (IOException e) {" ID="ID_1270680314" CREATED="1569852603179" MODIFIED="1569852603179">
<node TEXT="// TODO Auto-generated catch block" ID="ID_1270165643" CREATED="1569852603181" MODIFIED="1569852603181"/>
<node TEXT="e.printStackTrace();" ID="ID_1296986888" CREATED="1569852603183" MODIFIED="1569852603183"/>
</node>
<node TEXT="}" ID="ID_1498614375" CREATED="1569852603185" MODIFIED="1569852603185"/>
<node TEXT="JwtAccessTokenConverter jwtAccessTokenConverter = new JwtAccessTokenConverter();" ID="ID_323896411" CREATED="1569852603186" MODIFIED="1569852603186"/>
<node TEXT="jwtAccessTokenConverter.setVerifierKey(publicKey);" ID="ID_1766378428" CREATED="1569852603189" MODIFIED="1569852603189"/>
<node TEXT="jwtAccessTokenConverter.setAccessTokenConverter(converter);" ID="ID_285392850" CREATED="1569852603192" MODIFIED="1569852603192"/>
<node TEXT="return jwtAccessTokenConverter;" ID="ID_598127950" CREATED="1569852603194" MODIFIED="1569852603194"/>
</node>
<node TEXT="}" ID="ID_1057128994" CREATED="1569852603195" MODIFIED="1569852603195"/>
</node>
</node>
<node TEXT="커스텀 컨버터" FOLDED="true" ID="ID_146602442" CREATED="1569852707954" MODIFIED="1569874259327">
<node TEXT="package com.example.demo.config;" ID="ID_564378419" CREATED="1569852710508" MODIFIED="1569852710508"/>
<node TEXT="import java.util.HashMap;" ID="ID_306225014" CREATED="1569852710510" MODIFIED="1569852710510"/>
<node TEXT="import java.util.Map;" ID="ID_1005288708" CREATED="1569852710511" MODIFIED="1569852710511"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_1793086413" CREATED="1569852710513" MODIFIED="1569852710513"/>
<node TEXT="import org.springframework.security.oauth2.provider.OAuth2Authentication;" ID="ID_122839233" CREATED="1569852710514" MODIFIED="1569852710514"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.DefaultAccessTokenConverter;" ID="ID_1134936311" CREATED="1569852710516" MODIFIED="1569852710516"/>
<node TEXT="import org.springframework.stereotype.Component;" ID="ID_998691690" CREATED="1569852710518" MODIFIED="1569852710518"/>
<node TEXT="@Component" ID="ID_936636115" CREATED="1569852710520" MODIFIED="1569852710520"/>
<node TEXT="public class CheckTokenConverter extends DefaultAccessTokenConverter {" ID="ID_1112560124" CREATED="1569852710521" MODIFIED="1569852710521">
<node TEXT="private Map checkTokenResult;" ID="ID_877206822" CREATED="1569852710523" MODIFIED="1569852710523"/>
<node TEXT="@Override" ID="ID_1633839284" CREATED="1569852710524" MODIFIED="1569852710524"/>
<node TEXT="public OAuth2Authentication extractAuthentication(Map&lt;String, ?&gt; map) {" ID="ID_167257249" CREATED="1569852710526" MODIFIED="1569852710526">
<node TEXT="// TODO Auto-generated method stub" ID="ID_353431187" CREATED="1569852710527" MODIFIED="1569852710527"/>
<node TEXT="OAuth2Authentication auth = super.extractAuthentication(map);" ID="ID_902413869" CREATED="1569852710529" MODIFIED="1569852710529"/>
<node TEXT="auth.setDetails(map);" ID="ID_206026850" CREATED="1569852710530" MODIFIED="1569852710530"/>
<node TEXT="this.checkTokenResult = new HashMap(map);" ID="ID_1063711673" CREATED="1569852710532" MODIFIED="1569852710532"/>
<node TEXT="return auth;" ID="ID_650061553" CREATED="1569852710533" MODIFIED="1569852710533"/>
</node>
<node TEXT="}" ID="ID_382488509" CREATED="1569852710535" MODIFIED="1569852710535"/>
<node TEXT="public Map getCheckTokenResult() {" ID="ID_577585456" CREATED="1569852710537" MODIFIED="1569852710537">
<node TEXT="return checkTokenResult;" ID="ID_1708469594" CREATED="1569852710539" MODIFIED="1569852710539"/>
</node>
<node TEXT="}" ID="ID_1829059001" CREATED="1569852710540" MODIFIED="1569852710540"/>
<node TEXT="public void setCheckTokenResult(Map checkTokenResult) {" ID="ID_326545832" CREATED="1569852710542" MODIFIED="1569852710542">
<node TEXT="this.checkTokenResult = checkTokenResult;" ID="ID_742035779" CREATED="1569852710543" MODIFIED="1569852710543"/>
</node>
<node TEXT="}" ID="ID_479426324" CREATED="1569852710545" MODIFIED="1569852710545"/>
</node>
<node TEXT="}" ID="ID_716189259" CREATED="1569852710546" MODIFIED="1569852710546"/>
</node>
<node TEXT="설명" FOLDED="true" ID="ID_875060908" CREATED="1569852594867" MODIFIED="1569874259327">
<node TEXT="또한 리소스 서버에서 해당 토큰에 부합하는 데이터를 긁어와야 하는 경우가 많이 있다." ID="ID_1846030939" CREATED="1569852473283" MODIFIED="1569852597048"/>
<node TEXT="이에 대한 경우는 AccessTokenConverter에서 따로 CustomConverter를 세팅하여 사용하면 된다." ID="ID_125684144" CREATED="1569852505130" MODIFIED="1569852597046"/>
</node>
<node TEXT="컨트롤러" ID="ID_1676526657" CREATED="1569852727475" MODIFIED="1602652854827">
<node TEXT="package com.example.demo.oAuth2;" ID="ID_783014786" CREATED="1569852860173" MODIFIED="1569852860173"/>
<node TEXT="import java.security.Principal;" ID="ID_1567537639" CREATED="1569852860173" MODIFIED="1569852860173"/>
<node TEXT="import javax.servlet.http.HttpServletRequest;" ID="ID_399339181" CREATED="1569852860174" MODIFIED="1569852860174"/>
<node TEXT="import org.apache.commons.lang3.RandomStringUtils;" ID="ID_1910536269" CREATED="1569852860174" MODIFIED="1569852860174"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_1122458700" CREATED="1569852860174" MODIFIED="1569852860174"/>
<node TEXT="import org.springframework.security.access.prepost.PreAuthorize;" ID="ID_275054003" CREATED="1569852860175" MODIFIED="1569852860175"/>
<node TEXT="import org.springframework.security.oauth2.provider.OAuth2Authentication;" ID="ID_44228503" CREATED="1569852860175" MODIFIED="1569852860175"/>
<node TEXT="import org.springframework.web.bind.annotation.PathVariable;" ID="ID_1850879999" CREATED="1569852860175" MODIFIED="1569852860175"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestHeader;" ID="ID_819118149" CREATED="1569852860176" MODIFIED="1569852860176"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestMapping;" ID="ID_1872845961" CREATED="1569852860176" MODIFIED="1569852860176"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestMethod;" ID="ID_1638265204" CREATED="1569852860177" MODIFIED="1569852860177"/>
<node TEXT="import org.springframework.web.bind.annotation.RestController;" ID="ID_1644750519" CREATED="1569852860177" MODIFIED="1569852860177"/>
<node TEXT="import com.example.demo.config.CheckTokenConverter;" ID="ID_722097925" CREATED="1569852860177" MODIFIED="1569852860177"/>
<node TEXT="@RestController" ID="ID_1694067739" CREATED="1569852860178" MODIFIED="1569852860178"/>
<node TEXT="public class FooContoroller {" ID="ID_598493342" CREATED="1569852860178" MODIFIED="1569852860178">
<node TEXT="@Autowired" ID="ID_831564142" CREATED="1569852860178" MODIFIED="1569852860178"/>
<node TEXT="HttpServletRequest reqeust;" ID="ID_819211031" CREATED="1569852860179" MODIFIED="1569852860179"/>
<node TEXT="@Autowired" ID="ID_869796484" CREATED="1569852860179" MODIFIED="1569852860179"/>
<node TEXT="CheckTokenConverter checkConverter;" ID="ID_233795405" CREATED="1569852860179" MODIFIED="1569852860179"/>
<node TEXT="@PreAuthorize(&quot;#oauth2.hasScope(&apos;read&apos;)&quot;)" ID="ID_437744347" CREATED="1569852860179" MODIFIED="1569852860179"/>
<node TEXT="@RequestMapping(method = RequestMethod.GET,value = &quot;/foo/{id}&quot;)" ID="ID_665215146" CREATED="1569852860180" MODIFIED="1569852860180"/>
<node TEXT="public Foo FindById(@PathVariable long id, OAuth2Authentication auth) {" ID="ID_1765476273" CREATED="1569852860180" MODIFIED="1569852860180" LINK="mailto:FindById(@PathVariable"/>
</node>
<node TEXT="//                OAuth2Authentication oauth2Auth = tokenService.loadAuthentication(&quot;ccf1abc5-67af-4fc9-a775-893a23632671&quot;);" ID="ID_1866107040" CREATED="1569852860181" MODIFIED="1569852860181"/>
<node TEXT="//" ID="ID_183646800" CREATED="1569852860182" MODIFIED="1569852860182"/>
<node TEXT="//                System.out.println(oauth2Auth.getPrincipal());" ID="ID_231097841" CREATED="1569852860182" MODIFIED="1569852860182">
<node TEXT="//System.out.println(reqeust.getUserPrincipal().toString());" ID="ID_1005506639" CREATED="1569852860182" MODIFIED="1569852860182"/>
<node TEXT="//tokenService.readAccessToken(oauth_user_data.)" ID="ID_1779520052" CREATED="1569852860183" MODIFIED="1569852860183"/>
<node TEXT="//System.out.println(auth.getDetails());" ID="ID_1171128461" CREATED="1569852860183" MODIFIED="1569852860183"/>
<node TEXT="System.out.println(checkConverter.getCheckTokenResult().toString());" ID="ID_1819835386" CREATED="1569852860183" MODIFIED="1569852860183"/>
<node TEXT="return" ID="ID_825613712" CREATED="1569852860184" MODIFIED="1569852860184">
<node TEXT="new Foo(Long.parseLong(RandomStringUtils.randomNumeric(2)),RandomStringUtils.randomAlphabetic(4));" ID="ID_1008713691" CREATED="1569852860184" MODIFIED="1569852860184"/>
</node>
<node TEXT="}" ID="ID_1764178444" CREATED="1569852860185" MODIFIED="1569852860185"/>
</node>
<node TEXT="}" ID="ID_1634168542" CREATED="1569852860185" MODIFIED="1569852860185"/>
</node>
<node TEXT="헤더" FOLDED="true" ID="ID_244908803" CREATED="1569852890251" MODIFIED="1572219194951">
<node TEXT="GET /foo/1 HTTP/1.1" ID="ID_1331666855" CREATED="1569852905053" MODIFIED="1569852905053"/>
<node TEXT="Host: 127.0.0.1:8082" ID="ID_1581733648" CREATED="1569852905053" MODIFIED="1569852905053"/>
<node TEXT="Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX25hbWUiOiJUY3RUZXN0QGdtYWlsLmNvbSIsInNjb3BlIjpbInJlYWQiLCJ3cml0ZSJdLCJleHAiOjE1Njk4OTQzMjEsInVzZXJJZCI6IjEyMzEyMyIsImF1dGhvcml0aWVzIjpbIlJPTEVfU1lTVEVNQURNSU4iXSwianRpIjoiNmE5MWQwOGUtMzM4Yy00NTU4LWIxNmQtNTU1NzQ4ZGY1YTllIiwiY2xpZW50X2lkIjoiVGN0VGVzdCJ9.YQvg-ETJNvCRGLGjWrr3t7nHE0aN1waobUReAMgr9c6r2W9dj2OFCGC2Rmp-LpLCcw92jZBlp7RdE-Cqc0kZj_JGbgSU0GOi47PcXq7Q0OmBQKV68alqsbNHWnqjqjNedSbqvWWL-fkUVXb0dcjueZeiyM-xAgOP6wF9E_TnbHZLjNHQ3r1PIp50Kpas1mFWt4tmPZxHr18LsDcs2WHG17L6RhU2EuyIVVYbsnXXpWK331fwI_BtGaotKcwBVTZRoj51eY4HJK0ui6JHAzNIsKwztEPEvM0g6Yiq-yANJxqKk57P0HgJGtHDRlO_3wbLW8pnKsY3Rr4CY4nYylD-pg" ID="ID_1784834784" CREATED="1569852905054" MODIFIED="1569852905054"/>
<node TEXT="User-Agent: PostmanRuntime/7.17.1" ID="ID_613444832" CREATED="1569852905062" MODIFIED="1569852905062"/>
<node TEXT="Accept: */*" ID="ID_396727791" CREATED="1569852905063" MODIFIED="1569852905063"/>
<node TEXT="Cache-Control: no-cache" ID="ID_824440878" CREATED="1569852905063" MODIFIED="1569852905063"/>
<node TEXT="Postman-Token: 6f05e8f5-c59f-43dd-a9cb-023aa1de2c30,e786871f-d71c-4f33-8350-76a37b5066ef" ID="ID_1423194450" CREATED="1569852905064" MODIFIED="1569852905064"/>
<node TEXT="Host: 127.0.0.1:8082" ID="ID_775144107" CREATED="1569852905064" MODIFIED="1569852905064"/>
<node TEXT="Accept-Encoding: gzip, deflate" ID="ID_1867369251" CREATED="1569852905065" MODIFIED="1569852905065"/>
<node TEXT="Connection: keep-alive" ID="ID_1643097271" CREATED="1569852905065" MODIFIED="1569852905065"/>
<node TEXT="cache-control: no-cache" ID="ID_234782694" CREATED="1569852905065" MODIFIED="1569852905065"/>
</node>
</node>
<node TEXT="8. 인증시 추가적인 파라미터 보내기" FOLDED="true" ID="ID_1407077227" CREATED="1569852202698" MODIFIED="1606122254486">
<node TEXT="해당하는 git을 베이스로 깔고 작업한다." ID="ID_144187703" CREATED="1569853820037" MODIFIED="1569853831817">
<node TEXT="https://github.com/eugenp/tutorials/blob/master/spring-5-security/src/main/java/com/baeldung/loginextrafieldscustom/CustomUserDetailsAuthenticationProvider.java" ID="ID_1332736189" CREATED="1569483281901" MODIFIED="1569483281901" LINK="https://github.com/eugenp/tutorials/blob/master/spring-5-security/src/main/java/com/baeldung/loginextrafieldscustom/CustomUserDetailsAuthenticationProvider.java"/>
</node>
<node TEXT="웹 시큐리티에서 provider를 이용" ID="ID_1634694014" CREATED="1569852995820" MODIFIED="1569853415289">
<node TEXT="@Configuration" ID="ID_1272698504" CREATED="1569853964463" MODIFIED="1569853967537"/>
<node TEXT="@EnableWebSecurity" ID="ID_1402915546" CREATED="1569853964464" MODIFIED="1569853967540"/>
<node TEXT="@EnableGlobalMethodSecurity(prePostEnabled = true)" ID="ID_1993217152" CREATED="1569853964465" MODIFIED="1569853967542"/>
<node TEXT="public class WebSecurityConfig extends WebSecurityConfigurerAdapter {" ID="ID_1346821143" CREATED="1569853964466" MODIFIED="1569853967547">
<node TEXT="@Autowired" ID="ID_1496841766" CREATED="1569853964468" MODIFIED="1569853964468"/>
</node>
<node TEXT="CustomProvider customProvider;" ID="ID_817462577" CREATED="1569853964471" MODIFIED="1569853964471"/>
<node TEXT="@Override" ID="ID_374436614" CREATED="1569853952218" MODIFIED="1569853952218"/>
<node TEXT="protected void configure(AuthenticationManagerBuilder auth) throws Exception {" ID="ID_1452957892" CREATED="1569853952221" MODIFIED="1569853952221">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1184988984" CREATED="1569853952223" MODIFIED="1569853952223"/>
<node TEXT="// super.configure(auth);" ID="ID_410735523" CREATED="1569853952225" MODIFIED="1569853952225"/>
<node TEXT="//auth.inMemoryAuthentication().withUser(&quot;user&quot;).password(&quot;{noop}password&quot;).roles(&quot;USER&quot;);" ID="ID_1441358462" CREATED="1569853952227" MODIFIED="1569853952227"/>
<node TEXT="auth.authenticationProvider(customProvider);" ID="ID_1418512401" CREATED="1569853952229" MODIFIED="1569853952229"/>
</node>
<node TEXT="}" ID="ID_1748113851" CREATED="1569853952231" MODIFIED="1569853952231"/>
</node>
<node TEXT="CustomProvider" ID="ID_1196163102" CREATED="1569853989601" MODIFIED="1569874466073">
<node TEXT="package com.framework.Tct.oAuth2;" ID="ID_506992251" CREATED="1569854032730" MODIFIED="1569854032730"/>
<node TEXT="import java.util.Map;" ID="ID_1077590182" CREATED="1569854032731" MODIFIED="1569854032731"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_100134424" CREATED="1569854032732" MODIFIED="1569854032732"/>
<node TEXT="import org.springframework.security.authentication.BadCredentialsException;" ID="ID_416950939" CREATED="1569854032734" MODIFIED="1569854032734"/>
<node TEXT="import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;" ID="ID_103523816" CREATED="1569854032735" MODIFIED="1569854032735"/>
<node TEXT="import org.springframework.security.authentication.dao.AbstractUserDetailsAuthenticationProvider;" ID="ID_1203955564" CREATED="1569854032736" MODIFIED="1569854032736"/>
<node TEXT="import org.springframework.security.core.AuthenticationException;" ID="ID_1410103842" CREATED="1569854032738" MODIFIED="1569854032738"/>
<node TEXT="import org.springframework.security.core.userdetails.UserDetails;" ID="ID_609653132" CREATED="1569854032739" MODIFIED="1569854032739"/>
<node TEXT="import org.springframework.security.crypto.password.PasswordEncoder;" ID="ID_1252268909" CREATED="1569854032740" MODIFIED="1569854032740"/>
<node TEXT="import org.springframework.stereotype.Service;" ID="ID_1861627927" CREATED="1569854032741" MODIFIED="1569854032741"/>
<node TEXT="@Service" ID="ID_743970374" CREATED="1569854032742" MODIFIED="1569854032742"/>
<node TEXT="public class CustomProvider extends AbstractUserDetailsAuthenticationProvider {" FOLDED="true" ID="ID_303612566" CREATED="1569854032743" MODIFIED="1602652726117">
<node TEXT="@Autowired" ID="ID_1020123289" CREATED="1569854032745" MODIFIED="1569854032745"/>
<node TEXT="CustomDetailService customDetailService;" ID="ID_374770877" CREATED="1569854032746" MODIFIED="1569854032746"/>
<node TEXT="@Autowired" ID="ID_1588693597" CREATED="1569854032747" MODIFIED="1569854032747"/>
<node TEXT="PasswordEncoder passwordEncoder;" ID="ID_524014142" CREATED="1569854032748" MODIFIED="1569854032748"/>
<node TEXT="@Override" ID="ID_419084791" CREATED="1569854032749" MODIFIED="1569854032749"/>
<node TEXT="protected void additionalAuthenticationChecks(UserDetails userDetails, UsernamePasswordAuthenticationToken authentication)" ID="ID_571333599" CREATED="1569854032750" MODIFIED="1569854032750">
<node TEXT="throws AuthenticationException {" ID="ID_384943593" CREATED="1569854032753" MODIFIED="1569854032753"/>
<node TEXT="// TODO Auto-generated method stub" ID="ID_7484646" CREATED="1569854032754" MODIFIED="1569854032754"/>
</node>
<node TEXT="if (authentication.getCredentials() == null) {" ID="ID_1879096743" CREATED="1569854032754" MODIFIED="1569854032754">
<node TEXT="logger.debug(&quot;Authentication failed: no credentials provided&quot;);" ID="ID_1483315772" CREATED="1569854032755" MODIFIED="1569854032755"/>
<node TEXT="throw new BadCredentialsException(" ID="ID_144930312" CREATED="1569854032755" MODIFIED="1569854032755">
<node TEXT="messages.getMessage(&quot;AbstractUserDetailsAuthenticationProvider.badCredentials&quot;, &quot;Bad credentials&quot;));" ID="ID_683424908" CREATED="1569854032756" MODIFIED="1569854032756"/>
</node>
</node>
<node TEXT="}" ID="ID_208296160" CREATED="1569854032756" MODIFIED="1569854032756"/>
<node TEXT="String presentedPassword = authentication.getCredentials()" ID="ID_517739936" CREATED="1569854032757" MODIFIED="1569854032757">
<node TEXT=".toString();" ID="ID_723052520" CREATED="1569854032757" MODIFIED="1569854032757"/>
</node>
<node TEXT="if (!passwordEncoder.matches(presentedPassword, userDetails.getPassword())) {" ID="ID_355175734" CREATED="1569854032758" MODIFIED="1569854032758">
<node TEXT="logger.debug(&quot;Authentication failed: password does not match stored value&quot;);" ID="ID_744854369" CREATED="1569854032758" MODIFIED="1569854032758"/>
<node TEXT="throw new BadCredentialsException(" ID="ID_1851561130" CREATED="1569854032758" MODIFIED="1569854032758">
<node TEXT="messages.getMessage(&quot;AbstractUserDetailsAuthenticationProvider.badCredentials&quot;, &quot;Bad credentials&quot;));" ID="ID_182041469" CREATED="1569854032759" MODIFIED="1569854032759"/>
</node>
</node>
<node TEXT="}" ID="ID_96984773" CREATED="1569854032759" MODIFIED="1569854032759"/>
<node TEXT="}" ID="ID_68242522" CREATED="1569854032759" MODIFIED="1569854032759"/>
<node TEXT="@Override" ID="ID_1850024949" CREATED="1569854032760" MODIFIED="1569854032760"/>
<node TEXT="protected UserDetails retrieveUser(String arg0, UsernamePasswordAuthenticationToken authentication)" ID="ID_40151700" CREATED="1569854032760" MODIFIED="1569854032760">
<node TEXT="throws AuthenticationException {" ID="ID_9625669" CREATED="1569854032760" MODIFIED="1569854032760"/>
<node TEXT="// TODO Auto-generated method stub" ID="ID_23676398" CREATED="1569854032761" MODIFIED="1569854032761"/>
</node>
</node>
<node TEXT="//                CustomAuthentication auth = (CustomAuthentication)authentication;" ID="ID_889668325" CREATED="1569854032761" MODIFIED="1569854032761"/>
<node TEXT="//" ID="ID_1663164074" CREATED="1569854032762" MODIFIED="1569854032762"/>
<node TEXT="//                String username = auth.getName();" ID="ID_231842311" CREATED="1569854032762" MODIFIED="1569854032762"/>
<node TEXT="//                String domain = auth.getDomain();" ID="ID_714310113" CREATED="1569854032762" MODIFIED="1569874471582">
<node TEXT="Map&lt;String,Object&gt; authMap = (Map&lt;String,Object&gt;)authentication.getDetails();" ID="ID_1303546054" CREATED="1569854032762" MODIFIED="1569854032762"/>
<node TEXT="String username = authentication.getName();" ID="ID_1066890556" CREATED="1569854032763" MODIFIED="1569854032763"/>
<node TEXT="String domain33 = &quot;&quot;;" ID="ID_308199017" CREATED="1569854032763" MODIFIED="1569854032763"/>
<node TEXT="if(authMap.get(&quot;domain33&quot;) != null) {" ID="ID_773069452" CREATED="1569854032763" MODIFIED="1569854032763">
<node TEXT="domain33 = authMap.get(&quot;domain33&quot;).toString();" ID="ID_728514149" CREATED="1569854032764" MODIFIED="1569854032764"/>
</node>
<node TEXT="}" ID="ID_1437433426" CREATED="1569854032764" MODIFIED="1569854032764"/>
<node TEXT="System.out.println(domain33);" ID="ID_24628122" CREATED="1569854032765" MODIFIED="1569854032765"/>
<node TEXT="CustomUser user = customDetailService.loadUserByUsername(username);" ID="ID_83465200" CREATED="1569854032765" MODIFIED="1569854032765"/>
<node TEXT="//System.out.println(authentication.getDetails().toString());" ID="ID_103166220" CREATED="1569854032765" MODIFIED="1569854032765"/>
<node TEXT="return user;" ID="ID_1777000337" CREATED="1569854032766" MODIFIED="1569854032766"/>
<node TEXT="}" ID="ID_1598290622" CREATED="1569854032766" MODIFIED="1569854032766"/>
</node>
<node TEXT="}" ID="ID_226651037" CREATED="1569854032766" MODIFIED="1569854032766"/>
</node>
<node TEXT="설명" ID="ID_1835558224" CREATED="1569854053566" MODIFIED="1569854055522">
<node TEXT="provider 기본 개념(이미지)" FOLDED="true" ID="ID_235308373" CREATED="1569854415647" MODIFIED="1606122242685">
<node ID="ID_1269065793" CREATED="1569854422689" MODIFIED="1569854422689"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_1608882250812503580.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="Map&lt;String,Object&gt; authMap = (Map&lt;String,Object&gt;)authentication.getDetails();" ID="ID_508655589" CREATED="1569854063346" MODIFIED="1569854063346"/>
<node TEXT="를 통하여 id와 password를 제외한 다른 파라미터를 가져올 수 있다." ID="ID_1918257203" CREATED="1569854064566" MODIFIED="1569854113562"/>
<node TEXT="여기서는 donmain33 이라는 keyt를 가진 변수를 말한다." ID="ID_1817533247" CREATED="1569854113750" MODIFIED="1569854121034"/>
<node TEXT="데이터를 보낼 때도 domain33으로 데이터를 보낸다." ID="ID_1173031062" CREATED="1569854139751" MODIFIED="1569854178274"/>
<node TEXT="그렇게  access token을 요청할 때 같이 인증 요청을 보내면 저 provider에서 데이터를 뽑아내어 dao나 기타 다른 방법으로 처리할 수 있다." ID="ID_439295908" CREATED="1569854228190" MODIFIED="1569854308467"/>
</node>
<node TEXT="헤더" ID="ID_1663500860" CREATED="1569854135367" MODIFIED="1569859979056">
<node TEXT="POST /oauth/token HTTP/1.1" ID="ID_1993343647" CREATED="1569850963876" MODIFIED="1569850963876"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_1710192185" CREATED="1569850963879" MODIFIED="1569850963879"/>
<node TEXT="Content-Type: application/x-www-form-urlencoded" ID="ID_418000090" CREATED="1569850963882" MODIFIED="1569850963882"/>
<node TEXT="Authorization: Basic VGN0VGVzdDoxMjM0MTIzNGFh" ID="ID_1334837307" CREATED="1569850963883" MODIFIED="1569850963883"/>
<node TEXT="User-Agent: PostmanRuntime/7.17.1" ID="ID_766415709" CREATED="1569850963885" MODIFIED="1569850963885"/>
<node TEXT="Accept: */*" ID="ID_731579882" CREATED="1569850963886" MODIFIED="1569850963886"/>
<node TEXT="Cache-Control: no-cache" ID="ID_1918063181" CREATED="1569850963888" MODIFIED="1569850963888"/>
<node TEXT="Postman-Token: f79797a4-298c-4da3-947b-299640feb1f9,557fb23a-4852-4cdc-98f0-fcdc027a5a33" ID="ID_356958153" CREATED="1569850963889" MODIFIED="1569850963889"/>
<node TEXT="Host: 127.0.0.1:8081" ID="ID_1056517632" CREATED="1569850963891" MODIFIED="1569850963891"/>
<node TEXT="Accept-Encoding: gzip, deflate" ID="ID_806572702" CREATED="1569850963892" MODIFIED="1569850963892"/>
<node TEXT="Content-Length: 89" ID="ID_1628386514" CREATED="1569850963894" MODIFIED="1569850963894"/>
<node TEXT="Connection: keep-alive" ID="ID_1815593946" CREATED="1569850963895" MODIFIED="1569850963895"/>
<node TEXT="cache-control: no-cache" ID="ID_1216308929" CREATED="1569850963897" MODIFIED="1569850963897"/>
<node TEXT="username=TctTest%40gmail.com&amp;password=12341234aa&amp;grant_type=password&amp;domain33=wfwefwefwef" ID="ID_1379628881" CREATED="1569850963898" MODIFIED="1569850963898"/>
</node>
<node TEXT="여기서 implicit로 인증 할 경우 그러니까 login 화면을 통해서 인증을 할 경우 customAutehntication을 만들어야 하며, 여기에 대한 내용은 이곳을 참조하시라" ID="ID_1881372330" CREATED="1569859991331" MODIFIED="1569874921989">
<node TEXT="https://www.baeldung.com/spring-security-extra-login-fields" ID="ID_1981683381" CREATED="1569432975815" MODIFIED="1569432975815" LINK="https://www.baeldung.com/spring-security-extra-login-fields"/>
</node>
</node>
<node TEXT="9. 추가적인 토큰 정보 가져오기" FOLDED="true" ID="ID_977774096" CREATED="1569861471333" MODIFIED="1614153218888">
<node TEXT="유저서비스" ID="ID_1754096133" CREATED="1569861753127" MODIFIED="1606122257870">
<node TEXT="package com.framework.Tct.oAuth2;" ID="ID_983252093" CREATED="1569861906932" MODIFIED="1569861906932"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_251116445" CREATED="1569861906935" MODIFIED="1569861906935"/>
<node TEXT="import org.springframework.security.core.userdetails.UserDetailsService;" ID="ID_1136103315" CREATED="1569861906936" MODIFIED="1569861906936"/>
<node TEXT="import org.springframework.security.core.userdetails.UsernameNotFoundException;" ID="ID_1021396482" CREATED="1569861906939" MODIFIED="1569861906939"/>
<node TEXT="import org.springframework.stereotype.Service;" ID="ID_429573351" CREATED="1569861906941" MODIFIED="1569861906941"/>
<node TEXT="@Service" ID="ID_654702340" CREATED="1569861906943" MODIFIED="1569861906943"/>
<node TEXT="public class CustomDetailService implements UserDetailsService {" FOLDED="true" ID="ID_501472218" CREATED="1569861906944" MODIFIED="1606122258829">
<node TEXT="@Autowired" ID="ID_1340792288" CREATED="1569861906945" MODIFIED="1569861906945"/>
<node TEXT="OAuthDao oauthDao;" ID="ID_634472978" CREATED="1569861906946" MODIFIED="1569861906946"/>
<node TEXT="@Override" ID="ID_435503517" CREATED="1569861906947" MODIFIED="1569861906947"/>
<node TEXT="public CustomUser loadUserByUsername(String username) throws UsernameNotFoundException {" ID="ID_124088987" CREATED="1569861906948" MODIFIED="1569861906948">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1000509190" CREATED="1569861906948" MODIFIED="1569861906948"/>
<node TEXT="UserEntity userEntity = null;" ID="ID_567219539" CREATED="1569861906949" MODIFIED="1569861906949"/>
<node TEXT="try {" ID="ID_731952400" CREATED="1569861906950" MODIFIED="1569861906950">
<node TEXT="userEntity = oauthDao.getUserDetails(username);" ID="ID_53519769" CREATED="1569861906951" MODIFIED="1569861906951"/>
<node TEXT="CustomUser customUser = new CustomUser(userEntity);" ID="ID_346397319" CREATED="1569861906952" MODIFIED="1569861906952"/>
<node TEXT="return customUser;" ID="ID_1414278561" CREATED="1569861906953" MODIFIED="1569861906953"/>
</node>
<node TEXT="} catch (Exception e) {" ID="ID_275073487" CREATED="1569861906954" MODIFIED="1569861906954">
<node TEXT="// TODO Auto-generated catch block" ID="ID_435511369" CREATED="1569861906955" MODIFIED="1569861906955"/>
<node TEXT="e.printStackTrace();" ID="ID_165888326" CREATED="1569861906956" MODIFIED="1569861906956"/>
<node TEXT="throw new UsernameNotFoundException(&quot;User &quot; + username + &quot; was not found in the database&quot; );" ID="ID_556823117" CREATED="1569861906957" MODIFIED="1569861906957"/>
</node>
<node TEXT="}" ID="ID_860619162" CREATED="1569861906958" MODIFIED="1569861906958"/>
</node>
<node TEXT="}" ID="ID_1209872406" CREATED="1569861906959" MODIFIED="1569861906959"/>
</node>
<node TEXT="}" ID="ID_1462655496" CREATED="1569861906959" MODIFIED="1569861906959"/>
</node>
<node TEXT="provider에서 userService 사용" ID="ID_1020485196" CREATED="1569861912366" MODIFIED="1606122260230">
<node TEXT="@Override" FOLDED="true" ID="ID_564890527" CREATED="1569861979134" MODIFIED="1606122261158">
<node TEXT="protected UserDetails retrieveUser(String arg0, UsernamePasswordAuthenticationToken authentication)" ID="ID_937258940" CREATED="1569861979136" MODIFIED="1569861979136">
<node TEXT="throws AuthenticationException {" ID="ID_953214770" CREATED="1569861979139" MODIFIED="1569861979139"/>
<node TEXT="// TODO Auto-generated method stub" ID="ID_1159158048" CREATED="1569861979141" MODIFIED="1569861979141"/>
</node>
</node>
<node TEXT="//                CustomAuthentication auth = (CustomAuthentication)authentication;" ID="ID_828543407" CREATED="1569861979143" MODIFIED="1569861979143"/>
<node TEXT="//" ID="ID_438974446" CREATED="1569861979146" MODIFIED="1569861979146"/>
<node TEXT="//                String username = auth.getName();" ID="ID_1938357901" CREATED="1569861979147" MODIFIED="1569861979147"/>
<node TEXT="//                String domain = auth.getDomain();" FOLDED="true" ID="ID_215014803" CREATED="1569861979149" MODIFIED="1606122261158">
<node TEXT="Map&lt;String, Object&gt; authMap = new HashMap&lt;String, Object&gt;();" ID="ID_1499594122" CREATED="1569861979151" MODIFIED="1569861979151"/>
<node TEXT="try {" ID="ID_1022345686" CREATED="1569861979153" MODIFIED="1569861979153">
<node TEXT="authMap = (Map&lt;String,Object&gt;)authentication.getDetails();" ID="ID_1033321686" CREATED="1569861979154" MODIFIED="1569861979154"/>
</node>
<node TEXT="} catch (Exception e) {" ID="ID_333571285" CREATED="1569861979155" MODIFIED="1569861979155">
<node TEXT="// TODO Auto-generated catch block" ID="ID_271984999" CREATED="1569861979155" MODIFIED="1569861979155"/>
<node TEXT="e.printStackTrace();" ID="ID_1951815892" CREATED="1569861979156" MODIFIED="1569861979156"/>
</node>
<node TEXT="}" ID="ID_653167121" CREATED="1569861979157" MODIFIED="1569861979157"/>
<node TEXT="String username = authentication.getName();" ID="ID_303711894" CREATED="1569861979157" MODIFIED="1569861979157"/>
<node TEXT="String domain33 = &quot;&quot;;" ID="ID_1694249185" CREATED="1569861979158" MODIFIED="1569861979158"/>
<node TEXT="if(authMap.get(&quot;domain33&quot;) != null) {" ID="ID_1961220761" CREATED="1569861979158" MODIFIED="1569861979158">
<node TEXT="domain33 = authMap.get(&quot;domain33&quot;).toString();" ID="ID_874487856" CREATED="1569861979159" MODIFIED="1569861979159"/>
</node>
<node TEXT="}" ID="ID_77142015" CREATED="1569861979160" MODIFIED="1569861979160"/>
<node TEXT="System.out.println(domain33);" ID="ID_1788540091" CREATED="1569861979160" MODIFIED="1569861979160"/>
<node TEXT="CustomUser user = customDetailService.loadUserByUsername(username);" ID="ID_737120421" CREATED="1569861979161" MODIFIED="1569861979161"/>
<node TEXT="//System.out.println(authentication.getDetails().toString());" ID="ID_1072753073" CREATED="1569861979162" MODIFIED="1569861979162"/>
<node TEXT="return user;" ID="ID_379116584" CREATED="1569861979162" MODIFIED="1569861979162"/>
<node TEXT="}" ID="ID_307226153" CREATED="1569861979163" MODIFIED="1569861979163"/>
</node>
</node>
<node TEXT="customUser" ID="ID_347361084" CREATED="1569862906823" MODIFIED="1606122261517">
<node TEXT="package com.framework.Tct.oAuth2;" ID="ID_1926493811" CREATED="1569862907942" MODIFIED="1569862907942"/>
<node TEXT="import org.springframework.security.core.userdetails.User;" ID="ID_1931572899" CREATED="1569862907946" MODIFIED="1569862907946"/>
<node TEXT="public class CustomUser extends User {" FOLDED="true" ID="ID_1241499879" CREATED="1569862907948" MODIFIED="1606122262349">
<node TEXT="private String userId;" ID="ID_449022579" CREATED="1569862907950" MODIFIED="1569862907950"/>
<node TEXT="public String getUserId() {" ID="ID_1318887415" CREATED="1569862907952" MODIFIED="1569862907952">
<node TEXT="return userId;" ID="ID_1486746700" CREATED="1569862907954" MODIFIED="1569862907954"/>
</node>
<node TEXT="}" ID="ID_404910031" CREATED="1569862907956" MODIFIED="1569862907956"/>
<node TEXT="public void setUserId(String userId) {" ID="ID_1692330285" CREATED="1569862907958" MODIFIED="1569862907958">
<node TEXT="this.userId = userId;" ID="ID_322271152" CREATED="1569862907959" MODIFIED="1569862907959"/>
</node>
<node TEXT="}" ID="ID_958638282" CREATED="1569862907961" MODIFIED="1569862907961"/>
<node TEXT="/**" ID="ID_6035678" CREATED="1569862907963" MODIFIED="1569862907963">
<node TEXT="*" ID="ID_576418978" CREATED="1569862907965" MODIFIED="1569862907965"/>
<node TEXT="*/" ID="ID_1402084506" CREATED="1569862907968" MODIFIED="1569862907968"/>
</node>
<node TEXT="private static final long serialVersionUID = 1L;" ID="ID_534504624" CREATED="1569862907970" MODIFIED="1569862907970"/>
<node TEXT="public CustomUser(UserEntity user) {" ID="ID_758745917" CREATED="1569862907972" MODIFIED="1569862907972">
<node TEXT="// TODO Auto-generated constructor stub" ID="ID_1337772018" CREATED="1569862907974" MODIFIED="1569862907974"/>
<node TEXT="super(user.getUsername(), user.getPassword(), user.getGrantedAuthoritiesList());" ID="ID_1002960776" CREATED="1569862907975" MODIFIED="1569862907975"/>
<node TEXT="this.userId = &quot;123123&quot;;" ID="ID_1727153142" CREATED="1569862907977" MODIFIED="1569862907977"/>
</node>
<node TEXT="}" ID="ID_1048160810" CREATED="1569862907979" MODIFIED="1569862907979"/>
</node>
<node TEXT="}" ID="ID_1095957636" CREATED="1569862907981" MODIFIED="1569862907981"/>
</node>
<node TEXT="설명" FOLDED="true" ID="ID_449471868" CREATED="1569861909414" MODIFIED="1606122264958">
<node TEXT="기본적으로 provider에서 UserDetails를 리턴 시켜줘야만 하고" ID="ID_1845064978" CREATED="1569861984735" MODIFIED="1569862168787"/>
<node TEXT="여기서 User를 리턴하는  유저서비스를 사용하는게 일반적이다." ID="ID_1872603588" CREATED="1569862168998" MODIFIED="1569862616379"/>
<node TEXT="User는 UserDetails를 구현한다." ID="ID_1050276567" CREATED="1569862629343" MODIFIED="1569862639195"/>
<node TEXT="보통 이 User를 상속받아서 커스텀 User를 만들어 사용한다." ID="ID_1790855640" CREATED="1569862651672" MODIFIED="1569862671796"/>
<node TEXT="이런 방식으로 하면 user가 authentication에 저장된다. getPrincipal을 통해서 해당 user에 대한 정보를 가져올 수 있다." ID="ID_1351589831" CREATED="1569862977416" MODIFIED="1569863122300"/>
<node TEXT="해당 커스텀유저에서 userId을 픽스해서 저장했다." ID="ID_306666418" CREATED="1569863299056" MODIFIED="1569863317076"/>
</node>
<node TEXT="액세스 토큰에 해당 유저 정보 추가" ID="ID_20863535" CREATED="1569863984842" MODIFIED="1606122265291">
<node TEXT="@Bean" ID="ID_651770771" CREATED="1569864011495" MODIFIED="1569864011495"/>
<node TEXT="public TokenEnhancer tokenEnhancer() {" FOLDED="true" ID="ID_943779449" CREATED="1569864011497" MODIFIED="1606122266141">
<node TEXT="return new CustomDefaultTokenEnhancer();" ID="ID_522226192" CREATED="1569864011501" MODIFIED="1569864011501"/>
</node>
<node TEXT="}" ID="ID_1536712645" CREATED="1569864011505" MODIFIED="1569864011505"/>
<node TEXT="@Bean" FOLDED="true" ID="ID_1459175483" CREATED="1569864034911" MODIFIED="1606122266141">
<node TEXT="public JwtAccessTokenConverter tokenEnhancerJwt() {" ID="ID_969930872" CREATED="1569864034912" MODIFIED="1569864034912">
<node TEXT="Resource privateKeyRes = new ClassPathResource(&quot;key/privateKey.txt&quot;);" ID="ID_1079337564" CREATED="1569864034914" MODIFIED="1569864034914"/>
<node TEXT="Resource publicKeyRes = new ClassPathResource(&quot;key/publicKey.txt&quot;);" ID="ID_685735039" CREATED="1569864034915" MODIFIED="1569864034915"/>
<node TEXT="try {" ID="ID_1622355920" CREATED="1569864034916" MODIFIED="1569864034916">
<node TEXT="this.privateKey = new String(IOUtils.toByteArray(privateKeyRes.getInputStream()));" ID="ID_1562843587" CREATED="1569864034916" MODIFIED="1569864034916"/>
<node TEXT="this.publicKey = new String(IOUtils.toByteArray(publicKeyRes.getInputStream()));" ID="ID_447489434" CREATED="1569864034917" MODIFIED="1569864034917"/>
</node>
<node TEXT="} catch (IOException e) {" ID="ID_417574533" CREATED="1569864034918" MODIFIED="1569864034918">
<node TEXT="// TODO Auto-generated catch block" ID="ID_3218663" CREATED="1569864034919" MODIFIED="1569864034919"/>
<node TEXT="e.printStackTrace();" ID="ID_1451741970" CREATED="1569864034919" MODIFIED="1569864034919"/>
</node>
<node TEXT="}" ID="ID_1167817889" CREATED="1569864034920" MODIFIED="1569864034920"/>
<node TEXT="JwtAccessTokenConverter converter = new JwtAccessTokenConverter();" ID="ID_1385504727" CREATED="1569864034921" MODIFIED="1569864034921"/>
<node TEXT="converter.setSigningKey(privateKey);" ID="ID_529756619" CREATED="1569864034921" MODIFIED="1569864034921"/>
<node TEXT="converter.setVerifierKey(publicKey);" ID="ID_1600823873" CREATED="1569864034922" MODIFIED="1569864034922"/>
<node TEXT="return converter;" ID="ID_191736223" CREATED="1569864034923" MODIFIED="1569864034923"/>
</node>
<node TEXT="}" ID="ID_901919608" CREATED="1569864034923" MODIFIED="1569864034923"/>
</node>
<node TEXT="@Override" FOLDED="true" ID="ID_1808129352" CREATED="1569864079313" MODIFIED="1606122266141">
<node TEXT="public void configure(AuthorizationServerEndpointsConfigurer endpoints) throws Exception {" ID="ID_1222695425" CREATED="1569864079315" MODIFIED="1569864079315">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1690483534" CREATED="1569864079316" MODIFIED="1569864079316"/>
<node TEXT="//super.configure(endpoints);" ID="ID_1781989542" CREATED="1569864079317" MODIFIED="1569864079317"/>
<node TEXT="List&lt;TokenEnhancer&gt; tokenEnhancerList = new ArrayList&lt;&gt;();" ID="ID_965066437" CREATED="1569864079318" MODIFIED="1569864079318"/>
<node TEXT="tokenEnhancerList.add(tokenEnhancer());" ID="ID_314838195" CREATED="1569864079319" MODIFIED="1569864079319"/>
<node TEXT="tokenEnhancerList.add(tokenEnhancerJwt());" ID="ID_1838037944" CREATED="1569864079321" MODIFIED="1569864079321"/>
<node TEXT="TokenEnhancerChain enhacerChain = new TokenEnhancerChain();" ID="ID_1909696925" CREATED="1569864079322" MODIFIED="1569864079322"/>
<node TEXT="enhacerChain.setTokenEnhancers(tokenEnhancerList);" ID="ID_1888226688" CREATED="1569864079323" MODIFIED="1569864079323"/>
<node TEXT="endpoints" ID="ID_782821207" CREATED="1569864079324" MODIFIED="1569864079324"/>
<node TEXT=".authenticationManager(authenticationManager)" ID="ID_1625626722" CREATED="1569864079325" MODIFIED="1569864079325"/>
<node TEXT=".tokenStore(tokenStore())" ID="ID_1315569166" CREATED="1569864079326" MODIFIED="1569864079326"/>
<node TEXT=".userDetailsService(userDetailsService)" ID="ID_427204626" CREATED="1569864079327" MODIFIED="1569864079327"/>
<node TEXT=".tokenEnhancer(enhacerChain);" ID="ID_1696874731" CREATED="1569864079328" MODIFIED="1569864079328"/>
</node>
<node TEXT="}" ID="ID_1266506449" CREATED="1569864079329" MODIFIED="1569864079329"/>
</node>
</node>
<node TEXT="여기서 사용하고 있는 CustomDefaultTokenEnhancer 에서 CustomUser를 불러와 추가정보 액세스 토큰에 저장" ID="ID_1008567181" CREATED="1569864110178" MODIFIED="1614153218114">
<node TEXT="package com.framework.Tct.oAuth2;" ID="ID_1959369014" CREATED="1569864368869" MODIFIED="1569864368869"/>
<node TEXT="import java.util.HashMap;" ID="ID_199474048" CREATED="1569864368871" MODIFIED="1569864368871"/>
<node TEXT="import java.util.Map;" ID="ID_1264573644" CREATED="1569864368872" MODIFIED="1569864368872"/>
<node TEXT="import org.springframework.security.oauth2.common.DefaultOAuth2AccessToken;" ID="ID_1780334684" CREATED="1569864368874" MODIFIED="1569864368874"/>
<node TEXT="import org.springframework.security.oauth2.common.OAuth2AccessToken;" ID="ID_1756896124" CREATED="1569864368876" MODIFIED="1569864368876"/>
<node TEXT="import org.springframework.security.oauth2.provider.OAuth2Authentication;" ID="ID_1964476369" CREATED="1569864368877" MODIFIED="1569864368877"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.DefaultAccessTokenConverter;" ID="ID_699442487" CREATED="1569864368879" MODIFIED="1569864368879"/>
<node TEXT="import org.springframework.security.oauth2.provider.token.TokenEnhancer;" ID="ID_1589832491" CREATED="1569864368881" MODIFIED="1569864368881"/>
<node TEXT="public class CustomDefaultTokenEnhancer implements TokenEnhancer {" ID="ID_1991553357" CREATED="1569864368884" MODIFIED="1569864368884">
<node TEXT="@Override" ID="ID_1923077639" CREATED="1569864368886" MODIFIED="1569864368886"/>
<node TEXT="public OAuth2AccessToken enhance(OAuth2AccessToken accessToken, OAuth2Authentication authentication) {" ID="ID_1894913205" CREATED="1569864368888" MODIFIED="1569864368888">
<node TEXT="// TODO Auto-generated method stub" ID="ID_662611180" CREATED="1569864368894" MODIFIED="1569864368894"/>
<node TEXT="CustomUser user = (CustomUser)authentication.getPrincipal();" ID="ID_1780739483" CREATED="1569864368895" MODIFIED="1569864368895"/>
<node TEXT="Map&lt;String,Object&gt; map = new HashMap&lt;String, Object&gt;();" ID="ID_350452978" CREATED="1569864368895" MODIFIED="1569864368895"/>
<node TEXT="map.put(&quot;userId&quot;, user.getUserId());" ID="ID_953150866" CREATED="1569864368896" MODIFIED="1569864368896"/>
<node TEXT="((DefaultOAuth2AccessToken)accessToken).setAdditionalInformation(map);" ID="ID_1299606018" CREATED="1569864368897" MODIFIED="1569864368897"/>
<node TEXT="return accessToken;" ID="ID_1627216349" CREATED="1569864368898" MODIFIED="1569864368898"/>
</node>
<node TEXT="}" ID="ID_1556010773" CREATED="1569864368899" MODIFIED="1569864368899"/>
</node>
<node TEXT="}" ID="ID_448817713" CREATED="1569864368899" MODIFIED="1569864368899"/>
</node>
<node TEXT="설명" ID="ID_1406976655" CREATED="1569864090538" MODIFIED="1606122268151">
<node TEXT="여기서 tokenEnhancer 를 두가지 이용하는데 하나는 말 그대로 토큰에 정보를 추가하는 enhancer가 맞지만, 다른 하나는 Converter 그러니까 토큰 액세스 변형하는 JwtConverter이다. 중요한건 이 converter가 enhancer도 구현하고 있기 때문에 enhancer로 취급해도 된다." ID="ID_1352918630" CREATED="1569864898692" MODIFIED="1569865198112"/>
<node TEXT="그래서 두개의 enhacer를 list로 연결하여 chain에 등록하여, tokenEnhancer에 세팅한다." ID="ID_624820831" CREATED="1569865120316" MODIFIED="1569865148696"/>
<node TEXT="여기서 CustomDefaultTokenEnhancer 에서 user정보를 athentication으로 불러와 업케스팅 하여 액세스 토큰에 세팅한다." ID="ID_1873586772" CREATED="1569865159100" MODIFIED="1569865372009"/>
</node>
<node TEXT="변형된 토큰에 추가된 userId정보(이미지)" FOLDED="true" ID="ID_335254630" CREATED="1569865375045" MODIFIED="1606122270277">
<node ID="ID_1176154925" CREATED="1569866058685" MODIFIED="1569866058685"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_4925137280255075880.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="10.ResourceServerAdapter  이용" FOLDED="true" ID="ID_1467899237" CREATED="1571801658533" MODIFIED="1606122059390" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="ResourceServer를 가동하면, 기존의 WebSecurityConfigurerAdapter가 작동하지 않는다." ID="ID_65761099" CREATED="1571802201242" MODIFIED="1571802227220"/>
<node TEXT="ResourceServerConfigurerAdapter를 상속하여 여기에 대한 문지기를 설정해야 한다." ID="ID_1047215178" CREATED="1571802242257" MODIFIED="1571802258053"/>
<node TEXT="코드" ID="ID_542822328" CREATED="1571802259152" MODIFIED="1571802259741">
<node TEXT="package com.theComments.brt.config;" ID="ID_543424392" CREATED="1571802275671" MODIFIED="1571802275671"/>
<node TEXT="import org.springframework.context.annotation.Configuration;" ID="ID_1642480752" CREATED="1571802275672" MODIFIED="1571802275672"/>
<node TEXT="import org.springframework.security.config.annotation.web.builders.HttpSecurity;" ID="ID_43030458" CREATED="1571802275672" MODIFIED="1571802275672"/>
<node TEXT="import org.springframework.security.oauth2.config.annotation.web.configuration.EnableResourceServer;" ID="ID_1166490503" CREATED="1571802275673" MODIFIED="1571802275673"/>
<node TEXT="import org.springframework.security.oauth2.config.annotation.web.configuration.ResourceServerConfigurerAdapter;" ID="ID_1198527391" CREATED="1571802275674" MODIFIED="1571802275674"/>
<node TEXT="import com.theComments.brt.constFile.AuthUser;" ID="ID_1074579501" CREATED="1571802275678" MODIFIED="1571802275678"/>
<node TEXT="@Configuration" ID="ID_23869334" CREATED="1571802275679" MODIFIED="1571802275679"/>
<node TEXT="@EnableResourceServer" ID="ID_1782379595" CREATED="1571802275680" MODIFIED="1571802275680"/>
<node TEXT="public class Oauth2ResourceServer extends ResourceServerConfigurerAdapter {" FOLDED="true" ID="ID_22973528" CREATED="1571802275680" MODIFIED="1571802276862">
<node TEXT="private String [] resouseMatch = {" ID="ID_41789836" CREATED="1571802275681" MODIFIED="1571802275681">
<node TEXT="&quot;/&quot;," ID="ID_1965997013" CREATED="1571802275682" MODIFIED="1571802275682"/>
<node TEXT="&quot;/*.js&quot;," ID="ID_1282464136" CREATED="1571802275682" MODIFIED="1571802275682"/>
<node TEXT="&quot;/*.css&quot;," ID="ID_1559378325" CREATED="1571802275685" MODIFIED="1571802275685"/>
<node TEXT="&quot;/assets/**&quot;," ID="ID_441897387" CREATED="1571802275686" MODIFIED="1571802275686"/>
<node TEXT="&quot;/favicon.ico&quot;" ID="ID_330843555" CREATED="1571802275687" MODIFIED="1571802275687"/>
</node>
<node TEXT="};" ID="ID_1981849823" CREATED="1571802275687" MODIFIED="1571802275687"/>
<node TEXT="private String [] restController = {" ID="ID_306257265" CREATED="1571802275688" MODIFIED="1571802275688">
<node TEXT="&quot;/v1/member_public/**&quot;," ID="ID_1471078002" CREATED="1571802275689" MODIFIED="1571802275689"/>
<node TEXT="&quot;/test/**&quot;" ID="ID_201191533" CREATED="1571802275690" MODIFIED="1571802275690"/>
</node>
<node TEXT="};" ID="ID_954775682" CREATED="1571802275690" MODIFIED="1571802275690"/>
<node TEXT="private String [] publicController = {" ID="ID_1127196471" CREATED="1571802275691" MODIFIED="1571802275691">
<node TEXT="&quot;/member/join&quot;" ID="ID_105327558" CREATED="1571802275692" MODIFIED="1571802275692"/>
</node>
<node TEXT="};" ID="ID_912063419" CREATED="1571802275693" MODIFIED="1571802275693"/>
<node TEXT="private String [] common_user_auth = {" ID="ID_1460834505" CREATED="1571802275693" MODIFIED="1571802275693">
<node TEXT="&quot;/v1/type/**&quot;" ID="ID_359728482" CREATED="1571802275694" MODIFIED="1571802275694"/>
</node>
<node TEXT="};" ID="ID_889979242" CREATED="1571802275695" MODIFIED="1571802275695"/>
<node TEXT="@Override" ID="ID_950730478" CREATED="1571802275695" MODIFIED="1571802275695"/>
<node TEXT="public void configure(HttpSecurity http) throws Exception {" ID="ID_1999954168" CREATED="1571802275696" MODIFIED="1571802275696">
<node TEXT="// TODO Auto-generated method stub" ID="ID_659475071" CREATED="1571802275697" MODIFIED="1571802275697"/>
</node>
</node>
<node TEXT="//                super.configure(http);" ID="ID_1511853352" CREATED="1571802275697" MODIFIED="1571877440986">
<node TEXT="//Role 지워야 함" ID="ID_1614606849" CREATED="1571802275699" MODIFIED="1571802275699"/>
<node TEXT="String common_user = AuthUser.USER_AUTHORITY.COMMON_USER.split(&quot;ROLE_&quot;)[1];" ID="ID_708118008" CREATED="1571802275700" MODIFIED="1571802275700"/>
<node TEXT="http.authorizeRequests()" ID="ID_134306942" CREATED="1571802275700" MODIFIED="1571802275700"/>
<node TEXT=".antMatchers(resouseMatch).permitAll()" ID="ID_775489113" CREATED="1571802275701" MODIFIED="1571802275701"/>
<node TEXT=".antMatchers(restController).permitAll()" ID="ID_1599850305" CREATED="1571802275701" MODIFIED="1571802275701"/>
<node TEXT=".antMatchers(publicController).permitAll()" ID="ID_890757313" CREATED="1571802275701" MODIFIED="1571802275701"/>
<node TEXT=".antMatchers(common_user_auth).hasRole(common_user);" ID="ID_73230172" CREATED="1571802275702" MODIFIED="1571802275702"/>
<node TEXT="}" ID="ID_377027317" CREATED="1571802275702" MODIFIED="1571802275702"/>
</node>
<node TEXT="}" ID="ID_1868116913" CREATED="1571802275702" MODIFIED="1571802275702"/>
</node>
<node TEXT="여기서는 has_role을 사용했는데, 이 메소드는 기본적으로 ROLE_를 생략해야 한다." ID="ID_1376241027" CREATED="1571877446150" MODIFIED="1571877461472"/>
<node TEXT="그래서 ROLE_를 지웠다." ID="ID_190954512" CREATED="1571877462756" MODIFIED="1571877470244" LINK="#ID_708118008"/>
</node>
</node>
<node TEXT="JDBC 오류" FOLDED="true" POSITION="right" ID="ID_1289431196" CREATED="1569321838984" MODIFIED="1621472968362">
<node TEXT="Failed to determine a suitable driver class " ID="ID_437120369" CREATED="1569321843353" MODIFIED="1569321851842" LINK="#ID_1068000342"/>
</node>
<node TEXT="하이버네이트(jpa)" FOLDED="true" POSITION="right" ID="ID_1310219766" CREATED="1569954720531" MODIFIED="1621472968362" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="jpa 설정" FOLDED="true" ID="ID_1705942387" CREATED="1602136650114" MODIFIED="1605443172019">
<node TEXT="https://www.baeldung.com/the-persistence-layer-with-spring-and-jpa" ID="ID_1728261160" CREATED="1602136655177" MODIFIED="1602136655177" LINK="https://www.baeldung.com/the-persistence-layer-with-spring-and-jpa"/>
<node TEXT="https://docs.jboss.org/hibernate/orm/5.2/userguide/html_single/Hibernate_User_Guide.html#configurations-hbmddl" ID="ID_579231935" CREATED="1602137887013" MODIFIED="1602137887013" LINK="https://docs.jboss.org/hibernate/orm/5.2/userguide/html_single/Hibernate_User_Guide.html#configurations-hbmddl"/>
</node>
<node TEXT="https://www.baeldung.com/spring-data-jpa-multiple-databases" ID="ID_1098857026" CREATED="1570118271397" MODIFIED="1571694519760" LINK="https://www.baeldung.com/spring-data-jpa-multiple-databases"/>
<node TEXT="select 조건문" FOLDED="true" ID="ID_977131534" CREATED="1570132753122" MODIFIED="1605443172019">
<node TEXT="https://www.petrikainulainen.net/programming/spring-framework/spring-data-jpa-tutorial-introduction-to-query-methods/" ID="ID_263076276" CREATED="1570132709848" MODIFIED="1571694519761" LINK="https://www.petrikainulainen.net/programming/spring-framework/spring-data-jpa-tutorial-introduction-to-query-methods/"/>
<node TEXT="https://www.baeldung.com/jpa-join-types" ID="ID_1135334450" CREATED="1570146978432" MODIFIED="1571694519764" LINK="https://www.baeldung.com/jpa-join-types"/>
</node>
<node TEXT="fechType" FOLDED="true" ID="ID_1399637032" CREATED="1570395906141" MODIFIED="1605443172019">
<node TEXT="개념" ID="ID_156686172" CREATED="1570395914157" MODIFIED="1583111275550">
<node TEXT="https://www.baeldung.com/jpa-join-types" ID="ID_66838895" CREATED="1570396150241" MODIFIED="1570396150241" LINK="https://www.baeldung.com/jpa-join-types"/>
<node TEXT="두가지가 있다." ID="ID_1917710412" CREATED="1570396209803" MODIFIED="1583111276889">
<node TEXT="Eager" FOLDED="true" ID="ID_1657050966" CREATED="1570396535238" MODIFIED="1583111278410">
<node TEXT="처음 데이터를 불러올 때 외래키로 연결된 정보를 다 불러갖고 온다." ID="ID_81456367" CREATED="1570396607204" MODIFIED="1570396754840"/>
<node TEXT="그러니까 쿼리를 졸라게 많이 한다는 것이다." ID="ID_1383107079" CREATED="1570396654036" MODIFIED="1570396660655"/>
<node TEXT="이건 성능 하락의 문제가 생길 수 있다." ID="ID_1597348987" CREATED="1570396660796" MODIFIED="1570396668327"/>
</node>
<node TEXT="Lazy" FOLDED="true" ID="ID_431531930" CREATED="1570396539924" MODIFIED="1583111278411">
<node TEXT="처음 데이터를 불러올 때 외래키로 연결된 정보를 안가지고 온다." ID="ID_1290369929" CREATED="1570396716380" MODIFIED="1570396772527"/>
<node TEXT="https://stackoverflow.com/a/11754441" ID="ID_771123849" CREATED="1570410464884" MODIFIED="1570410464884" LINK="https://stackoverflow.com/a/11754441"/>
<node TEXT="join을 해도 안가지고오고, 오로지 JOIN FETCH를 해야지만 들고온다." ID="ID_26069361" CREATED="1570410466275" MODIFIED="1570410483807"/>
<node TEXT="get으로 가져오는건 잘 안된다." ID="ID_788636855" CREATED="1570410487282" MODIFIED="1570410499879"/>
</node>
<node TEXT="디폴트 값" FOLDED="true" ID="ID_1299789073" CREATED="1570396623836" MODIFIED="1583111278411">
<node TEXT="To One 일 떄는 Eager" ID="ID_449098869" CREATED="1570396625588" MODIFIED="1570396636231"/>
<node TEXT="To Many 일 때는 Lazy" ID="ID_1931274780" CREATED="1570396636876" MODIFIED="1570396647663"/>
</node>
</node>
</node>
<node TEXT="어떻게 하는가?" ID="ID_1279543763" CREATED="1570395926604" MODIFIED="1583111280882">
<node TEXT="https://www.youtube.com/watch?v=Zs8Dse_Mpyk" ID="ID_1045552211" CREATED="1570395947463" MODIFIED="1570395948135" LINK="https://www.youtube.com/watch?v=Zs8Dse_Mpyk"/>
<node TEXT="그냥 필요 있는 정보만 불러온다." ID="ID_997639178" CREATED="1570395929891" MODIFIED="1570395938295"/>
<node TEXT="조인을 명시적으로 하여 불러온다는 것이다." ID="ID_124777700" CREATED="1570395949140" MODIFIED="1570396828216"/>
</node>
</node>
<node TEXT="fetch inner join (코드)" FOLDED="true" ID="ID_1561153760" CREATED="1572313369339" MODIFIED="1611911536531">
<node TEXT="SELECT a FROM Artist a JOIN FETCH a.create c" ID="ID_987460043" CREATED="1572313382716" MODIFIED="1572313382716"/>
<node TEXT="여기서 그냥 JOIN 하면 값을 안가져옴" ID="ID_905347401" CREATED="1572313390089" MODIFIED="1572313405110"/>
</node>
<node TEXT="emtityManagerFactory 따로 불러오기" FOLDED="true" ID="ID_331811455" CREATED="1570134149228" MODIFIED="1605443172019">
<node TEXT="https://okky.kr/article/306418" ID="ID_951237667" CREATED="1570134174494" MODIFIED="1570134176036" LINK="https://okky.kr/article/306418"/>
<node TEXT="@Bean" ID="ID_109475766" CREATED="1570134163776" MODIFIED="1570134163776"/>
<node TEXT="@Qualifier(&quot;emFac1&quot;)" ID="ID_763116840" CREATED="1570134163778" MODIFIED="1570134163778"/>
<node TEXT="public EntityManagerFactory getEntityManager() {" ID="ID_528232774" CREATED="1570134163779" MODIFIED="1570134163779">
<node TEXT="return userEntityManager().getObject();" ID="ID_1629787502" CREATED="1570134163781" MODIFIED="1570134163781"/>
</node>
<node TEXT="}" ID="ID_1314484621" CREATED="1570134163784" MODIFIED="1570134163784"/>
</node>
<node TEXT="하이버네이션에서 inner join" FOLDED="true" ID="ID_241488010" CREATED="1570134766023" MODIFIED="1605443172019">
<node TEXT="https://www.logicbig.com/tutorials/java-ee-tutorial/jpa/jpql-inner-join.html" ID="ID_1539310167" CREATED="1570134775592" MODIFIED="1570134775592" LINK="https://www.logicbig.com/tutorials/java-ee-tutorial/jpa/jpql-inner-join.html"/>
</node>
<node TEXT="foreign key(외래키)(이미지)" FOLDED="true" ID="ID_1382268009" CREATED="1570135058320" MODIFIED="1605443172019">
<node ID="ID_1319142346" CREATED="1570135109979" MODIFIED="1570135109979"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_165376303784384702.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="manytomany 동사 테이블" FOLDED="true" ID="ID_1216395012" CREATED="1570136286969" MODIFIED="1605443172019">
<node TEXT="https://www.baeldung.com/jpa-many-to-many" ID="ID_485248602" CREATED="1570136322966" MODIFIED="1570136322966" LINK="https://www.baeldung.com/jpa-many-to-many"/>
</node>
<node TEXT="hbm2ddl.auto에 대하여" FOLDED="true" ID="ID_293990608" CREATED="1570140550929" MODIFIED="1605443172019">
<node TEXT="https://www.onlinetutorialspoint.com/hibernate/hbm2ddl-auto-example-hibernate-xml-config.html" ID="ID_1106298599" CREATED="1570140544833" MODIFIED="1570140544833" LINK="https://www.onlinetutorialspoint.com/hibernate/hbm2ddl-auto-example-hibernate-xml-config.html"/>
</node>
<node TEXT="콘솔에 sql 과정과 결과 뜨게 하기" FOLDED="true" ID="ID_1963169176" CREATED="1570140566602" MODIFIED="1605443172019">
<node TEXT="https://www.popit.kr/%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B6%80%ED%8A%B8-auto-configuration%EA%B3%BC-jpa%ED%95%98%EC%9D%B4%EB%B2%84%EB%84%A4%EC%9D%B4%ED%8A%B8-sql%EB%AC%B8-%EB%A1%9C%EA%B9%85/" ID="ID_155807835" CREATED="1570141461261" MODIFIED="1570141461261" LINK="https://www.popit.kr/%EC%8A%A4%ED%94%84%EB%A7%81-%EB%B6%80%ED%8A%B8-auto-configuration%EA%B3%BC-jpa%ED%95%98%EC%9D%B4%EB%B2%84%EB%84%A4%EC%9D%B4%ED%8A%B8-sql%EB%AC%B8-%EB%A1%9C%EA%B9%85/"/>
</node>
<node TEXT="jpa 페이지네이션" FOLDED="true" ID="ID_668810708" CREATED="1570142505951" MODIFIED="1616567048818">
<node TEXT="https://www.baeldung.com/spring-data-jpa-pagination-sorting" ID="ID_1551741864" CREATED="1570149645253" MODIFIED="1571694519766" LINK="https://www.baeldung.com/spring-data-jpa-pagination-sorting"/>
<node TEXT="https://stackoverflow.com/questions/23136469/order-by-count-using-spring-data-jparepository" ID="ID_785756353" CREATED="1570142511971" MODIFIED="1571694519767" LINK="https://stackoverflow.com/questions/23136469/order-by-count-using-spring-data-jparepository"/>
<node TEXT="기초" ID="ID_110757357" CREATED="1571759843723" MODIFIED="1571759844925">
<node TEXT="pageable설정" ID="ID_540476330" CREATED="1571759848384" MODIFIED="1571759852789"/>
<node TEXT="https://stackoverflow.com/questions/21923897/limiting-resultset-using-query-anotations/21926544#21926544" ID="ID_1282188796" CREATED="1571759845363" MODIFIED="1571759845363" LINK="https://stackoverflow.com/questions/21923897/limiting-resultset-using-query-anotations/21926544#21926544"/>
</node>
<node TEXT="코드" ID="ID_590237233" CREATED="1571804517670" MODIFIED="1571804518561">
<node TEXT="public interface Type2_dao extends JpaRepository&lt;Type2, Long&gt; {" ID="ID_1902397208" CREATED="1571804909546" MODIFIED="1572152422993">
<node TEXT="@Query(" ID="ID_1138338234" CREATED="1571804909549" MODIFIED="1571804909549">
<node TEXT="value = &quot;select t2 FROM Type2 t2 &quot;" ID="ID_922369142" CREATED="1571804909552" MODIFIED="1571804909552">
<node TEXT="+ &quot;ORDER BY t2.type2_name DESC&quot;," ID="ID_1060428768" CREATED="1571804909554" MODIFIED="1571804909554"/>
</node>
<node TEXT="countQuery = &quot;select count(t2) FROM Type2 t2&quot;" ID="ID_838335674" CREATED="1571804909556" MODIFIED="1571804909556"/>
<node TEXT=")" ID="ID_1430502894" CREATED="1571804909558" MODIFIED="1571804909558"/>
</node>
<node TEXT="Page&lt;Type2&gt; selectType2OrderByName(Pageable pageable);" ID="ID_311901612" CREATED="1571804909561" MODIFIED="1571804909561"/>
</node>
<node TEXT="}" ID="ID_1649408386" CREATED="1571804909563" MODIFIED="1571804909563"/>
</node>
</node>
<node TEXT="ManyToMany에서 주어 부문에서 사용하는 Set 정리" FOLDED="true" ID="ID_1921398831" CREATED="1570382601549" MODIFIED="1605443172019">
<node TEXT="https://stackoverflow.com/questions/1035008/what-is-the-difference-between-set-and-list" ID="ID_1236691051" CREATED="1570382638158" MODIFIED="1570382638158" LINK="https://stackoverflow.com/questions/1035008/what-is-the-difference-between-set-and-list"/>
<node TEXT="set과 list의 차이점(이미지)" ID="ID_1867481301" CREATED="1570382645164" MODIFIED="1570544057462">
<node ID="ID_554313870" CREATED="1570382676478" MODIFIED="1570382676478"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_8865931172472596015.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="읽을거리" FOLDED="true" ID="ID_687925263" CREATED="1570387036030" MODIFIED="1605443172020">
<node TEXT="oneToMany는 양방향 설정해줘야함" ID="ID_975731217" CREATED="1570387040271" MODIFIED="1570387047602">
<node TEXT="https://velog.io/@dpudpu/5" ID="ID_835552256" CREATED="1570387048023" MODIFIED="1570387048023" LINK="https://velog.io/@dpudpu/5"/>
</node>
<node TEXT="mappedBy가 무엇인가?" ID="ID_256733425" CREATED="1570387397223" MODIFIED="1570387403018">
<node TEXT="https://www.baeldung.com/jpa-joincolumn-vs-mappedby" ID="ID_784334841" CREATED="1570387403329" MODIFIED="1570387403329" LINK="https://www.baeldung.com/jpa-joincolumn-vs-mappedby"/>
</node>
</node>
<node TEXT="dynamic Query" FOLDED="true" ID="ID_429853285" CREATED="1572380138007" MODIFIED="1620905279262" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://www.baeldung.com/spring-data-jpa-query" ID="ID_1497990452" CREATED="1572380146782" MODIFIED="1572380151328" LINK="https://www.baeldung.com/spring-data-jpa-query"/>
<node TEXT="criteria query시에 join 할 때 example 2를 참조하도록 하라" ID="ID_1446360692" CREATED="1572507672659" MODIFIED="1572507731464" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="https://www.programcreek.com/java-api-examples/?api=javax.persistence.criteria.Join" ID="ID_1951382040" CREATED="1572507655858" MODIFIED="1572507655858" LINK="https://www.programcreek.com/java-api-examples/?api=javax.persistence.criteria.Join"/>
<node TEXT="criteria query시에 pagination 설정(4번 참고)" ID="ID_242008061" CREATED="1572509394497" MODIFIED="1572509451705" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="https://www.baeldung.com/jpa-pagination" ID="ID_998192109" CREATED="1572509408288" MODIFIED="1572509408288" LINK="https://www.baeldung.com/jpa-pagination"/>
<node TEXT="여기서 totalCount는 Long으로 담아야 됨. 그렇지 않으면 담아지지도 않음" ID="ID_67332575" CREATED="1572513139090" MODIFIED="1572513150720"/>
<node TEXT="코드" ID="ID_926907536" CREATED="1572584702485" MODIFIED="1572584703417">
<node TEXT="package com.theComments.brt.jpa.theComment.dao;" ID="ID_641759408" CREATED="1572584703677" MODIFIED="1572584703677"/>
<node TEXT="import java.util.ArrayList;" ID="ID_1387977646" CREATED="1572584703680" MODIFIED="1572584703680"/>
<node TEXT="import java.util.List;" ID="ID_509047385" CREATED="1572584703680" MODIFIED="1572584703680"/>
<node TEXT="import javax.persistence.EntityManager;" ID="ID_1380298273" CREATED="1572584703681" MODIFIED="1572584703681"/>
<node TEXT="import javax.persistence.EntityManagerFactory;" ID="ID_1363001504" CREATED="1572584703682" MODIFIED="1572584703682"/>
<node TEXT="import javax.persistence.TypedQuery;" ID="ID_1624876924" CREATED="1572584703683" MODIFIED="1572584703683"/>
<node TEXT="import javax.persistence.criteria.CriteriaBuilder;" ID="ID_1391137155" CREATED="1572584703684" MODIFIED="1572584703684"/>
<node TEXT="import javax.persistence.criteria.CriteriaQuery;" ID="ID_978449099" CREATED="1572584703685" MODIFIED="1572584703685"/>
<node TEXT="import javax.persistence.criteria.Join;" ID="ID_867164400" CREATED="1572584703686" MODIFIED="1572584703686"/>
<node TEXT="import javax.persistence.criteria.JoinType;" ID="ID_1850720898" CREATED="1572584703687" MODIFIED="1572584703687"/>
<node TEXT="import javax.persistence.criteria.Predicate;" ID="ID_498927149" CREATED="1572584703688" MODIFIED="1572584703688"/>
<node TEXT="import javax.persistence.criteria.Root;" ID="ID_190620979" CREATED="1572584703690" MODIFIED="1572584703690"/>
<node TEXT="import org.springframework.beans.BeanUtils;" ID="ID_312149657" CREATED="1572584703692" MODIFIED="1572584703692"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_1599464298" CREATED="1572584703693" MODIFIED="1572584703693"/>
<node TEXT="import org.springframework.beans.factory.annotation.Qualifier;" ID="ID_409003468" CREATED="1572584703694" MODIFIED="1572584703694"/>
<node TEXT="import org.springframework.stereotype.Component;" ID="ID_1382665564" CREATED="1572584703694" MODIFIED="1572584703694"/>
<node TEXT="import com.theComments.brt.constFile.PageConst.PAGE;" ID="ID_1344181818" CREATED="1572584703695" MODIFIED="1572584703695"/>
<node TEXT="import com.theComments.brt.jpa.dto.Type1Dto;" ID="ID_1470424808" CREATED="1572584703696" MODIFIED="1572584703696"/>
<node TEXT="import com.theComments.brt.jpa.dto.Type2Dto;" ID="ID_1741638427" CREATED="1572584703697" MODIFIED="1572584703697"/>
<node TEXT="import com.theComments.brt.jpa.dto.WorksDto;" ID="ID_391595079" CREATED="1572584703698" MODIFIED="1572584703698"/>
<node TEXT="import com.theComments.brt.jpa.theComment.model.Type1;" ID="ID_735818552" CREATED="1572584703699" MODIFIED="1572584703699"/>
<node TEXT="import com.theComments.brt.jpa.theComment.model.Type2;" ID="ID_227664030" CREATED="1572584703700" MODIFIED="1572584703700"/>
<node TEXT="import com.theComments.brt.jpa.theComment.model.Works;" ID="ID_1431957400" CREATED="1572584703701" MODIFIED="1572584703701"/>
<node TEXT="import com.theComments.brt.util.ResultMap;" ID="ID_307552471" CREATED="1572584703702" MODIFIED="1572584703702"/>
<node TEXT="@Component" ID="ID_603704805" CREATED="1572584703703" MODIFIED="1572584703703"/>
<node TEXT="public class DynamicQueryDao {" FOLDED="true" ID="ID_1182796062" CREATED="1572584703704" MODIFIED="1602652729877">
<node TEXT="@Autowired" ID="ID_196159245" CREATED="1572584703704" MODIFIED="1572584703704"/>
<node TEXT="@Qualifier(&quot;emFac1&quot;)" ID="ID_1272447542" CREATED="1572584703706" MODIFIED="1572584703706"/>
<node TEXT="EntityManagerFactory entityManagerFactory;" ID="ID_903287428" CREATED="1572584703706" MODIFIED="1572584703706"/>
<node TEXT="public ResultMap SelectWorksDynamic(WorksDto worksDto, Type2Dto type2, Type1Dto type1) {" ID="ID_212257584" CREATED="1572584703707" MODIFIED="1572584703707">
<node TEXT="EntityManager em = entityManagerFactory.createEntityManager();" ID="ID_902972037" CREATED="1572584703708" MODIFIED="1572584703708"/>
<node TEXT="CriteriaBuilder cb = em.getCriteriaBuilder();" ID="ID_1407373771" CREATED="1572584703709" MODIFIED="1572584703709"/>
<node TEXT="CriteriaQuery&lt;Works&gt; cq = cb.createQuery(Works.class);" ID="ID_1060184931" CREATED="1572584703710" MODIFIED="1572584703710"/>
<node TEXT="Root&lt;Works&gt; worksRoot = cq.from(Works.class);" ID="ID_695552961" CREATED="1572584703711" MODIFIED="1572584703711"/>
<node TEXT="Join&lt;Works, Type2&gt; type2Root = worksRoot.join(&quot;type2&quot;, JoinType.INNER);" ID="ID_1351595402" CREATED="1572584703711" MODIFIED="1572584703711"/>
<node TEXT="Join&lt;Type2, Type1&gt; type1Root = type2Root.join(&quot;type1&quot;, JoinType.INNER);" ID="ID_579388675" CREATED="1572584703712" MODIFIED="1572584703712"/>
<node TEXT="Long type1_id = type1.getType1_id();" ID="ID_1880551736" CREATED="1572584703712" MODIFIED="1572584703712"/>
<node TEXT="Long type2_id = type2.getType2_id();" ID="ID_271708605" CREATED="1572584703712" MODIFIED="1572584703712"/>
<node TEXT="List&lt;Predicate&gt; predicate_list = new ArrayList&lt;Predicate&gt;();" ID="ID_76214480" CREATED="1572584703713" MODIFIED="1572584703713"/>
<node TEXT="if (type1_id != 0) {" ID="ID_1046886280" CREATED="1572584703714" MODIFIED="1572584703714">
<node TEXT="Predicate type1Pre = cb.equal(type1Root.get(&quot;type1_id&quot;), type1_id);" ID="ID_1329755351" CREATED="1572584703714" MODIFIED="1572584703714"/>
<node TEXT="predicate_list.add(type1Pre);" ID="ID_121352809" CREATED="1572584703715" MODIFIED="1572584703715"/>
</node>
<node TEXT="}" ID="ID_1011046219" CREATED="1572584703716" MODIFIED="1572584703716"/>
<node TEXT="if (type2_id != 0) {" ID="ID_997450877" CREATED="1572584703716" MODIFIED="1572584703716">
<node TEXT="Predicate type2Pre = cb.equal(type2Root.get(&quot;type2_id&quot;), type2_id);" ID="ID_1912318387" CREATED="1572584703717" MODIFIED="1572584703717"/>
<node TEXT="predicate_list.add(type2Pre);" ID="ID_1513143372" CREATED="1572584703718" MODIFIED="1572584703718"/>
</node>
<node TEXT="}" ID="ID_1518894318" CREATED="1572584703719" MODIFIED="1572584703719"/>
<node TEXT="StringBuffer searchTextBuffer = new StringBuffer().append(&quot;%&quot;).append(worksDto.getSearchText()).append(&quot;%&quot;);" ID="ID_1503733761" CREATED="1572584703719" MODIFIED="1572584703719"/>
<node TEXT="Predicate worksSubjectPre = cb.like(worksRoot.get(&quot;subject&quot;), searchTextBuffer.toString());" ID="ID_455677529" CREATED="1572584703723" MODIFIED="1572584703723"/>
<node TEXT="predicate_list.add(worksSubjectPre);" ID="ID_971106840" CREATED="1572584703724" MODIFIED="1572584703724"/>
<node TEXT="Predicate[] predicate_array = new Predicate[predicate_list.size()];" ID="ID_980989213" CREATED="1572584703725" MODIFIED="1572584703725"/>
<node TEXT="predicate_array = predicate_list.toArray(predicate_array);" ID="ID_1642902663" CREATED="1572584703727" MODIFIED="1572584703727"/>
<node TEXT="TypedQuery&lt;Works&gt; typeQuery = em.createQuery(cq.select(worksRoot).where(predicate_array));" ID="ID_119699205" CREATED="1572584703728" MODIFIED="1572584703728"/>
<node TEXT="typeQuery.setFirstResult(worksDto.getPageNum() - 1);" ID="ID_1414129786" CREATED="1572584703729" MODIFIED="1572584703729"/>
<node TEXT="typeQuery.setMaxResults(PAGE.PAGE_SIZE);" ID="ID_1345452458" CREATED="1572584703729" MODIFIED="1572584703729"/>
<node TEXT="Long totalCount = this.selectWorksDynamicTotalCount(worksDto, type2, type1,em);" ID="ID_1830678576" CREATED="1572584703731" MODIFIED="1572584703731"/>
<node TEXT="List&lt;Works&gt; works_list = typeQuery.getResultList();" ID="ID_288251714" CREATED="1572584703731" MODIFIED="1572584703731"/>
<node TEXT="List&lt;WorksDto&gt; worksDtoList = new ArrayList&lt;WorksDto&gt;();" ID="ID_1798974101" CREATED="1572584703732" MODIFIED="1572584703732"/>
<node TEXT="for (Works work : works_list) {" ID="ID_855642362" CREATED="1572584703732" MODIFIED="1572584703732">
<node TEXT="WorksDto dto = new WorksDto();" ID="ID_1706943063" CREATED="1572584703732" MODIFIED="1572584703732"/>
<node TEXT="BeanUtils.copyProperties(work, dto);" ID="ID_1349131388" CREATED="1572584703733" MODIFIED="1572584703733"/>
<node TEXT="worksDtoList.add(dto);" ID="ID_615297591" CREATED="1572584703733" MODIFIED="1572584703733"/>
</node>
<node TEXT="}" ID="ID_458613767" CREATED="1572584703734" MODIFIED="1572584703734"/>
<node TEXT="ResultMap result = new ResultMap();" ID="ID_1639693822" CREATED="1572584703734" MODIFIED="1572584703734"/>
<node TEXT="result.setData(worksDtoList);" ID="ID_55477578" CREATED="1572584703735" MODIFIED="1572584703735"/>
<node TEXT="result.setTotalSize(totalCount);" ID="ID_1611114976" CREATED="1572584703735" MODIFIED="1572584703735"/>
<node TEXT="em.close();" ID="ID_1591307701" CREATED="1572584703735" MODIFIED="1572584703735"/>
<node TEXT="return result;" ID="ID_1507635583" CREATED="1572584703736" MODIFIED="1572584703736"/>
</node>
<node TEXT="}" ID="ID_563073239" CREATED="1572584703736" MODIFIED="1572584703736"/>
<node TEXT="private Long selectWorksDynamicTotalCount(WorksDto worksDto, Type2Dto type2, Type1Dto type1,EntityManager em) {" ID="ID_663106511" CREATED="1572584703737" MODIFIED="1572584703737">
<node TEXT="// TODO Auto-generated method stub" ID="ID_101737467" CREATED="1572584703739" MODIFIED="1572584703739"/>
<node TEXT="//EntityManager em = entityManagerFactory.createEntityManager();" ID="ID_1628069458" CREATED="1572584703740" MODIFIED="1572584703740"/>
<node TEXT="CriteriaBuilder cb = em.getCriteriaBuilder();" ID="ID_1731998451" CREATED="1572584703741" MODIFIED="1572584703741"/>
<node TEXT="CriteriaQuery&lt;Long&gt; cq = cb.createQuery(Long.class);" ID="ID_240889934" CREATED="1572584703741" MODIFIED="1572584703741"/>
<node TEXT="Root&lt;Works&gt; worksRoot = cq.from(Works.class);" ID="ID_1236284901" CREATED="1572584703742" MODIFIED="1572584703742"/>
<node TEXT="Join&lt;Works, Type2&gt; type2Root = worksRoot.join(&quot;type2&quot;, JoinType.INNER);" ID="ID_1457291504" CREATED="1572584703743" MODIFIED="1572584703743"/>
<node TEXT="Join&lt;Type2, Type1&gt; type1Root = type2Root.join(&quot;type1&quot;, JoinType.INNER);" ID="ID_1416555216" CREATED="1572584703743" MODIFIED="1572584703743"/>
<node TEXT="Long type1_id = type1.getType1_id();" ID="ID_1403310730" CREATED="1572584703744" MODIFIED="1572584703744"/>
<node TEXT="Long type2_id = type2.getType2_id();" ID="ID_173276547" CREATED="1572584703744" MODIFIED="1572584703744"/>
<node TEXT="List&lt;Predicate&gt; predicate_list = new ArrayList&lt;Predicate&gt;();" ID="ID_1251205436" CREATED="1572584703745" MODIFIED="1572584703745"/>
<node TEXT="if (type1_id != 0) {" ID="ID_1303458730" CREATED="1572584703746" MODIFIED="1572584703746">
<node TEXT="Predicate type1Pre = cb.equal(type1Root.get(&quot;type1_id&quot;), type1_id);" ID="ID_390859870" CREATED="1572584703746" MODIFIED="1572584703746"/>
<node TEXT="predicate_list.add(type1Pre);" ID="ID_1582878625" CREATED="1572584703747" MODIFIED="1572584703747"/>
</node>
<node TEXT="}" ID="ID_300836480" CREATED="1572584703748" MODIFIED="1572584703748"/>
<node TEXT="if (type2_id != 0) {" ID="ID_580282625" CREATED="1572584703748" MODIFIED="1572584703748">
<node TEXT="Predicate type2Pre = cb.equal(type2Root.get(&quot;type2_id&quot;), type2_id);" ID="ID_188480361" CREATED="1572584703749" MODIFIED="1572584703749"/>
<node TEXT="predicate_list.add(type2Pre);" ID="ID_384232354" CREATED="1572584703750" MODIFIED="1572584703750"/>
</node>
<node TEXT="}" ID="ID_635722161" CREATED="1572584703751" MODIFIED="1572584703751"/>
<node TEXT="StringBuffer searchTextBuffer = new StringBuffer().append(&quot;%&quot;).append(worksDto.getSearchText()).append(&quot;%&quot;);" ID="ID_379985879" CREATED="1572584703751" MODIFIED="1572584703751"/>
<node TEXT="Predicate worksSubjectPre = cb.like(worksRoot.get(&quot;subject&quot;), searchTextBuffer.toString());" ID="ID_399471706" CREATED="1572584703754" MODIFIED="1572584703754"/>
<node TEXT="predicate_list.add(worksSubjectPre);" ID="ID_353617127" CREATED="1572584703755" MODIFIED="1572584703755"/>
<node TEXT="Predicate[] predicate_array = new Predicate[predicate_list.size()];" ID="ID_530758948" CREATED="1572584703756" MODIFIED="1572584703756"/>
<node TEXT="predicate_array = predicate_list.toArray(predicate_array);" ID="ID_728291595" CREATED="1572584703756" MODIFIED="1572584703756"/>
<node TEXT="cq.select(cb.count(worksRoot)).where(predicate_array);" ID="ID_1756054310" CREATED="1572584703757" MODIFIED="1572584703757"/>
<node TEXT="Long count = em.createQuery(cq).getSingleResult();" ID="ID_1098248357" CREATED="1572584703757" MODIFIED="1572584703757"/>
<node TEXT="return count;" ID="ID_215094841" CREATED="1572584703758" MODIFIED="1572584703758"/>
</node>
<node TEXT="}" ID="ID_1147033207" CREATED="1572584703758" MODIFIED="1572584703758"/>
</node>
<node TEXT="}" ID="ID_351372014" CREATED="1572584703759" MODIFIED="1572584703759"/>
</node>
</node>
<node TEXT="criteria query 시에 EntityManager를 반드시 close 해줘야 한다!!" FOLDED="true" ID="ID_1949644332" CREATED="1572584636189" MODIFIED="1602135881491" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
<node TEXT="그렇지 않으면 JDBC POOL이 쿼리 시마다 ACTIVE가 될것" ID="ID_1823645871" CREATED="1572584671485" MODIFIED="1572584695309"/>
<node TEXT="코드" ID="ID_1352557127" CREATED="1572584718373" MODIFIED="1572584718978">
<node TEXT="EntityManager em = entityManagerFactory.createEntityManager();" ID="ID_1518348567" CREATED="1572584719236" MODIFIED="1572584719236"/>
<node TEXT="..." ID="ID_1214431566" CREATED="1572584720606" MODIFIED="1572584723654"/>
<node TEXT="em.close();" ID="ID_705274176" CREATED="1572584724631" MODIFIED="1572584730533"/>
</node>
</node>
<node TEXT="dto" ID="ID_449463916" CREATED="1571804542933" MODIFIED="1571804555468" LINK="#ID_1524617429" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
</node>
<node TEXT="@SqlResultSetMapping" FOLDED="true" ID="ID_1406562232" CREATED="1573209693900" MODIFIED="1605441107492" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://www.baeldung.com/jpa-sql-resultset-mapping" ID="ID_814435658" CREATED="1573209728696" MODIFIED="1573209728696" LINK="https://www.baeldung.com/jpa-sql-resultset-mapping"/>
<node TEXT="https://medium.com/@SlackBeck/jpa-native-query-%EC%82%AC%EC%9A%A9%EC%8B%9C-dto%EB%A1%9C-%EB%A7%A4%ED%95%91-%ED%95%98%EA%B8%B0-64625780c758" ID="ID_1992068077" CREATED="1573209753658" MODIFIED="1573209753658" LINK="https://medium.com/@SlackBeck/jpa-native-query-%EC%82%AC%EC%9A%A9%EC%8B%9C-dto%EB%A1%9C-%EB%A7%A4%ED%95%91-%ED%95%98%EA%B8%B0-64625780c758"/>
<node TEXT="데이터를 불러올 때 그저 똑같은 DTO 똑같은 엔티티로 데이터를 불러오는 것이 아닌, 약간 통계적인 쿼리를 수행해야 할 때도 있다." ID="ID_1035914325" CREATED="1573209757730" MODIFIED="1573209791886"/>
<node TEXT="그럴 때는 쿼리문에 as를 붙여서 해당하는 쿼리에 이름을 붙여 그것을 dto에 가져와야 한다." ID="ID_660592450" CREATED="1573209792100" MODIFIED="1573209999445"/>
<node TEXT="이럴 때 쓰는 방법이 none entity dto를 이용한 방법인데" ID="ID_925715025" CREATED="1573210004917" MODIFIED="1573210044618"/>
<node TEXT="일단 해당하는 엔티티에 미리 result set mapping을 추가해주고" ID="ID_1021734551" CREATED="1573210045337" MODIFIED="1573210063571"/>
<node TEXT="dto에 해당하는 컨스트럭터를 만들어준 후 해당 컬럼을 옮겨주기만 하면 된다." ID="ID_1122825062" CREATED="1573210094165" MODIFIED="1573210294951"/>
<node TEXT="코드 엔티티 수정" FOLDED="true" ID="ID_1318418754" CREATED="1573210389987" MODIFIED="1605441104791">
<node TEXT="@SqlResultSetMapping(" ID="ID_262983666" CREATED="1573210406993" MODIFIED="1573210406993">
<node TEXT="name = &quot;selectSubjectMatterGroup&quot;," ID="ID_1831193610" CREATED="1573210406993" MODIFIED="1573210655482" COLOR="#3333ff" STYLE="bubble">
<arrowlink DESTINATION="ID_1839875404" STARTINCLINATION="988.49997 pt;0 pt;" ENDINCLINATION="988.49997 pt;0 pt;" STARTARROW="DEFAULT" ENDARROW="NONE"/>
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="classes = {" ID="ID_461312330" CREATED="1573210406993" MODIFIED="1573210406993">
<node TEXT="@ConstructorResult(" ID="ID_1549400616" CREATED="1573210406993" MODIFIED="1573210406993">
<node TEXT="targetClass = com.theComments.brt.jpa.dto.Evaluation_itemDto.class," ID="ID_458979510" CREATED="1573210406993" MODIFIED="1573210406993"/>
<node TEXT="columns = {" ID="ID_1930310188" CREATED="1573210406993" MODIFIED="1573210406993">
<node TEXT="@ColumnResult(name=&quot;subjectMatter&quot;,type=String.class)," ID="ID_762820405" CREATED="1573210406993" MODIFIED="1573210406993"/>
<node TEXT="@ColumnResult(name=&quot;yellow&quot;,type=Integer.class)," ID="ID_161383622" CREATED="1573210406993" MODIFIED="1573210406993"/>
<node TEXT="@ColumnResult(name=&quot;blue&quot;,type=Integer.class)," ID="ID_457204" CREATED="1573210406993" MODIFIED="1573210406993"/>
<node TEXT="@ColumnResult(name=&quot;gray&quot;,type=Integer.class)," ID="ID_553334943" CREATED="1573210406993" MODIFIED="1573210406993"/>
<node TEXT="@ColumnResult(name=&quot;black&quot;,type=Integer.class)" ID="ID_1953140615" CREATED="1573210406993" MODIFIED="1573210406993"/>
</node>
<node TEXT="})" ID="ID_1803396993" CREATED="1573210406993" MODIFIED="1573210406993"/>
</node>
</node>
<node TEXT="})" ID="ID_326163724" CREATED="1573210406993" MODIFIED="1573210406993"/>
</node>
<node TEXT="@Entity" ID="ID_463126907" CREATED="1573210406993" MODIFIED="1573210406993"/>
<node TEXT="public class Evaluation_item {" ID="ID_1789629468" CREATED="1573210406993" MODIFIED="1573210406993"/>
</node>
<node TEXT="직접 사용 코드" FOLDED="true" ID="ID_1416434820" CREATED="1573210410519" MODIFIED="1601971353525">
<node TEXT="public ResultMap selectMatter(Long work_id,int page, int size) {" ID="ID_824077148" CREATED="1573210435909" MODIFIED="1573210697382">
<node TEXT="// TODO Auto-generated method stub" ID="ID_1117313465" CREATED="1573210435909" MODIFIED="1573210435909"/>
<node TEXT="EntityManager em = entityManagerFactory.createEntityManager();" ID="ID_1942725215" CREATED="1573210435909" MODIFIED="1573210435909"/>
<node TEXT="Query query = em.createNativeQuery(" FOLDED="true" ID="ID_1504547981" CREATED="1573210435940" MODIFIED="1573210687645" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="&quot;SELECT\r\n&quot; +" ID="ID_725776007" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;        result.subjectMatter,\r\n&quot; +" ID="ID_48907125" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;        SUM(CASE \r\n&quot; +" ID="ID_708980209" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;            WHEN result.ev_value&gt;=6 THEN 1 \r\n&quot; +" ID="ID_1852569990" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;            ELSE 0 \r\n&quot; +" ID="ID_1774177992" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;        END) as yellow,\r\n&quot; +" ID="ID_841250150" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;        SUM(CASE \r\n&quot; +" ID="ID_1851908265" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;            WHEN result.ev_value&gt;=4 \r\n&quot; +" ID="ID_1477547903" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;            and result.ev_value &lt;=5 THEN 1 \r\n&quot; +" ID="ID_673851872" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;            ELSE 0 \r\n&quot; +" ID="ID_657264151" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;        END) as blue,\r\n&quot; +" ID="ID_1239853993" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;        SUM(CASE \r\n&quot; +" ID="ID_1309698833" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;            WHEN result.ev_value&gt;=2 \r\n&quot; +" ID="ID_1477558308" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;            and result.ev_value &lt;=3 THEN 1 \r\n&quot; +" ID="ID_573672227" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;            ELSE 0 \r\n&quot; +" ID="ID_910673152" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;        END) as gray,\r\n&quot; +" ID="ID_1370938875" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;        SUM(CASE \r\n&quot; +" ID="ID_72127949" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;            WHEN result.ev_value=1 THEN 1 \r\n&quot; +" ID="ID_1497718850" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;            ELSE 0 \r\n&quot; +" ID="ID_1916637132" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;        END) as black   \r\n&quot; +" ID="ID_367411710" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;    FROM\r\n&quot; +" ID="ID_1055181947" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;        (   SELECT\r\n&quot; +" ID="ID_1243994759" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;            ei.subjectMatter,\r\n&quot; +" ID="ID_186415062" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;            ei.ev_value   \r\n&quot; +" ID="ID_1144244430" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;        FROM\r\n&quot; +" ID="ID_766774298" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;            evaluation_item ei    \r\n&quot; +" ID="ID_1118925934" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;        INNER JOIN\r\n&quot; +" ID="ID_118302869" CREATED="1573210435940" MODIFIED="1573210630723"/>
<node TEXT="&quot;            evaluate e   \r\n&quot; +" ID="ID_1590860865" CREATED="1573210435955" MODIFIED="1573210630723"/>
<node TEXT="&quot;                ON ei.eval_item_id = e.eval_item_id    \r\n&quot; +" ID="ID_1941376568" CREATED="1573210435955" MODIFIED="1573210630723"/>
<node TEXT="&quot;        INNER JOIN\r\n&quot; +" ID="ID_211812684" CREATED="1573210435955" MODIFIED="1573210630723"/>
<node TEXT="&quot;            WORKS w   \r\n&quot; +" ID="ID_1015569537" CREATED="1573210435955" MODIFIED="1573210630723"/>
<node TEXT="&quot;                ON w.work_id = e.works_id   \r\n&quot; +" ID="ID_1178257209" CREATED="1573210435955" MODIFIED="1573210630723"/>
<node TEXT="&quot;        WHERE\r\n&quot; +" ID="ID_838122628" CREATED="1573210435955" MODIFIED="1573210630723"/>
<node TEXT="&quot;            w.work_id = :work_id   ) as result   \r\n&quot; +" ID="ID_1857134278" CREATED="1573210435955" MODIFIED="1573210630723"/>
<node TEXT="&quot;    GROUP BY\r\n&quot; +" ID="ID_397698934" CREATED="1573210435955" MODIFIED="1573210630723"/>
<node TEXT="&quot;        result.subjectMatter&quot;," ID="ID_1199689412" CREATED="1573210435955" MODIFIED="1573210630723"/>
<node TEXT="&quot;selectSubjectMatterGroup&quot;);" ID="ID_1839875404" CREATED="1573210435955" MODIFIED="1573210655482" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<linktarget COLOR="#b0b0b0" DESTINATION="ID_1839875404" ENDARROW="None" ENDINCLINATION="1318;0;" ID="Arrow_ID_1022277653" SOURCE="ID_1831193610" STARTARROW="Default" STARTINCLINATION="1318;0;"/>
</node>
</node>
<node TEXT="query.setParameter(&quot;work_id&quot;, work_id);" ID="ID_140382852" CREATED="1573210435955" MODIFIED="1573210435955"/>
<node TEXT="query.setFirstResult(page);" ID="ID_376316064" CREATED="1573210435955" MODIFIED="1573210435955"/>
<node TEXT="query.setMaxResults(size);" ID="ID_311301295" CREATED="1573210435955" MODIFIED="1573210435955"/>
<node TEXT="List&lt;Evaluation_itemDto&gt; list = query.getResultList();" ID="ID_751581940" CREATED="1573210435955" MODIFIED="1573210435955"/>
<node TEXT="Long count = this.selectMatter(em,work_id,page,size);" ID="ID_1568698626" CREATED="1573210435955" MODIFIED="1573210435955"/>
<node TEXT="em.close();" ID="ID_730978816" CREATED="1573210435955" MODIFIED="1573210435955"/>
<node TEXT="ResultMap result = new ResultMap();" ID="ID_1625845325" CREATED="1573210435955" MODIFIED="1573210435955"/>
<node TEXT="result.setData(list);" ID="ID_1338545770" CREATED="1573210435955" MODIFIED="1573210435955"/>
<node TEXT="result.setTotalSize(count);" ID="ID_1159720870" CREATED="1573210435955" MODIFIED="1573210435955"/>
<node TEXT="return result;" ID="ID_30314819" CREATED="1573210435955" MODIFIED="1573210435955"/>
</node>
<node TEXT="}" ID="ID_1476189984" CREATED="1573210435955" MODIFIED="1573210435955"/>
</node>
</node>
<node TEXT="criteria group by" FOLDED="true" ID="ID_1811794652" CREATED="1573317167405" MODIFIED="1602138250902">
<node TEXT="https://www.logicbig.com/tutorials/java-ee-tutorial/jpa/criteria-api-group-by-and-having-methods.html" ID="ID_1795912546" CREATED="1573317177086" MODIFIED="1573317177086" LINK="https://www.logicbig.com/tutorials/java-ee-tutorial/jpa/criteria-api-group-by-and-having-methods.html"/>
</node>
<node TEXT="creteria order by" FOLDED="true" ID="ID_908308672" CREATED="1573317305047" MODIFIED="1616568425667">
<node TEXT="https://www.baeldung.com/jpa-sort" ID="ID_1252166600" CREATED="1573317313672" MODIFIED="1573317313672" LINK="https://www.baeldung.com/jpa-sort"/>
<node TEXT="order by count" ID="ID_1078760006" CREATED="1573318202855" MODIFIED="1573318207225">
<node TEXT="Root&lt;Works&gt; worksRoot = cq.from(Works.class);" ID="ID_1391712797" CREATED="1573318306884" MODIFIED="1573318308399"/>
<node TEXT="...." ID="ID_1136168307" CREATED="1573318309353" MODIFIED="1573318310425"/>
<node TEXT="Join&lt;Works, Evaluate&gt; evalRoot = worksRoot.join(&quot;evaluate&quot;,JoinType.LEFT);" ID="ID_1037252782" CREATED="1573318295922" MODIFIED="1573318296598"/>
<node TEXT="...." ID="ID_964999987" CREATED="1573318298423" MODIFIED="1573318299315"/>
<node TEXT="Order order = cb.desc(cb.count(evalRoot.get(&quot;eval_id&quot;)));" ID="ID_977593743" CREATED="1573318290264" MODIFIED="1573318290264"/>
</node>
</node>
<node TEXT="EntiityGraph" FOLDED="true" ID="ID_392554766" CREATED="1573359930180" MODIFIED="1616576799877" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
<node TEXT="oneToMany 일때 데이터를 fetch lazy를 잠시 earlty로 바꿔주는게 있다." ID="ID_1997380661" CREATED="1573360108583" MODIFIED="1573360139876"/>
<node TEXT="또한 이걸 써야지만 Entity에 자동으로 넣어주는 것도 있다." FOLDED="true" ID="ID_416168530" CREATED="1573360152226" MODIFIED="1611910603745">
<node TEXT="이게 무슨 말이냐면 그냥 fetch join을 쓰게 되면" ID="ID_495981160" CREATED="1573360264852" MODIFIED="1573360276182"/>
<node TEXT="One To Many 일때 N+1 개 나오게 된다." ID="ID_1387312240" CREATED="1573360276786" MODIFIED="1573360288573"/>
<node TEXT="이걸 자동으로 기존 entity에 넣어준다는 것이다." ID="ID_447523473" CREATED="1573360289190" MODIFIED="1573360303767"/>
</node>
<node TEXT="jpa 2.1부터 가능하다." ID="ID_1029936352" CREATED="1573360361001" MODIFIED="1573360364925"/>
<node TEXT="criteria 사용하는 법" FOLDED="true" ID="ID_413388831" CREATED="1573360397956" MODIFIED="1616567049825" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://www.baeldung.com/jpa-entity-graph" ID="ID_1234024478" CREATED="1573360366353" MODIFIED="1573360510537" LINK="https://www.baeldung.com/jpa-entity-graph"/>
<node TEXT="코드" FOLDED="true" ID="ID_191871306" CREATED="1573360519297" MODIFIED="1616567049825">
<node TEXT="public List&lt;WorksDto&gt; searchWorksDynamic(WorksDto worksDto, Type1Dto type1, Type2Dto type2," ID="ID_1827221046" CREATED="1573360539426" MODIFIED="1607416367044">
<node TEXT="OrderForSearch orderForSearch) {" ID="ID_672146859" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="// TODO Auto-generated method stub" ID="ID_432211495" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="EntityManager em = entityManagerFactory.createEntityManager();" ID="ID_830869386" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="CriteriaBuilder cb = em.getCriteriaBuilder();" ID="ID_852530306" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="CriteriaQuery&lt;Works&gt; cq = cb.createQuery(Works.class);" ID="ID_261583013" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="Root&lt;Works&gt; worksRoot = cq.from(Works.class);" ID="ID_1266759937" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="Join&lt;Works, Type2&gt; type2Root = worksRoot.join(&quot;type2&quot;, JoinType.INNER);" ID="ID_798638168" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="Join&lt;Type2, Type1&gt; type1Root = type2Root.join(&quot;type1&quot;, JoinType.INNER);" ID="ID_1783554537" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="Join&lt;Works, Evaluate&gt; evalRoot = worksRoot.join(&quot;evaluate&quot;, JoinType.LEFT);" ID="ID_1888292211" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="Join&lt;Works,FileSave&gt; fileSaveRoot = worksRoot.join(&quot;fileSave&quot;, JoinType.LEFT);" ID="ID_1822967206" CREATED="1573360539426" MODIFIED="1573360556545" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="Long type1_id = type1.getType1_id();" ID="ID_1479634632" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="Long type2_id = type2.getType2_id();" ID="ID_239244201" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="List&lt;Predicate&gt; predicate_list = new ArrayList&lt;Predicate&gt;();" ID="ID_1179986129" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="if (type1_id != 0) {" FOLDED="true" ID="ID_889243386" CREATED="1573360539426" MODIFIED="1607416368233">
<node TEXT="Predicate type1Pre = cb.equal(type1Root.get(&quot;type1_id&quot;), type1_id);" ID="ID_985659398" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="predicate_list.add(type1Pre);" ID="ID_739869195" CREATED="1573360539426" MODIFIED="1573360539426"/>
</node>
<node TEXT="}" ID="ID_488992087" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="if (type2_id != 0) {" FOLDED="true" ID="ID_1755764683" CREATED="1573360539426" MODIFIED="1607416368233">
<node TEXT="Predicate type2Pre = cb.equal(type2Root.get(&quot;type2_id&quot;), type2_id);" ID="ID_155317002" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="predicate_list.add(type2Pre);" ID="ID_623324761" CREATED="1573360539426" MODIFIED="1573360539426"/>
</node>
<node TEXT="}" ID="ID_530370026" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="StringBuffer searchTextBuffer = new StringBuffer().append(&quot;%&quot;).append(worksDto.getSearchText()).append(&quot;%&quot;);" ID="ID_237124661" CREATED="1573360539426" MODIFIED="1573360539426"/>
<node TEXT="Predicate worksSubjectPre = cb.like(worksRoot.get(&quot;subject&quot;), searchTextBuffer.toString());" ID="ID_1371899865" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="predicate_list.add(worksSubjectPre);" ID="ID_638022195" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="Predicate[] predicate_array = new Predicate[predicate_list.size()];" ID="ID_1128266554" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="predicate_array = predicate_list.toArray(predicate_array);" ID="ID_293726967" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="Order order = cb.desc(cb.count(evalRoot.get(&quot;eval_id&quot;)));" ID="ID_609268354" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="EntityGraph&lt;Works&gt; works_filesave_entityGraph = em.createEntityGraph(Works.class);" ID="ID_1160518958" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="works_filesave_entityGraph.addAttributeNodes(&quot;fileSave&quot;);" ID="ID_1704557777" CREATED="1573360539441" MODIFIED="1573360549322" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="TypedQuery&lt;Works&gt; typeQuery = em.createQuery(" FOLDED="true" ID="ID_1598846965" CREATED="1573360539441" MODIFIED="1616567049825">
<node TEXT="cq" ID="ID_1218125013" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT=".select(worksRoot)" ID="ID_1475314304" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT=".where(predicate_array)" ID="ID_336041217" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT=".groupBy(worksRoot.get(&quot;work_id&quot;),fileSaveRoot.get(&quot;file_id&quot;))" ID="ID_277545996" CREATED="1573360539441" MODIFIED="1573360569197" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT=".orderBy(order));" ID="ID_496001498" CREATED="1573360539441" MODIFIED="1573360539441"/>
</node>
<node TEXT="typeQuery.setFirstResult(worksDto.getPageNum() - 1);" ID="ID_1552897289" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="typeQuery.setMaxResults(PAGE.PAGE_SIZE);" ID="ID_1806345634" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="typeQuery.setHint(&quot;javax.persistence.loadgraph&quot;, works_filesave_entityGraph);" ID="ID_52471966" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="Long totalCount = searchWorksDynamicTotalCount(em,worksDto, type1, type2);" ID="ID_575897292" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="List&lt;Works&gt; works_list = typeQuery.getResultList();" ID="ID_154147607" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="em.close();" ID="ID_943146062" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="List&lt;WorksDto&gt; dto_list = new ArrayList&lt;WorksDto&gt;();" ID="ID_740475518" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="for (Works work : works_list) {" FOLDED="true" ID="ID_1724632513" CREATED="1573360539441" MODIFIED="1607416368233">
<node TEXT="WorksDto one = new WorksDto();" ID="ID_573984156" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="BeanUtils.copyProperties(work, one);" ID="ID_276457496" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="one.setTotalSize(totalCount);" ID="ID_1151839490" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="dto_list.add(one);" ID="ID_1826627086" CREATED="1573360539441" MODIFIED="1573360539441"/>
</node>
<node TEXT="}" ID="ID_1894729360" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="return dto_list;" ID="ID_1363754599" CREATED="1573360539441" MODIFIED="1573360539441"/>
<node TEXT="}" ID="ID_1692023202" CREATED="1573360539441" MODIFIED="1573360539441"/>
</node>
</node>
<node TEXT="여기서 중요한점은 groupId를 사용하였기 때문에" ID="ID_6286916" CREATED="1573360574838" MODIFIED="1573360698614" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="따로 해당하는 테이블의 left join을 사용하여 명시적으로 엔티티 그래프의 조인을 나타내어 groupid를 하나 더 추가했다." ID="ID_262504180" CREATED="1573360604606" MODIFIED="1573360698124" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="이렇게 복잡하게 한 이유는 이게 다이나믹 쿼리를 적용하여야 하기 때문이다." ID="ID_1701501481" CREATED="1573360718446" MODIFIED="1573360835975" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="subGraph 이용방법" FOLDED="true" ID="ID_1095986147" CREATED="1573380036789" MODIFIED="1607492043158">
<node TEXT="entityGraph.addSubgraph(&quot;comments&quot;)" ID="ID_1015058389" CREATED="1573380223509" MODIFIED="1573380223509">
<node TEXT=".addAttributeNodes(&quot;user&quot;);" ID="ID_1938877773" CREATED="1573380223509" MODIFIED="1573380223509"/>
</node>
</node>
<node TEXT="name으로만 불러오는 방법 예))" FOLDED="true" ID="ID_1988214933" CREATED="1575981343549" MODIFIED="1607492043158">
<node TEXT="EntityGraph eg = entityManager.getEntityGraph(&quot;Sms.fetchSims&quot;);" ID="ID_232161649" CREATED="1575981357183" MODIFIED="1575981357183"/>
</node>
</node>
<node TEXT="그냥 dao를 사용함으로 써 사용하는 법" ID="ID_1288050623" CREATED="1573360405386" MODIFIED="1611910603786" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://blog.leocat.kr/notes/2019/05/26/spring-data-using-entitygraph-to-customize-fetch-graph" ID="ID_1107830837" CREATED="1573360507336" MODIFIED="1573360510776" LINK="https://blog.leocat.kr/notes/2019/05/26/spring-data-using-entitygraph-to-customize-fetch-graph"/>
<node TEXT="코드" FOLDED="true" ID="ID_941614623" CREATED="1573360516979" MODIFIED="1607492045414">
<node TEXT="@Query(&quot;SELECT t1 FROM Type1 t1&quot;)" ID="ID_356534354" CREATED="1573360711972" MODIFIED="1573360711972"/>
<node TEXT="@EntityGraph(attributePaths = {&quot;type2&quot;},type = EntityGraphType.LOAD)" ID="ID_1661496855" CREATED="1573360711972" MODIFIED="1573360711972"/>
<node TEXT="public List&lt;Type1&gt; getAllType();" ID="ID_1337968970" CREATED="1573360711972" MODIFIED="1573360711972"/>
</node>
<node TEXT="가장 간단한 방법이다. 간단한 무엇가에 이용하면 된다." ID="ID_625990294" CREATED="1573360713913" MODIFIED="1573360855622"/>
<node TEXT="subGraph 이용방법" FOLDED="true" ID="ID_813556329" CREATED="1573380036789" MODIFIED="1607492045414">
<node TEXT="@NamedEntityGraph(" ID="ID_448618836" CREATED="1573380242176" MODIFIED="1573380242176">
<node TEXT="name = &quot;post-entity-graph-with-comment-users&quot;," ID="ID_1121327018" CREATED="1573380242176" MODIFIED="1573380242176"/>
<node TEXT="attributeNodes = {" ID="ID_1690614103" CREATED="1573380242176" MODIFIED="1573380242176">
<node TEXT="@NamedAttributeNode(&quot;subject&quot;)," ID="ID_284898066" CREATED="1573380242176" MODIFIED="1573380242176"/>
<node TEXT="@NamedAttributeNode(&quot;user&quot;)," ID="ID_629466761" CREATED="1573380242176" MODIFIED="1573380242176"/>
<node TEXT="@NamedAttributeNode(value = &quot;comments&quot;, subgraph = &quot;comments-subgraph&quot;)," ID="ID_765177096" CREATED="1573380242176" MODIFIED="1573380242176"/>
</node>
<node TEXT="}," ID="ID_1785351984" CREATED="1573380242176" MODIFIED="1573380242176"/>
</node>
</node>
</node>
<node TEXT="https://www.baeldung.com/jpa-entity-graph" ID="ID_1725923270" CREATED="1607492065054" MODIFIED="1607492065054" LINK="https://www.baeldung.com/jpa-entity-graph"/>
</node>
<node TEXT="list보다 set을 사용해야 하는 이유(??)" FOLDED="true" ID="ID_696119653" CREATED="1573385051823" MODIFIED="1607492048182" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
<node TEXT="https://stackoverflow.com/questions/26934011/namedentitygraph-jpa-hibernate-throwing-org-hibernate-loader-multiplebagfetc" ID="ID_941000503" CREATED="1573385061034" MODIFIED="1573385061034" LINK="https://stackoverflow.com/questions/26934011/namedentitygraph-jpa-hibernate-throwing-org-hibernate-loader-multiplebagfetc"/>
<node TEXT="EntityGraph를 사용할 때 제대로 하려면 set이 필요하다, 그렇지 않으면 값이 중복되는 일이 벌어진다." ID="ID_829095390" CREATED="1573453286236" MODIFIED="1573453336021"/>
</node>
<node TEXT="ArrayList sort" FOLDED="true" ID="ID_1374945408" CREATED="1573453384192" MODIFIED="1620905279262">
<node TEXT="https://www.baeldung.com/java-comparator-comparable" ID="ID_785788957" CREATED="1573453390311" MODIFIED="1573453390311" LINK="https://www.baeldung.com/java-comparator-comparable"/>
</node>
<node TEXT="queryDsl" FOLDED="true" ID="ID_1171558768" CREATED="1574957141393" MODIFIED="1620638899910">
<node TEXT="https://www.baeldung.com/intro-to-querydsl" ID="ID_1916648376" CREATED="1574957155100" MODIFIED="1575378351157" LINK="https://www.baeldung.com/intro-to-querydsl" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="여기 설정되어 있는것과 달리 최신버젼의 메이븐 설정 클래스는" ID="ID_561330500" CREATED="1575089387093" MODIFIED="1620638794593">
<node TEXT="com.mysema.query.apt.jpa.JPAAnnotationProcessor" ID="ID_318876966" CREATED="1575090990681" MODIFIED="1575090990681"/>
<node TEXT="을 써야 한다." ID="ID_1483815192" CREATED="1575090991797" MODIFIED="1575090993951"/>
<node TEXT="아니다!!!!!!!!!!!!!!!!!!!" ID="ID_775319683" CREATED="1575378118735" MODIFIED="1575378121921" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
</node>
<node TEXT="&lt;!-- https://mvnrepository.com/artifact/com.querydsl/querydsl-jpa --&gt;" ID="ID_366579919" CREATED="1575378369918" MODIFIED="1575378369918" LINK="https://mvnrepository.com/artifact/com.querydsl/querydsl-jpa"/>
<node TEXT="&lt;dependency&gt;" ID="ID_406229663" CREATED="1575378369920" MODIFIED="1575378369920">
<node TEXT="&lt;groupId&gt;com.querydsl&lt;/groupId&gt;" ID="ID_16198530" CREATED="1575378369921" MODIFIED="1575378369921"/>
<node TEXT="&lt;artifactId&gt;querydsl-jpa&lt;/artifactId&gt;" ID="ID_1887197803" CREATED="1575378369922" MODIFIED="1575378369922"/>
<node TEXT="&lt;version&gt;4.2.2&lt;/version&gt;" ID="ID_341206492" CREATED="1575378369922" MODIFIED="1575378369922"/>
</node>
<node TEXT="&lt;/dependency&gt;" ID="ID_225966412" CREATED="1575378369923" MODIFIED="1575378369923"/>
<node TEXT="&lt;!-- https://mvnrepository.com/artifact/com.querydsl/querydsl-apt --&gt;" ID="ID_1315431041" CREATED="1575378369924" MODIFIED="1575378369924" LINK="https://mvnrepository.com/artifact/com.querydsl/querydsl-apt"/>
<node TEXT="&lt;dependency&gt;" ID="ID_421233543" CREATED="1575378369925" MODIFIED="1575378369925">
<node TEXT="&lt;groupId&gt;com.querydsl&lt;/groupId&gt;" ID="ID_1549927802" CREATED="1575378369925" MODIFIED="1575378369925"/>
<node TEXT="&lt;artifactId&gt;querydsl-apt&lt;/artifactId&gt;" ID="ID_610587090" CREATED="1575378369926" MODIFIED="1575378369926"/>
<node TEXT="&lt;version&gt;4.2.2&lt;/version&gt;" ID="ID_1726518929" CREATED="1575378369927" MODIFIED="1575378369927"/>
</node>
<node TEXT="&lt;/dependency&gt;" ID="ID_1337745053" CREATED="1575378369927" MODIFIED="1575378369927"/>
<node TEXT="메이븐에서 두개의 queryDsl을 돌릴때에는 버젼이 똑같아야 함을 잊지 말라!!!" ID="ID_1347370538" CREATED="1575378371865" MODIFIED="1575378413718">
<node TEXT="&lt;plugin&gt;" ID="ID_299671545" CREATED="1575378536130" MODIFIED="1575378536130">
<node TEXT="&lt;groupId&gt;com.mysema.maven&lt;/groupId&gt;" ID="ID_1636786293" CREATED="1575378536131" MODIFIED="1575378536131"/>
<node TEXT="&lt;artifactId&gt;apt-maven-plugin&lt;/artifactId&gt;" ID="ID_1503348120" CREATED="1575378536132" MODIFIED="1575378536132"/>
<node TEXT="&lt;version&gt;1.1.3&lt;/version&gt;" ID="ID_529643488" CREATED="1575378536132" MODIFIED="1575378536132"/>
<node TEXT="&lt;executions&gt;" ID="ID_1977218806" CREATED="1575378536133" MODIFIED="1575378536133">
<node TEXT="&lt;execution&gt;" ID="ID_1940949926" CREATED="1575378536133" MODIFIED="1575378536133">
<node TEXT="&lt;goals&gt;" ID="ID_1068038849" CREATED="1575378536134" MODIFIED="1575378536134">
<node TEXT="&lt;goal&gt;process&lt;/goal&gt;" ID="ID_1141053381" CREATED="1575378536135" MODIFIED="1575378536135"/>
</node>
<node TEXT="&lt;/goals&gt;" ID="ID_1742517910" CREATED="1575378536135" MODIFIED="1575378536135"/>
<node TEXT="&lt;configuration&gt;" ID="ID_1566636301" CREATED="1575378536136" MODIFIED="1575378536136">
<node TEXT="&lt;outputDirectory&gt;target/generated-sources/java&lt;/outputDirectory&gt;" ID="ID_1118217283" CREATED="1575378536136" MODIFIED="1575378536136"/>
<node TEXT="&lt;processor&gt;com.querydsl.apt.jpa.JPAAnnotationProcessor&lt;/processor&gt;" ID="ID_783090385" CREATED="1575378536137" MODIFIED="1575378536137"/>
</node>
<node TEXT="&lt;/configuration&gt;" ID="ID_1152039614" CREATED="1575378536137" MODIFIED="1575378536137"/>
</node>
<node TEXT="&lt;/execution&gt;" ID="ID_581283564" CREATED="1575378536138" MODIFIED="1575378536138"/>
</node>
<node TEXT="&lt;/executions&gt;" ID="ID_330617920" CREATED="1575378536138" MODIFIED="1575378536138"/>
</node>
<node TEXT="&lt;/plugin&gt;" ID="ID_384927917" CREATED="1575378536138" MODIFIED="1575378536138"/>
</node>
<node TEXT="그리고 com.querydsl.apt.jpa.JPAAnnotationProcessor을 쓰면 된다." ID="ID_1433820548" CREATED="1575378479950" MODIFIED="1575378502382"/>
<node TEXT="여기서 했던것과 같이 말이다." ID="ID_1083810693" CREATED="1575378510557" MODIFIED="1575378517877" LINK="#ID_1916648376"/>
</node>
<node TEXT="queryDsl Select Example" ID="ID_1110427307" CREATED="1575092106952" MODIFIED="1575384073226">
<node TEXT="https://icarus8050.tistory.com/5" ID="ID_1630920521" CREATED="1575092114348" MODIFIED="1575092114348" LINK="https://icarus8050.tistory.com/5"/>
</node>
<node TEXT="queryDsl dynamic query builder" ID="ID_343002240" CREATED="1575188984245" MODIFIED="1575384072577">
<node TEXT="https://jojoldu.tistory.com/394" ID="ID_1867599425" CREATED="1575189044475" MODIFIED="1575189044475" LINK="https://jojoldu.tistory.com/394"/>
</node>
<node TEXT="페이징 처리 " ID="ID_1624948452" CREATED="1575384077525" MODIFIED="1575384080658">
<node TEXT="wonwoo.ml &gt; Index.php &gt; Post &gt; 597" ID="ID_403329648" CREATED="1575384055433" MODIFIED="1575384075897" LINK="http://wonwoo.ml/index.php/post/597"/>
</node>
<node TEXT="expressionUtils.as 사용법" ID="ID_1348153064" CREATED="1575387940173" MODIFIED="1575387958253">
<node TEXT="https://megazonedsg.github.io/QueryDSL/" ID="ID_1918874041" CREATED="1575387959002" MODIFIED="1575387959002" LINK="https://megazonedsg.github.io/QueryDSL/"/>
<node TEXT="ExpressionUtils.as(JPAExpressions.select(qUser.name.count()).from(qUser).where(qUser.created_at.before(new Date()))" ID="ID_818198680" CREATED="1575387964425" MODIFIED="1575387964425"/>
</node>
</node>
<node TEXT="creteria&apos;s mmetamodel" FOLDED="true" ID="ID_609519769" CREATED="1575975329955" MODIFIED="1607415155930">
<node TEXT="해당 컬럼 이름을 자동으로 생성해준다고 생각하면 된다." ID="ID_855339520" CREATED="1575975448506" MODIFIED="1575975462757"/>
<node TEXT="https://www.baeldung.com/hibernate-criteria-queries-metamodel" ID="ID_1769083739" CREATED="1575975465201" MODIFIED="1575975466019" LINK="https://www.baeldung.com/hibernate-criteria-queries-metamodel"/>
<node TEXT="https://stackoverflow.com/questions/26142743/jpa-criteria-expression-based-on-db-field-name" ID="ID_973903184" CREATED="1575975351028" MODIFIED="1575975351028" LINK="https://stackoverflow.com/questions/26142743/jpa-criteria-expression-based-on-db-field-name"/>
<node TEXT="IDE에서 이용하는 방법" ID="ID_365199170" CREATED="1575977495253" MODIFIED="1575977499595">
<node TEXT="https://docs.jboss.org/hibernate/orm/5.0/topical/html/metamodelgen/MetamodelGenerator.html" ID="ID_761759515" CREATED="1575977490764" MODIFIED="1575977490764" LINK="https://docs.jboss.org/hibernate/orm/5.0/topical/html/metamodelgen/MetamodelGenerator.html"/>
</node>
</node>
<node TEXT="JsonView와 Valid" FOLDED="true" ID="ID_360851908" CREATED="1582686574195" MODIFIED="1607415155930">
<node TEXT="해당하는 모듈은 모두 Interface이다." ID="ID_1569750350" CREATED="1582686582996" MODIFIED="1582686597214"/>
<node TEXT="jsonView" ID="ID_1098398151" CREATED="1582686689723" MODIFIED="1582686696787">
<node TEXT="jsonView는 Entity에서 해당하는 컬럼에 지정을 해준다." ID="ID_481078069" CREATED="1582686602602" MODIFIED="1582686702243"/>
<node TEXT="그리고 컨트롤러에서 리턴 될 때 위의 jsonView를 지정해주면 해당하는 컬럼의 내용들만 response된다." ID="ID_465167676" CREATED="1582686619562" MODIFIED="1582686702243"/>
<node TEXT="쓰는방법" ID="ID_1222760341" CREATED="1605691734160" MODIFIED="1605691736402">
<node TEXT="https://stackoverflow.com/questions/34535599/spring-and-jsonview-with-multiple-identifiers" ID="ID_1084044347" CREATED="1605691732908" MODIFIED="1605691732908" LINK="https://stackoverflow.com/questions/34535599/spring-and-jsonview-with-multiple-identifiers"/>
</node>
</node>
<node TEXT="Valid" ID="ID_9843489" CREATED="1582686697190" MODIFIED="1582686700503">
<node TEXT="https://www.baeldung.com/javax-validation" ID="ID_1305896888" CREATED="1586746605493" MODIFIED="1586746605493" LINK="https://www.baeldung.com/javax-validation"/>
</node>
</node>
<node TEXT="manyToMany의 update부분에 대한 정리" FOLDED="true" ID="ID_1653283481" CREATED="1602638798116" MODIFIED="1607415155930">
<node TEXT="https://blog.naver.com/neem693/222113924772" ID="ID_1504460082" CREATED="1602723479853" MODIFIED="1602723479853" LINK="https://blog.naver.com/neem693/222113924772"/>
</node>
<node TEXT="IN에 대한것" FOLDED="true" ID="ID_274504588" CREATED="1603357203142" MODIFIED="1618202583840" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
<node TEXT="https://stackoverflow.com/questions/26677310/spring-data-jpa-repositories-in-clause-in-derived-query-not-working/48129147" ID="ID_1360999113" CREATED="1603357211938" MODIFIED="1603357211938" LINK="https://stackoverflow.com/questions/26677310/spring-data-jpa-repositories-in-clause-in-derived-query-not-working/48129147"/>
</node>
<node TEXT="권한 및 캐시" FOLDED="true" ID="ID_829347974" CREATED="1605443173727" MODIFIED="1618202583840" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://blog.naver.com/neem693/222145057044" ID="ID_42062013" CREATED="1605443206793" MODIFIED="1605443206793" LINK="https://blog.naver.com/neem693/222145057044"/>
</node>
<node TEXT="sort" FOLDED="true" ID="ID_4680138" CREATED="1605871210587" MODIFIED="1618202583840" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
<node TEXT="https://itmining.tistory.com/139" ID="ID_724797033" CREATED="1605871215844" MODIFIED="1605871215844" LINK="https://itmining.tistory.com/139"/>
<node TEXT="페이지네이션과 같이 사용" ID="ID_1918679826" CREATED="1605871237537" MODIFIED="1605871243800"/>
<node TEXT="이미지" FOLDED="true" ID="ID_732158944" CREATED="1605871217584" MODIFIED="1616576826669">
<node ID="ID_1499999236" CREATED="1605871283875" MODIFIED="1605871283875"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_5153465551306562471.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="조인 시에 활용" FOLDED="true" ID="ID_1228141509" CREATED="1605874393103" MODIFIED="1616576828099">
<node TEXT="https://stackoverflow.com/questions/32749409/spring-data-and-how-to-sort-by-a-column-not-in-an-entity" ID="ID_510753371" CREATED="1605874398847" MODIFIED="1605874398847" LINK="https://stackoverflow.com/questions/32749409/spring-data-and-how-to-sort-by-a-column-not-in-an-entity"/>
</node>
<node TEXT="네이티브 쿼리 통계 소팅" ID="ID_888920639" CREATED="1605892518885" MODIFIED="1616576828236">
<node TEXT="https://stackoverflow.com/questions/43993952/how-to-sort-projection-by-alias-from-select-clause-in-spring-data-jpa-with-pagin/54478268" FOLDED="true" ID="ID_442480922" CREATED="1605893521128" MODIFIED="1616577874159" LINK="https://stackoverflow.com/questions/43993952/how-to-sort-projection-by-alias-from-select-clause-in-spring-data-jpa-with-pagin/54478268">
<node TEXT="PageRequest.of(0, 3, JpaSort.unsafe(Sort.Direction.ASC, &quot;(name)&quot;))" ID="ID_1705471337" CREATED="1605893777239" MODIFIED="1605893777239"/>
</node>
<node TEXT="만약 네이티브 쿼리 통계가 alias를 줘서 생신거라면 ( 컬럼이름 ) 이런식으로 해주고 JpaSort.unsafe 를 이용하여, Sort가 아니라 JpaSort를 그대로 대입해줘야 한다." ID="ID_1708617597" CREATED="1605893545488" MODIFIED="1605893711311">
<node TEXT="예1" ID="ID_869539909" CREATED="1605893744732" MODIFIED="1605893745916"/>
<node TEXT="예2" ID="ID_1435985094" CREATED="1605893746276" MODIFIED="1616576840844">
<node TEXT="Sort sort = Sort.unsorted();" ID="ID_1577355501" CREATED="1605893748129" MODIFIED="1616576846926">
<node TEXT="if(order == 0) {" ID="ID_1532652832" CREATED="1605893748130" MODIFIED="1605893748130">
<node TEXT="sort = sort.and(JpaSort.unsafe(Sort.Direction.DESC,&quot;MAX(w.create_date)&quot;));" ID="ID_1471107935" CREATED="1605893748131" MODIFIED="1616578180006"/>
</node>
<node TEXT="}" ID="ID_1647120500" CREATED="1605893748132" MODIFIED="1605893748132"/>
<node TEXT="if(order == 1) {" ID="ID_344471164" CREATED="1605893748132" MODIFIED="1605893748132">
<node TEXT="sort = sort.and(JpaSort.unsafe(Sort.Direction.DESC,&quot;COUNT(t1.type1_id)&quot;));" ID="ID_517845593" CREATED="1605893748133" MODIFIED="1616578185759"/>
</node>
<node TEXT="}" ID="ID_1440539978" CREATED="1605893748134" MODIFIED="1605893748134"/>
<node TEXT="Pageable pageable = PageRequest.of(pageNum - 1, 10, sort);" ID="ID_205818838" CREATED="1605893748135" MODIFIED="1605893748135"/>
</node>
</node>
</node>
<node TEXT="예3" ID="ID_851287212" CREATED="1616579206526" MODIFIED="1616579208678">
<node TEXT="이미지" ID="ID_1640559252" CREATED="1616579209343" MODIFIED="1616579211497">
<node ID="ID_1708803738" CREATED="1616579212107" MODIFIED="1616579212107"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_4545604313337723488.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="설명" ID="ID_1748903902" CREATED="1616579215054" MODIFIED="1616579216224">
<node TEXT="기본 Entity라면 이름을 생략하고 바로 컬럼 이름으로 넘어가야 한다. 예 cd" ID="ID_1544821593" CREATED="1616579216958" MODIFIED="1616579251457"/>
<node TEXT="조인 Entity라면 이름을 무조건 붙이고 컬럼이름으로 넘어간다. 예 brand.nm" ID="ID_160062872" CREATED="1616579251878" MODIFIED="1616579288579"/>
</node>
</node>
</node>
</node>
<node TEXT="개념은 계속 잡는게 좋다." FOLDED="true" ID="ID_118765808" CREATED="1607415158610" MODIFIED="1611911536531" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
<node TEXT="즉시로딩과 지연로딩(FetchType.LAZY or EAGER" ID="ID_639842857" CREATED="1607415167594" MODIFIED="1607415196305" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://ict-nroo.tistory.com/132" ID="ID_1591308842" CREATED="1607415165650" MODIFIED="1607415173907" LINK="https://ict-nroo.tistory.com/132"/>
</node>
</node>
<node TEXT="Fetch Size 개수" FOLDED="true" ID="ID_480451934" CREATED="1618282848945" MODIFIED="1620905296439">
<node TEXT="https://jojoldu.tistory.com/457" ID="ID_261478516" CREATED="1618282857393" MODIFIED="1618282857393" LINK="https://jojoldu.tistory.com/457"/>
</node>
<node TEXT="성능이슈" FOLDED="true" ID="ID_1147566553" CREATED="1618363367690" MODIFIED="1620905498767">
<node TEXT="무작정 fetch로 들고 오는 것은 조인하는 테이블이 별로 없을 때이다." ID="ID_297904843" CREATED="1618363371912" MODIFIED="1618363392520"/>
<node TEXT="조인하는 테이블도 많으면서 3000건이 넘어가며, 심지어는 한건 한건 데이터 사이즈도 굉장히 많을 때" ID="ID_1733574477" CREATED="1618363392749" MODIFIED="1618363427445"/>
<node TEXT="fetch로 데이터를 가지고 오는 것은 3000건 곱하기 3 보다 더 높을수도 있고 30이 될 수도 있다." ID="ID_991903850" CREATED="1618363429173" MODIFIED="1618363511895"/>
<node TEXT="그 말은 해당 데이터로 추가적인 작업을 가할 떄 메모리에 부가 작업이 아주 젠장할이 될 수 있다는 점이다." ID="ID_1986979076" CREATED="1618363466469" MODIFIED="1618363543700"/>
<node TEXT="따라서 이럴 때는 entityGraph가 가장 효과적인 방법이 될 수 있다." ID="ID_216690015" CREATED="1618363543957" MODIFIED="1618363555736"/>
<node TEXT="그런데 여기에서도 문제가 발생하는게 entityGraph 뎁스가 더더더더더더욱이 높아질 수록" ID="ID_3410930" CREATED="1618363555949" MODIFIED="1618363601350"/>
<node TEXT="이것도 단순한 쿼리 하는데에도 시간이 소요된다는 것이다." ID="ID_854635159" CREATED="1618363603541" MODIFIED="1618363611757"/>
<node TEXT="결론은 결국 벨런스이다. 적절한 enitiyGraph 뎁스를 유지하면서 나머지는 Fetch Size를 in으로 쿼리해오는Hibernate default_batch_fetch_size을 사용하는 방법이다." ID="ID_1001322933" CREATED="1618363611981" MODIFIED="1618363677952"/>
</node>
<node TEXT="Junit돌릴시에 에러" ID="ID_1763406303" CREATED="1620905501855" MODIFIED="1620905720615" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="failed to lazily initialize a collection of role no Session junit" ID="ID_1506870372" CREATED="1620905590887" MODIFIED="1620905720607"/>
<node TEXT="이게 해당 entity의 세션이 없어서 생기는 문제이다" ID="ID_159790738" CREATED="1620905597134" MODIFIED="1620905720607"/>
<node TEXT="이걸 해결할려면 junit에서 transactional 어노테이션을 넣어주면 된다." ID="ID_1979590322" CREATED="1620905615046" MODIFIED="1620905720607"/>
</node>
</node>
<node TEXT="datasource 커스텀 yml 으로 설정 적용" FOLDED="true" POSITION="right" ID="ID_432910582" CREATED="1570220267695" MODIFIED="1621472968362" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
<node TEXT="datasource 잘 안 적용될 때" ID="ID_179807009" CREATED="1570217513818" MODIFIED="1570217526138" LINK="#ID_1428543512"/>
<node TEXT="여기서 더 필요한게 있다." ID="ID_1723667928" CREATED="1570220279808" MODIFIED="1570220282579"/>
<node TEXT="@PropertySource(value =&quot;classpath:dataSourceConfig.yml&quot;, factory=YamlPropertyLoaderFactory.class)" ID="ID_377681665" CREATED="1570220296720" MODIFIED="1570220296720"/>
<node TEXT="YamlPropertyLoaderFactory 클래스를 새로 더 만들어야 한다." ID="ID_1576111198" CREATED="1570220304591" MODIFIED="1602134177489">
<node TEXT="package com.theComments.brt.config;" ID="ID_857943319" CREATED="1570220317652" MODIFIED="1570220317652"/>
<node TEXT="import java.io.IOException;" ID="ID_1420286366" CREATED="1570220317654" MODIFIED="1570220317654"/>
<node TEXT="import java.util.List;" ID="ID_687790669" CREATED="1570220317655" MODIFIED="1570220317655"/>
<node TEXT="import org.springframework.boot.env.YamlPropertySourceLoader;" ID="ID_490235910" CREATED="1570220317657" MODIFIED="1570220317657"/>
<node TEXT="import org.springframework.core.env.PropertySource;" ID="ID_1031204556" CREATED="1570220317659" MODIFIED="1570220317659"/>
<node TEXT="import org.springframework.core.io.support.DefaultPropertySourceFactory;" ID="ID_1660608982" CREATED="1570220317660" MODIFIED="1570220317660"/>
<node TEXT="import org.springframework.core.io.support.EncodedResource;" ID="ID_34999912" CREATED="1570220317663" MODIFIED="1570220317663"/>
<node TEXT="public class YamlPropertyLoaderFactory extends DefaultPropertySourceFactory {" ID="ID_1306641141" CREATED="1570220317664" MODIFIED="1570220325729">
<node TEXT="@Override" ID="ID_424717818" CREATED="1570220317665" MODIFIED="1570220317665"/>
<node TEXT="public PropertySource&lt;?&gt; createPropertySource(String name, EncodedResource resource) throws IOException {" ID="ID_940423770" CREATED="1570220317666" MODIFIED="1570220317666">
<node TEXT="if (resource == null){" ID="ID_782567416" CREATED="1570220317687" MODIFIED="1570220317687">
<node TEXT="return super.createPropertySource(name, resource);" ID="ID_1983044446" CREATED="1570220317688" MODIFIED="1570220317688"/>
</node>
<node TEXT="}" ID="ID_1466097914" CREATED="1570220317689" MODIFIED="1570220317689"/>
<node TEXT="return new YamlPropertySourceLoader().load(resource.getResource().getFilename(), resource.getResource()).get(0);" ID="ID_1116845627" CREATED="1570220317690" MODIFIED="1570220317690"/>
</node>
<node TEXT="}" ID="ID_1470118413" CREATED="1570220317692" MODIFIED="1570220317692"/>
</node>
<node TEXT="}" ID="ID_624244484" CREATED="1570220317693" MODIFIED="1570220317693"/>
</node>
<node TEXT="전체코드" ID="ID_481032358" CREATED="1570220352455" MODIFIED="1602134173810">
<node TEXT="package com.theComments.brt.config;" ID="ID_1343343200" CREATED="1570220418706" MODIFIED="1570220418706"/>
<node TEXT="import javax.sql.DataSource;" ID="ID_1182085315" CREATED="1570220418709" MODIFIED="1570220418709"/>
<node TEXT="import org.springframework.beans.factory.annotation.Qualifier;" ID="ID_1288552317" CREATED="1570220418711" MODIFIED="1570220418711"/>
<node TEXT="import org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;" ID="ID_1440524559" CREATED="1570220418713" MODIFIED="1570220418713"/>
<node TEXT="import org.springframework.boot.context.properties.ConfigurationProperties;" ID="ID_1442416780" CREATED="1570220418715" MODIFIED="1570220418715"/>
<node TEXT="import org.springframework.boot.test.context.ConfigFileApplicationContextInitializer;" ID="ID_1661220178" CREATED="1570220418718" MODIFIED="1570220418718"/>
<node TEXT="import org.springframework.context.annotation.Bean;" ID="ID_721997296" CREATED="1570220418720" MODIFIED="1570220418720"/>
<node TEXT="import org.springframework.context.annotation.Configuration;" ID="ID_1559172874" CREATED="1570220418722" MODIFIED="1570220418722"/>
<node TEXT="import org.springframework.context.annotation.Primary;" ID="ID_1766358102" CREATED="1570220418724" MODIFIED="1570220418724"/>
<node TEXT="import org.springframework.context.annotation.PropertySource;" ID="ID_1684254564" CREATED="1570220418726" MODIFIED="1570220418726"/>
<node TEXT="import org.springframework.test.context.ContextConfiguration;" ID="ID_1881284030" CREATED="1570220418728" MODIFIED="1570220418728"/>
<node TEXT="import org.springframework.test.context.TestPropertySource;" ID="ID_637729100" CREATED="1570220418729" MODIFIED="1570220418729"/>
<node TEXT="@Configuration" ID="ID_1814282401" CREATED="1570220418731" MODIFIED="1570220418731"/>
<node TEXT="@PropertySource(value =&quot;classpath:dataSourceConfig.yml&quot;, factory=YamlPropertyLoaderFactory.class)" ID="ID_117711000" CREATED="1570220418733" MODIFIED="1570220418733"/>
<node TEXT="public class DataSourceConfig {" ID="ID_1256408520" CREATED="1570220418735" MODIFIED="1570220418735">
<node TEXT="@Bean" ID="ID_1099768729" CREATED="1570220418737" MODIFIED="1570220418737"/>
<node TEXT="@Primary" ID="ID_1620173668" CREATED="1570220418741" MODIFIED="1570220418741"/>
<node TEXT="@Qualifier(&quot;primaryDataSource&quot;)" ID="ID_1426025474" CREATED="1570220418743" MODIFIED="1570220418743"/>
<node TEXT="public DataSource primaryDataSource(DataSourceProperties properties) {" ID="ID_1665958295" CREATED="1570220418744" MODIFIED="1570220418744">
<node TEXT="return primaryDataSourceProperties().initializeDataSourceBuilder().build();" ID="ID_788140404" CREATED="1570220418746" MODIFIED="1570220418746"/>
</node>
<node TEXT="}" ID="ID_833581792" CREATED="1570220418748" MODIFIED="1570220418748"/>
<node TEXT="@Bean" ID="ID_274734231" CREATED="1570220418752" MODIFIED="1570220418752"/>
<node TEXT="@Primary" ID="ID_1631885015" CREATED="1570220418754" MODIFIED="1570220418754"/>
<node TEXT="@ConfigurationProperties(&quot;app.datasource&quot;)" ID="ID_287286992" CREATED="1570220418756" MODIFIED="1570220418756"/>
<node TEXT="public DataSourceProperties primaryDataSourceProperties() {" ID="ID_1298301840" CREATED="1570220418758" MODIFIED="1570220418758">
<node TEXT="return new DataSourceProperties();" ID="ID_305504812" CREATED="1570220418760" MODIFIED="1570220418760"/>
</node>
<node TEXT="}" ID="ID_986988225" CREATED="1570220418762" MODIFIED="1570220418762"/>
</node>
<node TEXT="}" ID="ID_1330865509" CREATED="1570220418766" MODIFIED="1570220418766"/>
</node>
<node TEXT="참조" ID="ID_705265850" CREATED="1570220353560" MODIFIED="1602134174797">
<node TEXT="https://stackoverflow.com/a/51392715" ID="ID_1369956177" CREATED="1570220408211" MODIFIED="1570220408211" LINK="https://stackoverflow.com/a/51392715"/>
</node>
</node>
<node TEXT="date는 LocalDateTime을 쓰는게 좋을 듯 하다." FOLDED="true" POSITION="right" ID="ID_1626839634" CREATED="1570379803994" MODIFIED="1621472968362" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="그냥 보안상 그거 쓰래 씨발" ID="ID_237953713" CREATED="1570381223900" MODIFIED="1570381227799"/>
</node>
<node TEXT="유닛 테스트 할 때" FOLDED="true" POSITION="right" ID="ID_438936036" CREATED="1570398499501" MODIFIED="1621472968362">
<node TEXT="문제" ID="ID_160186925" CREATED="1570398518920" MODIFIED="1570398525097">
<node TEXT="java.lang.IllegalStateException: Unable to find a @SpringBootConfiguration, you need to use @ContextConfiguration or @SpringBootTest(classes=...) with your test" ID="ID_1790794922" CREATED="1570398509065" MODIFIED="1570398509065"/>
</node>
<node TEXT="해결" ID="ID_348925721" CREATED="1570398525277" MODIFIED="1570398525801">
<node TEXT="https://stackoverflow.com/questions/39084491/unable-to-find-a-springbootconfiguration-when-doing-a-jpatest" ID="ID_1502695658" CREATED="1570398527152" MODIFIED="1570398527152" LINK="https://stackoverflow.com/questions/39084491/unable-to-find-a-springbootconfiguration-when-doing-a-jpatest"/>
<node TEXT="@SpringBootTest(classes=DemoApplication.class)" ID="ID_1279156131" CREATED="1570403172570" MODIFIED="1570403172570"/>
<node TEXT="그냥 main에 있는 application class를 불러오는 것으로 해결" ID="ID_1105931799" CREATED="1570403173536" MODIFIED="1570403189396"/>
</node>
</node>
<node TEXT="auth provider에서 exceptiopn 추가하는 것" FOLDED="true" POSITION="right" ID="ID_1141662290" CREATED="1571160783050" MODIFIED="1621472968362">
<node TEXT="throw new BadCredentialsException(&quot;4012:유저가 존재하지않습니다.&quot;);" ID="ID_490531665" CREATED="1571160915022" MODIFIED="1571160915974"/>
<node TEXT="BadCredentialsException를 사용하면 된다." ID="ID_101541636" CREATED="1571160924132" MODIFIED="1571160932151"/>
</node>
<node TEXT="스프링 hasRole" FOLDED="true" POSITION="right" ID="ID_262655461" CREATED="1571698355969" MODIFIED="1621472968362" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://stackoverflow.com/questions/33638850/how-to-protect-spring-security-oauth-resources-using-preauthorize-based-on-scop" ID="ID_289980568" CREATED="1571708383301" MODIFIED="1571708383301" LINK="https://stackoverflow.com/questions/33638850/how-to-protect-spring-security-oauth-resources-using-preauthorize-based-on-scop"/>
<node TEXT="https://www.baeldung.com/rest-api-spring-oauth2-angular" ID="ID_1120552909" CREATED="1571708478450" MODIFIED="1571708478450" LINK="https://www.baeldung.com/rest-api-spring-oauth2-angular"/>
<node TEXT="wonwoo.ml &gt; Index.php &gt; Post &gt; 1284#" ID="ID_1959402218" CREATED="1571708534085" MODIFIED="1571708534085" LINK="http://wonwoo.ml/index.php/post/1284#"/>
<node TEXT="oauth2 기반으로 hasRole등을 이용하려면 기본적으로 ResourceServer를 enable 시켜야만 한다." FOLDED="true" ID="ID_1343858916" CREATED="1571708544606" MODIFIED="1607565846542">
<node TEXT="@Configuration" ID="ID_1413400772" CREATED="1571708851560" MODIFIED="1571708877575"/>
<node TEXT="@EnableAuthorizationServer" ID="ID_1118766507" CREATED="1571708851560" MODIFIED="1571708877576"/>
<node TEXT="@EnableResourceServer" ID="ID_1144846898" CREATED="1571708851561" MODIFIED="1571708877576" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="public class Oauth2Config extends AuthorizationServerConfigurerAdapter {" ID="ID_557460831" CREATED="1571708851561" MODIFIED="1571708877577"/>
</node>
<node TEXT="그리고 expressionHandler를 oauth2에 맞게 설정해야 한다." FOLDED="true" ID="ID_1373811003" CREATED="1571708721047" MODIFIED="1620638889175">
<node TEXT="package com.theComments.brt.config;" ID="ID_803941544" CREATED="1571708891020" MODIFIED="1571708891020"/>
<node TEXT="import org.springframework.context.annotation.Configuration;" ID="ID_1861049711" CREATED="1571708891022" MODIFIED="1571708891022"/>
<node TEXT="import org.springframework.security.access.expression.method.MethodSecurityExpressionHandler;" ID="ID_1913503032" CREATED="1571708891024" MODIFIED="1571708891024"/>
<node TEXT="import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;" ID="ID_916648922" CREATED="1571708891025" MODIFIED="1571708891025"/>
<node TEXT="import org.springframework.security.config.annotation.method.configuration.GlobalMethodSecurityConfiguration;" ID="ID_529314995" CREATED="1571708891027" MODIFIED="1571708891027"/>
<node TEXT="import org.springframework.security.oauth2.provider.expression.OAuth2MethodSecurityExpressionHandler;" ID="ID_647758385" CREATED="1571708891033" MODIFIED="1571708891033"/>
<node TEXT="@Configuration" ID="ID_787242391" CREATED="1571708891037" MODIFIED="1571708891037"/>
<node TEXT="@EnableGlobalMethodSecurity(prePostEnabled = true)" ID="ID_1025864431" CREATED="1571708891038" MODIFIED="1571708891038"/>
<node TEXT="public class Oauth2ResourceServer extends GlobalMethodSecurityConfiguration{" ID="ID_341011014" CREATED="1571708891039" MODIFIED="1571708891039">
<node TEXT="@Override" ID="ID_1976499265" CREATED="1571708891041" MODIFIED="1571708891041"/>
<node TEXT="protected MethodSecurityExpressionHandler createExpressionHandler() {" ID="ID_114696690" CREATED="1571708891043" MODIFIED="1571708891043">
<node TEXT="// TODO Auto-generated method stub" ID="ID_143021259" CREATED="1571708891044" MODIFIED="1571708891044"/>
<node TEXT="return new OAuth2MethodSecurityExpressionHandler();" ID="ID_1057165681" CREATED="1571708891046" MODIFIED="1571708891046"/>
</node>
<node TEXT="}" ID="ID_1860318367" CREATED="1571708891047" MODIFIED="1571708891047"/>
</node>
<node TEXT="}" ID="ID_1813480067" CREATED="1571708891048" MODIFIED="1571708891048"/>
</node>
<node TEXT="그리고 다음과 같은 hasRole을 사용하면 된다." FOLDED="true" ID="ID_124355083" CREATED="1571708771215" MODIFIED="1620638889747">
<node TEXT="package com.theComments.brt.app.type.controller;" ID="ID_1107830715" CREATED="1571708952300" MODIFIED="1571708952300"/>
<node TEXT="import java.util.List;" ID="ID_1909523418" CREATED="1571708952301" MODIFIED="1571708952301"/>
<node TEXT="import java.util.Map;" ID="ID_1465930584" CREATED="1571708952301" MODIFIED="1571708952301"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_1650679545" CREATED="1571708952302" MODIFIED="1571708952302"/>
<node TEXT="import org.springframework.security.access.prepost.PreAuthorize;" ID="ID_91743844" CREATED="1571708952303" MODIFIED="1571708952303"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestMapping;" ID="ID_1605038137" CREATED="1571708952303" MODIFIED="1571708952303"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestMethod;" ID="ID_1361168172" CREATED="1571708952304" MODIFIED="1571708952304"/>
<node TEXT="import org.springframework.web.bind.annotation.RestController;" ID="ID_353741260" CREATED="1571708952305" MODIFIED="1571708952305"/>
<node TEXT="import com.theComments.brt.jpa.theComment.dao.Type1_dao;" ID="ID_1401659669" CREATED="1571708952305" MODIFIED="1571708952305"/>
<node TEXT="import com.theComments.brt.jpa.theComment.dao.Type2_dao;" ID="ID_1232423680" CREATED="1571708952306" MODIFIED="1571708952306"/>
<node TEXT="import com.theComments.brt.jpa.theComment.model.Type1;" ID="ID_1789506039" CREATED="1571708952307" MODIFIED="1571708952307"/>
<node TEXT="import com.theComments.brt.jpa.theComment.model.Type2;" ID="ID_1699564906" CREATED="1571708952307" MODIFIED="1571708952307"/>
<node TEXT="@RestController" ID="ID_507281350" CREATED="1571708952308" MODIFIED="1571708952308"/>
<node TEXT="@RequestMapping(&quot;/v1/type&quot;)" ID="ID_59712476" CREATED="1571708952308" MODIFIED="1571708952308"/>
<node TEXT="public class TypeController {" ID="ID_860746335" CREATED="1571708952309" MODIFIED="1571708952309">
<node TEXT="@Autowired" ID="ID_1387063673" CREATED="1571708952310" MODIFIED="1571708952310"/>
<node TEXT="Type1_dao type1_dao;" ID="ID_463900904" CREATED="1571708952310" MODIFIED="1571708952310"/>
<node TEXT="@PreAuthorize(&quot;hasRole(&apos;ROLE_COMMON_USER&apos;)&quot;)" ID="ID_1422076418" CREATED="1571708952311" MODIFIED="1571708990489" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="@RequestMapping(value = &quot;/getWorkAllType&quot;,method = RequestMethod.GET)" ID="ID_1003511462" CREATED="1571708952311" MODIFIED="1571708952311"/>
<node TEXT="public List&lt;Type1&gt; getWorkType(){" ID="ID_1913355517" CREATED="1571708952312" MODIFIED="1571708952312">
<node TEXT="List&lt;Type1&gt; list = type1_dao.getAllType();" ID="ID_439222877" CREATED="1571708952312" MODIFIED="1571708952312"/>
<node TEXT="return list;" ID="ID_1553515450" CREATED="1571708952313" MODIFIED="1571708952313"/>
</node>
<node TEXT="}" ID="ID_1728512277" CREATED="1571708952314" MODIFIED="1571708952314"/>
</node>
<node TEXT="}" ID="ID_1730828086" CREATED="1571708952314" MODIFIED="1571708952314"/>
</node>
<node TEXT="여기서 사용한 것은 hasRole이지만, oauth2에서 자주 사용하고 고유로 사용가능한 #oauth2.hasScope도 사용가능하다." ID="ID_1945543471" CREATED="1571709418511" MODIFIED="1571709613227"/>
<node TEXT="그러나 리소스 서버를 새로 만다는 것이 더 관리하기 편하고 좋을 것" ID="ID_1353658333" CREATED="1571877345765" MODIFIED="1571877435713" LINK="#ID_1467899237"/>
</node>
<node TEXT="json으로 변환하는 과정에서 문제가 발생하는 것" FOLDED="true" POSITION="right" ID="ID_1771803787" CREATED="1571712762544" MODIFIED="1621472968362" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://dublin-java.tistory.com/32" ID="ID_1658910303" CREATED="1571712769986" MODIFIED="1571721968954" LINK="https://dublin-java.tistory.com/32"/>
<node TEXT="문제는 무한루프" ID="ID_244246033" CREATED="1571712775628" MODIFIED="1571721968956"/>
<node TEXT="그냥 dto를 만들어라" ID="ID_1236186919" CREATED="1571712778652" MODIFIED="1571721968957"/>
<node TEXT="https://www.baeldung.com/entity-to-and-from-dto-for-a-java-spring-application" ID="ID_1575699448" CREATED="1571712787000" MODIFIED="1571721968957" LINK="https://www.baeldung.com/entity-to-and-from-dto-for-a-java-spring-application"/>
<node TEXT="Entity가 가지고 있는 점은 계속해서 쿼리가 가능하다는 점이다." ID="ID_309070323" CREATED="1571721972628" MODIFIED="1571722259145"/>
<node TEXT="따라서 그거가지고 데이터를 보내거나 받으면 무한적으로 쿼리가 일어날 수 있으며, 그로 인한 json 변환이 거의 불가능한 수준이다." ID="ID_582454150" CREATED="1571722271694" MODIFIED="1571722390138"/>
<node TEXT="데이터를 받을 때는 마음데로이나, 리턴할때는 마음데로가 아니라는 것" ID="ID_530451705" CREATED="1571722390381" MODIFIED="1571722400626"/>
<node TEXT="따라서 DTO를 사용해야만 한다." ID="ID_1524617429" CREATED="1571722407198" MODIFIED="1571722412929"/>
<node TEXT="코드" FOLDED="true" ID="ID_695675355" CREATED="1571722413644" MODIFIED="1607565850492">
<node TEXT="dto 사용 총 코드" FOLDED="true" ID="ID_185848486" CREATED="1571722415973" MODIFIED="1591755671339">
<node TEXT="@RequestMapping(value = &quot;/getWorkAllType&quot;,method = RequestMethod.GET)" ID="ID_459519029" CREATED="1571722428551" MODIFIED="1571722428551">
<node TEXT="public List&lt;Type1Dto&gt; getWorkType(){" ID="ID_1086796406" CREATED="1571722428552" MODIFIED="1571722428552"/>
</node>
<node TEXT="//                List&lt;Type1&gt; list = type1_dao.getAllType();" ID="ID_590625241" CREATED="1571722428553" MODIFIED="1571722428553">
<node TEXT="List&lt;Type1&gt; type1List = type1_dao.findAll();" ID="ID_72920708" CREATED="1571722428554" MODIFIED="1571722428554"/>
<node TEXT="List&lt;Type1Dto&gt; type1dtoList = new ArrayList&lt;Type1Dto&gt;();" ID="ID_1911199257" CREATED="1571722428555" MODIFIED="1571722428555"/>
<node TEXT="for(Type1 type : type1List) {" ID="ID_1973177132" CREATED="1571722428556" MODIFIED="1571722428556">
<node TEXT="Type1Dto type1dto = new Type1Dto();" ID="ID_729793176" CREATED="1571722428557" MODIFIED="1571722428557"/>
<node TEXT="BeanUtils.copyProperties(type, type1dto);" ID="ID_720392458" CREATED="1571722428557" MODIFIED="1571722428557"/>
<node TEXT="List&lt;Type2&gt; type2List = type.getType2();" ID="ID_601590472" CREATED="1571722428558" MODIFIED="1571722428558"/>
<node TEXT="List&lt;Type2Dto&gt; dto2List = new ArrayList&lt;Type2Dto&gt;();" ID="ID_89333373" CREATED="1571722428559" MODIFIED="1571722428559"/>
<node TEXT="for(Type2 type2 : type2List) {" ID="ID_1700896859" CREATED="1571722428560" MODIFIED="1571722428560">
<node TEXT="Type2Dto dto2 = new Type2Dto();" ID="ID_1208515615" CREATED="1571722428560" MODIFIED="1571722428560"/>
<node TEXT="BeanUtils.copyProperties(type2, dto2);" ID="ID_1914041381" CREATED="1571722428561" MODIFIED="1571722428561"/>
<node TEXT="dto2List.add(dto2);" ID="ID_625515087" CREATED="1571722428562" MODIFIED="1571722428562"/>
</node>
<node TEXT="}" ID="ID_315559973" CREATED="1571722428563" MODIFIED="1571722428563"/>
<node TEXT="type1dto.setType2Dto(dto2List);" ID="ID_771209307" CREATED="1571722428564" MODIFIED="1571722428564"/>
<node TEXT="type1dtoList.add(type1dto);" ID="ID_950042475" CREATED="1571722428565" MODIFIED="1571722428565"/>
</node>
<node TEXT="}" ID="ID_659978640" CREATED="1571722428566" MODIFIED="1571722428566"/>
<node TEXT="return type1dtoList;" ID="ID_21140365" CREATED="1571722428566" MODIFIED="1571722428566"/>
<node TEXT="}" ID="ID_1699228404" CREATED="1571722428567" MODIFIED="1571722428567"/>
</node>
</node>
<node TEXT="dto1" FOLDED="true" ID="ID_1329744328" CREATED="1571722430365" MODIFIED="1591755671339">
<node TEXT="package com.theComments.brt.jpa.dto;" ID="ID_1207936884" CREATED="1571722440262" MODIFIED="1571722440262"/>
<node TEXT="import java.util.List;" ID="ID_1588087079" CREATED="1571722440269" MODIFIED="1571722440269"/>
<node TEXT="import javax.persistence.GeneratedValue;" ID="ID_1384177975" CREATED="1571722440271" MODIFIED="1571722440271"/>
<node TEXT="import javax.persistence.GenerationType;" ID="ID_571013838" CREATED="1571722440272" MODIFIED="1571722440272"/>
<node TEXT="import javax.persistence.Id;" ID="ID_1558951602" CREATED="1571722440275" MODIFIED="1571722440275"/>
<node TEXT="import javax.persistence.OneToMany;" ID="ID_87827116" CREATED="1571722440277" MODIFIED="1571722440277"/>
<node TEXT="import com.theComments.brt.jpa.theComment.model.Type2;" ID="ID_561084475" CREATED="1571722440278" MODIFIED="1571722440278"/>
<node TEXT="import lombok.Getter;" ID="ID_369973505" CREATED="1571722440281" MODIFIED="1571722440281"/>
<node TEXT="import lombok.Setter;" ID="ID_850959054" CREATED="1571722440282" MODIFIED="1571722440282"/>
<node TEXT="@Getter" ID="ID_1794581336" CREATED="1571722440284" MODIFIED="1571722440284"/>
<node TEXT="@Setter" ID="ID_990785414" CREATED="1571722440285" MODIFIED="1571722440285"/>
<node TEXT="public class Type1Dto {" ID="ID_844673624" CREATED="1571722440286" MODIFIED="1571722440286">
<node TEXT="Long type1_id;" ID="ID_1195845058" CREATED="1571722440287" MODIFIED="1571722440287"/>
<node TEXT="String type1_name;" ID="ID_3458475" CREATED="1571722440288" MODIFIED="1571722440288"/>
<node TEXT="List&lt;Type2Dto&gt; type2Dto;" ID="ID_1877321767" CREATED="1571722440288" MODIFIED="1571722440288"/>
</node>
<node TEXT="}" ID="ID_766851049" CREATED="1571722440290" MODIFIED="1571722440290"/>
</node>
<node TEXT="dto2" ID="ID_1523970900" CREATED="1571722457525" MODIFIED="1591755681077">
<node TEXT="package com.theComments.brt.jpa.dto;" ID="ID_1447631322" CREATED="1571722460142" MODIFIED="1571722460142"/>
<node TEXT="import java.util.List;" ID="ID_1929832543" CREATED="1571722460142" MODIFIED="1571722460142"/>
<node TEXT="import javax.persistence.FetchType;" ID="ID_92001094" CREATED="1571722460143" MODIFIED="1571722460143"/>
<node TEXT="import javax.persistence.JoinColumn;" ID="ID_1516079580" CREATED="1571722460143" MODIFIED="1571722460143"/>
<node TEXT="import javax.persistence.ManyToOne;" ID="ID_212175296" CREATED="1571722460144" MODIFIED="1571722460144"/>
<node TEXT="import javax.persistence.OneToMany;" ID="ID_1339390646" CREATED="1571722460144" MODIFIED="1571722460144"/>
<node TEXT="import com.theComments.brt.jpa.theComment.model.Type1;" ID="ID_1183923418" CREATED="1571722460144" MODIFIED="1571722460144"/>
<node TEXT="import com.theComments.brt.jpa.theComment.model.Works;" ID="ID_1807552465" CREATED="1571722460145" MODIFIED="1571722460145"/>
<node TEXT="import lombok.Getter;" ID="ID_535366587" CREATED="1571722460145" MODIFIED="1571722460145"/>
<node TEXT="import lombok.Setter;" ID="ID_81624390" CREATED="1571722460145" MODIFIED="1571722460145"/>
<node TEXT="@Getter" ID="ID_1842065416" CREATED="1571722460146" MODIFIED="1571722460146"/>
<node TEXT="@Setter" ID="ID_229104676" CREATED="1571722460146" MODIFIED="1571722460146"/>
<node TEXT="public class Type2Dto {" ID="ID_1515076465" CREATED="1571722460146" MODIFIED="1571722460146">
<node TEXT="Long type2_id;" ID="ID_840542456" CREATED="1571722460146" MODIFIED="1571722460146"/>
<node TEXT="String type2_name;" ID="ID_1046864093" CREATED="1571722460147" MODIFIED="1571722460147"/>
<node TEXT="Type1Dto type1Dto;" ID="ID_287899626" CREATED="1571722460147" MODIFIED="1571722460147"/>
</node>
<node TEXT="}" ID="ID_1835133549" CREATED="1571722460147" MODIFIED="1571722460147"/>
</node>
</node>
<node TEXT="프로퍼티를 옮겨주는 BeanUtils.copyProperties(type, type1dto); 를 주로 사용" ID="ID_1396116921" CREATED="1571722471300" MODIFIED="1571722485466" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
</node>
<node TEXT="롬보크 getter, setter anotation" FOLDED="true" POSITION="right" ID="ID_984864797" CREATED="1571717577328" MODIFIED="1621472968362" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="롬보크 설치" ID="ID_170102541" CREATED="1571718838487" MODIFIED="1571718841067">
<node TEXT="https://stackoverflow.com/questions/11803948/lombok-is-not-generating-getter-and-setter" ID="ID_157296786" CREATED="1571718841312" MODIFIED="1571718841312" LINK="https://stackoverflow.com/questions/11803948/lombok-is-not-generating-getter-and-setter"/>
</node>
<node TEXT="&lt;!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --&gt;" ID="ID_503968350" CREATED="1571717605181" MODIFIED="1571717605181" LINK="https://mvnrepository.com/artifact/org.projectlombok/lombok"/>
<node TEXT="&lt;dependency&gt;" ID="ID_614173103" CREATED="1571717605190" MODIFIED="1571717605190">
<node TEXT="&lt;groupId&gt;org.projectlombok&lt;/groupId&gt;" ID="ID_700559918" CREATED="1571717605190" MODIFIED="1571717605190"/>
<node TEXT="&lt;artifactId&gt;lombok&lt;/artifactId&gt;" ID="ID_296465891" CREATED="1571717605191" MODIFIED="1571717605191"/>
<node TEXT="&lt;version&gt;1.18.10&lt;/version&gt;" ID="ID_34805379" CREATED="1571717605192" MODIFIED="1571717605192"/>
<node TEXT="&lt;scope&gt;provided&lt;/scope&gt;" ID="ID_1068053404" CREATED="1571717605193" MODIFIED="1571717605193"/>
</node>
<node TEXT="&lt;/dependency&gt;" ID="ID_1429186272" CREATED="1571717605194" MODIFIED="1571717605194"/>
<node TEXT="롬보그 오류 서클" ID="ID_283196507" CREATED="1602502869327" MODIFIED="1602502873461">
<node TEXT="https://stackoverflow.com/questions/34972895/lombok-hashcode-issue-with-java-lang-stackoverflowerror-null" ID="ID_248673224" CREATED="1602502873916" MODIFIED="1602502873916" LINK="https://stackoverflow.com/questions/34972895/lombok-hashcode-issue-with-java-lang-stackoverflowerror-null"/>
</node>
<node TEXT="com.sun.jdi.InvocationException occurred invoking method" ID="ID_501289368" CREATED="1602508959592" MODIFIED="1620902861004">
<node TEXT="https://danha.tistory.com/entry/comsunjdiInvocationException-occurred-invoking-method" ID="ID_1802162914" CREATED="1602508962538" MODIFIED="1602508962538" LINK="https://danha.tistory.com/entry/comsunjdiInvocationException-occurred-invoking-method"/>
<node TEXT="https://m.blog.naver.com/PostView.nhn?blogId=youreme&amp;logNo=110180497870&amp;proxyReferer=https:%2F%2Fwww.google.com%2F" ID="ID_510136239" CREATED="1602509110209" MODIFIED="1602509110209" LINK="https://m.blog.naver.com/PostView.nhn?blogId=youreme&amp;logNo=110180497870&amp;proxyReferer=https:%2F%2Fwww.google.com%2F"/>
</node>
</node>
<node TEXT="파일 업로드" FOLDED="true" POSITION="right" ID="ID_972640670" CREATED="1571853506002" MODIFIED="1621472968362" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://www.baeldung.com/spring-file-upload" ID="ID_1317669666" CREATED="1571853523778" MODIFIED="1571853524970" LINK="https://www.baeldung.com/spring-file-upload"/>
<node TEXT="The field fileList exceeds its maximum permitted size of 1048576 bytes." ID="ID_1051656455" CREATED="1571853446227" MODIFIED="1571853452420"/>
<node TEXT="기본적으로 file upload size는 1mb이다." ID="ID_964782129" CREATED="1571853458331" MODIFIED="1571853495815"/>
</node>
<node TEXT="정규표혀식 케이스" FOLDED="true" POSITION="right" ID="ID_1830902921" CREATED="1571871623507" MODIFIED="1621472968362">
<node TEXT="https://stackoverflow.com/questions/3436118/is-java-regex-case-insensitive" ID="ID_1744715019" CREATED="1571871640472" MODIFIED="1571871640472" LINK="https://stackoverflow.com/questions/3436118/is-java-regex-case-insensitive"/>
</node>
<node TEXT="json to map" FOLDED="true" POSITION="right" ID="ID_1823777567" CREATED="1571880395284" MODIFIED="1621475788827">
<node TEXT="https://stackoverflow.com/questions/2525042/how-to-convert-a-json-string-to-a-mapstring-string-with-jackson-json" ID="ID_1856075071" CREATED="1571880398344" MODIFIED="1571880398344" LINK="https://stackoverflow.com/questions/2525042/how-to-convert-a-json-string-to-a-mapstring-string-with-jackson-json"/>
</node>
<node TEXT="LocalDateTime 현재시간" FOLDED="true" POSITION="right" ID="ID_1056616026" CREATED="1572219203831" MODIFIED="1621472968362" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="static now 함수 쓰면됨" ID="ID_518998083" CREATED="1572219213550" MODIFIED="1572219219882"/>
<node TEXT="java2s.com &gt; Tutorials &gt; Java &gt; Java.time &gt; LocalDateTime &gt; 2720  LocalDateTime.now " ID="ID_687011930" CREATED="1572219224517" MODIFIED="1572219224517" LINK="http://www.java2s.com/Tutorials/Java/java.time/LocalDateTime/2720__LocalDateTime.now_.htm"/>
</node>
<node TEXT="이중화" FOLDED="true" POSITION="right" ID="ID_1119846524" CREATED="1572267945538" MODIFIED="1621472968362">
<node TEXT="kimstar.kr &gt; Blog &gt; Wp-content &gt; Uploads &gt; 2014 &gt; 11 &gt; %EC%84%9C%EB%B2%84%EC%9D%B4%EC%A4%91%ED%99%94" ID="ID_1208354937" CREATED="1572267953211" MODIFIED="1572267953211" LINK="http://kimstar.kr/blog/wp-content/uploads/2014/11/%EC%84%9C%EB%B2%84%EC%9D%B4%EC%A4%91%ED%99%94.pdf"/>
</node>
<node TEXT="h2 db 이용" FOLDED="true" POSITION="right" ID="ID_300728890" CREATED="1572404906276" MODIFIED="1621472968362" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="이걸 왜 쓰냐고?" ID="ID_590439867" CREATED="1572406006150" MODIFIED="1572406008321"/>
<node TEXT="h2 인 메모리 또는 하드디스크에 대충 db를 테스트 용도로 저장하여 사용할 수도 있도록 만든 것이다." ID="ID_1345278460" CREATED="1572406008642" MODIFIED="1572406033527"/>
<node TEXT="https://www.baeldung.com/spring-boot-h2-database" ID="ID_348922568" CREATED="1572404984832" MODIFIED="1572404984832" LINK="https://www.baeldung.com/spring-boot-h2-database"/>
<node TEXT="여기서 runtime으로 maven을 받아서 하며" ID="ID_1360103542" CREATED="1572405996029" MODIFIED="1572406051372"/>
<node TEXT="h2database.com &gt; Html &gt; Download" ID="ID_1575810914" CREATED="1572406211353" MODIFIED="1572406211353" LINK="http://www.h2database.com/html/download.html"/>
<node TEXT="여기서 h2 console을 받아서 실행하여 file을 설정하는게 좋다." ID="ID_199960136" CREATED="1572406212174" MODIFIED="1572406224318"/>
<node TEXT="여기서 jpa dialect도 변경해주는게 좋다." ID="ID_1331994040" CREATED="1572406267799" MODIFIED="1572407000687"/>
</node>
<node TEXT="초기화" FOLDED="true" POSITION="right" ID="ID_420221064" CREATED="1572406229981" MODIFIED="1621472968362">
<node TEXT="처음 db를 설정 할 때 flyway를 먼저 설정한다." ID="ID_1262452847" CREATED="1572406232148" MODIFIED="1572406257433"/>
<node TEXT="그래서 기본 고정적 값은 jpa에서 테이블을 만들 때 제대로 실행이 안되는게 있다." ID="ID_958386274" CREATED="1572406257615" MODIFIED="1572406484057"/>
<node TEXT="이런 상황일 때 할 수 있는 방법은 flyway의 sql을 모두 내리거나 옮기는 것이다." ID="ID_139331266" CREATED="1572406501080" MODIFIED="1572406611189" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="그냥 flyway에 고정적인 create Table도 하나의 방법일 듯 하다." ID="ID_1503836525" CREATED="1572406614998" MODIFIED="1572406627611"/>
</node>
<node TEXT="hikari Datasource setting(total connection pool 을 설정하기 위해서)" FOLDED="true" POSITION="right" ID="ID_1663310988" CREATED="1572590212509" MODIFIED="1621472968362" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="hikari 맥락" ID="ID_221554811" CREATED="1572593223833" MODIFIED="1572593249908" LINK="#ID_1880450760"/>
<node TEXT="기본적으로 spring boot 2 서부터는 HikariDatasource를 강제적으로 적용한다." ID="ID_1695977513" CREATED="1572593253367" MODIFIED="1572593474382" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="그런것도 있고 total connection pool이라고 해서 pool size를 설정해야 하는게 있는데 그게 java에서 설정이 가능하다." ID="ID_1956569313" CREATED="1572593478837" MODIFIED="1572593665072" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
<node TEXT="암튼 다음과 같이 설정한다." FOLDED="true" ID="ID_1055173411" CREATED="1572593672462" MODIFIED="1594169114262">
<node TEXT="@Bean" ID="ID_518185887" CREATED="1572593684717" MODIFIED="1572593684717">
<node TEXT="@Primary" ID="ID_1498221431" CREATED="1572593684719" MODIFIED="1572593684719"/>
<node TEXT="@Qualifier(&quot;primaryDataSource&quot;)" ID="ID_546778548" CREATED="1572593684720" MODIFIED="1572593684720"/>
<node TEXT="public HikariDataSource primaryDataSource() {" ID="ID_1915557944" CREATED="1572593684720" MODIFIED="1572593684720">
<node TEXT="HikariConfig hsc = new HikariConfig();" ID="ID_1716339978" CREATED="1572593684722" MODIFIED="1572593684722"/>
<node TEXT="hsc.setUsername(primaryDataSourceProperties().getUsername());" ID="ID_928912656" CREATED="1572593684723" MODIFIED="1572593684723"/>
<node TEXT="hsc.setPassword(primaryDataSourceProperties().getPassword());" ID="ID_1428924197" CREATED="1572593684724" MODIFIED="1572593684724"/>
<node TEXT="hsc.setDriverClassName(primaryDataSourceProperties().getDriverClassName());" ID="ID_1284779576" CREATED="1572593684725" MODIFIED="1572593684725"/>
<node TEXT="hsc.setJdbcUrl(primaryDataSourceProperties().getUrl());" ID="ID_1124172020" CREATED="1572593684726" MODIFIED="1572593684726"/>
<node TEXT="hsc.setMaximumPoolSize(20);" ID="ID_1864444996" CREATED="1572593684727" MODIFIED="1572593684727"/>
<node TEXT="HikariDataSource hs = new HikariDataSource(hsc);" ID="ID_1505336984" CREATED="1572593684728" MODIFIED="1572593684728"/>
<node TEXT="return hs;" ID="ID_1182171128" CREATED="1572593684729" MODIFIED="1572593684729"/>
</node>
<node TEXT="}" ID="ID_1140613571" CREATED="1572593684730" MODIFIED="1572593684730"/>
</node>
</node>
<node TEXT="전체코드" FOLDED="true" ID="ID_667819759" CREATED="1572593686029" MODIFIED="1620638890331">
<node TEXT="package com.theComments.brt.config;" ID="ID_219462110" CREATED="1572593691739" MODIFIED="1572593691739"/>
<node TEXT="import javax.sql.DataSource;" ID="ID_591072327" CREATED="1572593691739" MODIFIED="1572593691739"/>
<node TEXT="import org.apache.commons.dbcp2.BasicDataSource;" ID="ID_1422211523" CREATED="1572593691740" MODIFIED="1572593691740"/>
<node TEXT="import org.springframework.beans.factory.annotation.Qualifier;" ID="ID_1729587014" CREATED="1572593691741" MODIFIED="1572593691741"/>
<node TEXT="import org.springframework.boot.autoconfigure.jdbc.DataSourceProperties;" ID="ID_324348530" CREATED="1572593691742" MODIFIED="1572593691742"/>
<node TEXT="import org.springframework.boot.context.properties.ConfigurationProperties;" ID="ID_116807448" CREATED="1572593691743" MODIFIED="1572593691743"/>
<node TEXT="import org.springframework.context.annotation.Bean;" ID="ID_563522283" CREATED="1572593691743" MODIFIED="1572593691743"/>
<node TEXT="import org.springframework.context.annotation.Configuration;" ID="ID_262453826" CREATED="1572593691744" MODIFIED="1572593691744"/>
<node TEXT="import org.springframework.context.annotation.Primary;" ID="ID_697607785" CREATED="1572593691745" MODIFIED="1572593691745"/>
<node TEXT="import org.springframework.context.annotation.PropertySource;" ID="ID_217109758" CREATED="1572593691746" MODIFIED="1572593691746"/>
<node TEXT="import com.zaxxer.hikari.HikariConfig;" ID="ID_257349755" CREATED="1572593691746" MODIFIED="1572593691746"/>
<node TEXT="import com.zaxxer.hikari.HikariDataSource;" ID="ID_193236455" CREATED="1572593691747" MODIFIED="1572593691747"/>
<node TEXT="@Configuration" ID="ID_208658018" CREATED="1572593691748" MODIFIED="1572593691748"/>
<node TEXT="@PropertySource(value =&quot;classpath:dataSourceConfig.yml&quot;, factory=YamlPropertyLoaderFactory.class)" ID="ID_1665702516" CREATED="1572593691748" MODIFIED="1572593691748"/>
<node TEXT="public class DataSourceConfig {" ID="ID_1364215508" CREATED="1572593691749" MODIFIED="1572593691749">
<node TEXT="@Bean" ID="ID_1513129909" CREATED="1572593691749" MODIFIED="1572593691749"/>
<node TEXT="@Primary" ID="ID_1131839594" CREATED="1572593691750" MODIFIED="1572593691750"/>
<node TEXT="@Qualifier(&quot;primaryDataSource&quot;)" ID="ID_778200959" CREATED="1572593691751" MODIFIED="1572593691751"/>
<node TEXT="public HikariDataSource primaryDataSource() {" ID="ID_1968354563" CREATED="1572593691752" MODIFIED="1572593691752">
<node TEXT="HikariConfig hsc = new HikariConfig();" ID="ID_1224532005" CREATED="1572593691753" MODIFIED="1572593691753"/>
<node TEXT="hsc.setUsername(primaryDataSourceProperties().getUsername());" ID="ID_220627672" CREATED="1572593691754" MODIFIED="1572593691754"/>
<node TEXT="hsc.setPassword(primaryDataSourceProperties().getPassword());" ID="ID_1309092475" CREATED="1572593691755" MODIFIED="1572593691755"/>
<node TEXT="hsc.setDriverClassName(primaryDataSourceProperties().getDriverClassName());" ID="ID_1509194957" CREATED="1572593691756" MODIFIED="1572593691756"/>
<node TEXT="hsc.setJdbcUrl(primaryDataSourceProperties().getUrl());" ID="ID_1029619116" CREATED="1572593691756" MODIFIED="1572593691756"/>
<node TEXT="hsc.setMaximumPoolSize(20);" ID="ID_1939818492" CREATED="1572593691757" MODIFIED="1572593691757"/>
<node TEXT="HikariDataSource hs = new HikariDataSource(hsc);" ID="ID_1503575528" CREATED="1572593691758" MODIFIED="1572593691758"/>
<node TEXT="return hs;" ID="ID_494424710" CREATED="1572593691759" MODIFIED="1572593691759"/>
</node>
<node TEXT="}" ID="ID_601788488" CREATED="1572593691759" MODIFIED="1572593691759"/>
<node TEXT="@Bean" ID="ID_1097711495" CREATED="1572593691759" MODIFIED="1572593691759"/>
<node TEXT="@Primary" ID="ID_1826083600" CREATED="1572593691760" MODIFIED="1572593691760"/>
<node TEXT="@ConfigurationProperties(&quot;app.datasource&quot;)" ID="ID_556314631" CREATED="1572593691761" MODIFIED="1572593691761"/>
<node TEXT="public DataSourceProperties primaryDataSourceProperties() {" ID="ID_1476148064" CREATED="1572593691761" MODIFIED="1572593691761">
<node TEXT="return new DataSourceProperties();" ID="ID_1106957651" CREATED="1572593691761" MODIFIED="1572593691761"/>
</node>
<node TEXT="}" ID="ID_1127306747" CREATED="1572593691762" MODIFIED="1572593691762"/>
</node>
<node TEXT="}" ID="ID_1878590433" CREATED="1572593691762" MODIFIED="1572593691762"/>
</node>
</node>
<node TEXT="resource handler (Serve Static Resources with Spring)" FOLDED="true" POSITION="right" ID="ID_828291702" CREATED="1573370409099" MODIFIED="1621472968362">
<node TEXT="https://www.baeldung.com/spring-mvc-static-resources" ID="ID_1873575239" CREATED="1573370417073" MODIFIED="1573370417073" LINK="https://www.baeldung.com/spring-mvc-static-resources"/>
<node TEXT="https://stackoverflow.com/questions/27538608/spring-code-config-addresourcelocations-on-disk" ID="ID_760457895" CREATED="1573372034788" MODIFIED="1573372034788" LINK="https://stackoverflow.com/questions/27538608/spring-code-config-addresourcelocations-on-disk"/>
<node TEXT="https://stackoverflow.com/questions/32287982/spring-boot-custom-static-resource-location-outside-of-project" ID="ID_113658806" CREATED="1573372039133" MODIFIED="1573372039133" LINK="https://stackoverflow.com/questions/32287982/spring-boot-custom-static-resource-location-outside-of-project"/>
</node>
<node TEXT="localDatetTime 비교" FOLDED="true" POSITION="right" ID="ID_867535966" CREATED="1573454234761" MODIFIED="1621472968362">
<node TEXT="https://www.tutorialspoint.com/javatime/javatime_localdatetime_compareto.htm" ID="ID_1469954334" CREATED="1573454240984" MODIFIED="1573454240984" LINK="https://www.tutorialspoint.com/javatime/javatime_localdatetime_compareto.htm"/>
<node TEXT="date1.compareTo(date)" ID="ID_1272696018" CREATED="1573454250786" MODIFIED="1573454250786"/>
</node>
<node TEXT="Collections.sort가 안될 때" FOLDED="true" POSITION="right" ID="ID_180286085" CREATED="1573454603205" MODIFIED="1621472968362">
<node TEXT="https://stackoverflow.com/questions/31172312/error-when-using-collections-sort" ID="ID_1469835970" CREATED="1573454613596" MODIFIED="1573454613596" LINK="https://stackoverflow.com/questions/31172312/error-when-using-collections-sort"/>
<node TEXT="Comparable&lt;Create_art&gt; 이용" ID="ID_376721753" CREATED="1573454623403" MODIFIED="1573454627701" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
</node>
<node TEXT="diiff 프로그램" FOLDED="true" POSITION="right" ID="ID_1771860115" CREATED="1574215495390" MODIFIED="1621472968362">
<node TEXT="diffuse.sourceforge.net" ID="ID_570735667" CREATED="1574215498656" MODIFIED="1574215498656" LINK="http://diffuse.sourceforge.net/"/>
</node>
<node TEXT="스프링부트 배너 프로그램" FOLDED="true" POSITION="right" ID="ID_837433763" CREATED="1574688633536" MODIFIED="1621472968362">
<node TEXT="https://beyondj2ee.wordpress.com/2017/03/17/springboot-%EB%B0%B0%EB%84%88-%EB%A7%8C%EB%93%A4%EA%B8%B0/" ID="ID_1363890770" CREATED="1574865204487" MODIFIED="1574865205211" LINK="https://beyondj2ee.wordpress.com/2017/03/17/springboot-%EB%B0%B0%EB%84%88-%EB%A7%8C%EB%93%A4%EA%B8%B0/"/>
<node TEXT="patorjk.com &gt; Software &gt; Taag" ID="ID_539869463" CREATED="1574865085804" MODIFIED="1574865085804" LINK="http://patorjk.com/software/taag"/>
</node>
<node TEXT="이클립스 사용중인 함수인지 살펴보기" FOLDED="true" POSITION="right" ID="ID_1894901996" CREATED="1575385346435" MODIFIED="1621472968362" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="CTRL + ALT + H" ID="ID_1563346745" CREATED="1575385360139" MODIFIED="1575385369655" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
</node>
<node TEXT="maven" FOLDED="true" POSITION="right" ID="ID_1014935012" CREATED="1575977178976" MODIFIED="1621472968362" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
<node TEXT="scope에 관해서" ID="ID_1343883658" CREATED="1575977185706" MODIFIED="1575977191720">
<node TEXT="https://wikidocs.net/18344" ID="ID_1033535012" CREATED="1575977184109" MODIFIED="1575977184109" LINK="https://wikidocs.net/18344"/>
</node>
</node>
<node TEXT="타임리프" FOLDED="true" POSITION="right" ID="ID_1843603033" CREATED="1576245818252" MODIFIED="1621472968362">
<node TEXT="thymeleaf setting webapp folder" ID="ID_81174497" CREATED="1576245824417" MODIFIED="1576246134265">
<node TEXT="https://offbyone.tistory.com/409" ID="ID_361507804" CREATED="1576246405629" MODIFIED="1576246405629" LINK="https://offbyone.tistory.com/409"/>
<node TEXT="zetcode.com &gt; Articles &gt; Springbootthymeleafconf" ID="ID_1929090379" CREATED="1576246552038" MODIFIED="1576246552038" LINK="http://zetcode.com/articles/springbootthymeleafconf/"/>
</node>
<node TEXT="view" ID="ID_1773181445" CREATED="1576250059648" MODIFIED="1576250060524">
<node TEXT="https://www.baeldung.com/spring-thymeleaf-fragments" ID="ID_385068791" CREATED="1576250060910" MODIFIED="1576250060910" LINK="https://www.baeldung.com/spring-thymeleaf-fragments"/>
<node TEXT="layout" ID="ID_411718991" CREATED="1576251811677" MODIFIED="1576251813248">
<node TEXT="https://www.baeldung.com/thymeleaf-spring-layouts" ID="ID_1780324659" CREATED="1576251813651" MODIFIED="1576251813651" LINK="https://www.baeldung.com/thymeleaf-spring-layouts"/>
</node>
</node>
<node TEXT="basic" ID="ID_1666893361" CREATED="1576249426260" MODIFIED="1576249430469">
<node TEXT="https://www.baeldung.com/thymeleaf-in-spring-mvc" ID="ID_1240763212" CREATED="1576249430921" MODIFIED="1576249430921" LINK="https://www.baeldung.com/thymeleaf-in-spring-mvc"/>
<node TEXT="baisc code" ID="ID_495095843" CREATED="1576249566686" MODIFIED="1576249568338">
<node TEXT="https://github.com/eugenp/tutorials/blob/master/spring-thymeleaf/src/main/java/com/baeldung/thymeleaf/controller/BookController.java" ID="ID_1958650514" CREATED="1576249576920" MODIFIED="1576249576920" LINK="https://github.com/eugenp/tutorials/blob/master/spring-thymeleaf/src/main/java/com/baeldung/thymeleaf/controller/BookController.java"/>
<node TEXT="code" ID="ID_169910990" CREATED="1576249578454" MODIFIED="1601971355623">
<node TEXT="package com.baeldung.thymeleaf.controller;" ID="ID_311334955" CREATED="1576249588647" MODIFIED="1576249588647"/>
<node TEXT="import java.util.List;" ID="ID_72135308" CREATED="1576249588648" MODIFIED="1576249588648"/>
<node TEXT="import java.util.Optional;" ID="ID_466225913" CREATED="1576249588651" MODIFIED="1576249588651"/>
<node TEXT="import java.util.stream.Collectors;" ID="ID_1381578139" CREATED="1576249588652" MODIFIED="1576249588652"/>
<node TEXT="import java.util.stream.IntStream;" ID="ID_1652492597" CREATED="1576249588655" MODIFIED="1576249588655"/>
<node TEXT="import org.springframework.beans.factory.annotation.Autowired;" ID="ID_523896565" CREATED="1576249588658" MODIFIED="1576249588658"/>
<node TEXT="import org.springframework.data.domain.Page;" ID="ID_635020883" CREATED="1576249588659" MODIFIED="1576249588659"/>
<node TEXT="import org.springframework.data.domain.PageRequest;" ID="ID_211576820" CREATED="1576249588660" MODIFIED="1576249588660"/>
<node TEXT="import org.springframework.stereotype.Controller;" ID="ID_1455805768" CREATED="1576249588661" MODIFIED="1576249588661"/>
<node TEXT="import org.springframework.ui.Model;" ID="ID_448145543" CREATED="1576249588662" MODIFIED="1576249588662"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestMapping;" ID="ID_1205769491" CREATED="1576249588663" MODIFIED="1576249588663"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestMethod;" ID="ID_516896201" CREATED="1576249588663" MODIFIED="1576249588663"/>
<node TEXT="import org.springframework.web.bind.annotation.RequestParam;" ID="ID_746350277" CREATED="1576249588664" MODIFIED="1576249588664"/>
<node TEXT="import com.baeldung.thymeleaf.model.Book;" ID="ID_1214094804" CREATED="1576249588665" MODIFIED="1576249588665"/>
<node TEXT="import com.baeldung.thymeleaf.service.BookService;" ID="ID_1929923472" CREATED="1576249588665" MODIFIED="1576249588665"/>
<node TEXT="@Controller" ID="ID_164406208" CREATED="1576249588666" MODIFIED="1576249588666"/>
<node TEXT="public class BookController {" ID="ID_316393934" CREATED="1576249588666" MODIFIED="1576249588666">
<node TEXT="@Autowired" ID="ID_757908111" CREATED="1576249588667" MODIFIED="1576249588667"/>
<node TEXT="private BookService bookService;" ID="ID_928835042" CREATED="1576249588668" MODIFIED="1576249588668"/>
<node TEXT="@RequestMapping(value = &quot;/listBooks&quot;, method = RequestMethod.GET)" ID="ID_1570626075" CREATED="1576249588668" MODIFIED="1576249588668"/>
<node TEXT="public String listBooks(Model model, @RequestParam(&quot;page&quot;) Optional&lt;Integer&gt; page, @RequestParam(&quot;size&quot;) Optional&lt;Integer&gt; size) {" ID="ID_193083649" CREATED="1576249588670" MODIFIED="1576249588670">
<node TEXT="final int currentPage = page.orElse(1);" ID="ID_1172351831" CREATED="1576249588673" MODIFIED="1576249588673"/>
<node TEXT="final int pageSize = size.orElse(5);" ID="ID_1007387719" CREATED="1576249588674" MODIFIED="1576249588674"/>
<node TEXT="Page&lt;Book&gt; bookPage = bookService.findPaginated(PageRequest.of(currentPage - 1, pageSize));" ID="ID_402454947" CREATED="1576249588674" MODIFIED="1576249588674"/>
<node TEXT="model.addAttribute(&quot;bookPage&quot;, bookPage);" ID="ID_687415500" CREATED="1576249588675" MODIFIED="1576249588675"/>
<node TEXT="int totalPages = bookPage.getTotalPages();" ID="ID_853651805" CREATED="1576249588675" MODIFIED="1576249588675"/>
<node TEXT="if (totalPages &gt; 0) {" ID="ID_1323358737" CREATED="1576249588676" MODIFIED="1576249588676">
<node TEXT="List&lt;Integer&gt; pageNumbers = IntStream.rangeClosed(1, totalPages)" ID="ID_938547857" CREATED="1576249588676" MODIFIED="1576249588676">
<node TEXT=".boxed()" ID="ID_1981694534" CREATED="1576249588676" MODIFIED="1576249588676"/>
<node TEXT=".collect(Collectors.toList());" ID="ID_1839740150" CREATED="1576249588677" MODIFIED="1576249588677"/>
</node>
<node TEXT="model.addAttribute(&quot;pageNumbers&quot;, pageNumbers);" ID="ID_793042294" CREATED="1576249588678" MODIFIED="1576249588678"/>
</node>
<node TEXT="}" ID="ID_88106383" CREATED="1576249588678" MODIFIED="1576249588678"/>
<node TEXT="return &quot;listBooks.html&quot;;" ID="ID_1349428026" CREATED="1576249588679" MODIFIED="1576249588679"/>
</node>
<node TEXT="}" ID="ID_1766534331" CREATED="1576249588679" MODIFIED="1576249588679"/>
</node>
<node TEXT="}" ID="ID_1139913934" CREATED="1576249588680" MODIFIED="1576249588680"/>
</node>
</node>
</node>
</node>
<node TEXT="오픈그래프" FOLDED="true" POSITION="right" ID="ID_1642794399" CREATED="1576255149595" MODIFIED="1621472968362">
<node TEXT="오픈그래프는 앵귤러에서 안된다." ID="ID_1581434372" CREATED="1576255170160" MODIFIED="1576255175862"/>
<node TEXT="따라서 타임리프를 이용해서 설정해야 할듯 싶다." ID="ID_1604313839" CREATED="1576255178679" MODIFIED="1576255244576"/>
<node TEXT="전체적인 페이지용임을 알아두자." ID="ID_1793080490" CREATED="1576255255557" MODIFIED="1576255263440"/>
</node>
<node TEXT="base64 to file" FOLDED="true" POSITION="right" ID="ID_1597748331" CREATED="1576583116697" MODIFIED="1621472968362">
<node TEXT="https://stackoverflow.com/questions/20879639/write-base64-encoded-image-to-file" ID="ID_435284917" CREATED="1576583820535" MODIFIED="1576583820535" LINK="https://stackoverflow.com/questions/20879639/write-base64-encoded-image-to-file"/>
</node>
<node TEXT="이클립스 단축키" FOLDED="true" POSITION="right" ID="ID_409579815" CREATED="1576583854374" MODIFIED="1621472968362">
<node TEXT="이클립스 현재 사용중인 method" ID="ID_1743853932" CREATED="1576583831382" MODIFIED="1576583840211">
<node TEXT="https://stackoverflow.com/questions/5268998/find-methods-calls-in-eclipse-project" ID="ID_1441668379" CREATED="1576583858613" MODIFIED="1576583858613" LINK="https://stackoverflow.com/questions/5268998/find-methods-calls-in-eclipse-project"/>
<node TEXT="ctrl + alt + h" ID="ID_92472382" CREATED="1576583859747" MODIFIED="1576583865647"/>
</node>
</node>
<node TEXT="oauth2 client" FOLDED="true" POSITION="right" ID="ID_1905859363" CREATED="1576826799741" MODIFIED="1621472968362">
<node TEXT="https://www.baeldung.com/spring-security-5-oauth2-login" ID="ID_437162428" CREATED="1576826814063" MODIFIED="1576826814063" LINK="https://www.baeldung.com/spring-security-5-oauth2-login"/>
<node TEXT="https://galid1.tistory.com/m/582" ID="ID_1652193121" CREATED="1576826822703" MODIFIED="1576826822703" LINK="https://galid1.tistory.com/m/582"/>
<node TEXT="해당하는 걸로 인증을 할려고 하였으나, oauth2 resouse server를 사용하고 있는 중인것 때문에 작동하지 않는다." ID="ID_1356217801" CREATED="1580468526311" MODIFIED="1580470449095"/>
<node TEXT="스프링 부트를 새로 만들어서 실행하니 제대로 작동한다." ID="ID_1690383103" CREATED="1580470449789" MODIFIED="1580470457305"/>
<node TEXT="따라서 자바스크립트 안에서 토큰을 가져와서 해당하는 토큰을 다시 백에서 맞나 검토는 하는 걸로 로그인하는것이 필요해 보인다." ID="ID_1322165236" CREATED="1580470459702" MODIFIED="1580470488639"/>
<node TEXT="해당하는 문서" FOLDED="true" ID="ID_1047445385" CREATED="1580470786668" MODIFIED="1614245588472">
<node TEXT="https://developers.google.com/identity/sign-in/web/sign-in" ID="ID_1044605821" CREATED="1580470789635" MODIFIED="1580470789635" LINK="https://developers.google.com/identity/sign-in/web/sign-in"/>
<node TEXT="https://developers.google.com/identity/sign-in/web/reference#googleauthcurrentuserget" ID="ID_1883602660" CREATED="1580470797797" MODIFIED="1580470797797" LINK="https://developers.google.com/identity/sign-in/web/reference#googleauthcurrentuserget"/>
<node TEXT="코드" ID="ID_525401611" CREATED="1580470798907" MODIFIED="1580470799831">
<node TEXT="gapi.load(&apos;auth2&apos;, function() {" ID="ID_1676891458" CREATED="1580470819473" MODIFIED="1580470819473">
<node TEXT="gapi.auth2.init({" ID="ID_1384764414" CREATED="1580470819476" MODIFIED="1580470819476">
<node TEXT="client_id: &apos;21771763229-ha6vtbu74oa43jbj40gjj40kngqinodp.apps.googleusercontent.com&apos;" ID="ID_1886869096" CREATED="1580470819477" MODIFIED="1580470819477"/>
</node>
<node TEXT="}).signIn({" ID="ID_61858955" CREATED="1580470819481" MODIFIED="1580470819481">
<node TEXT="scope: &apos;profile email&apos;" ID="ID_485176505" CREATED="1580470819482" MODIFIED="1580470819482"/>
</node>
<node TEXT="}).then((user:any)=&gt;{" ID="ID_1649789483" CREATED="1580470819485" MODIFIED="1580470819485">
<node TEXT="const profile = user.getBasicProfile();" ID="ID_1898687012" CREATED="1580470819487" MODIFIED="1580470819487"/>
<node TEXT="console.log(&apos;ID: &apos; + profile.getId()); // Do not send to your backend! Use an ID token instead." ID="ID_1280009709" CREATED="1580470819488" MODIFIED="1580470819488"/>
<node TEXT="console.log(&apos;Name: &apos; + profile.getName());" ID="ID_226264649" CREATED="1580470819489" MODIFIED="1580470819489"/>
<node TEXT="console.log(&apos;Image URL: &apos; + profile.getImageUrl());" ID="ID_1731994251" CREATED="1580470819489" MODIFIED="1580470819489"/>
<node TEXT="console.log(&apos;Email: &apos; + profile.getEmail()); // This is null if the &apos;email&apos; scope is not present." ID="ID_1438260956" CREATED="1580470819490" MODIFIED="1580470819490"/>
<node TEXT="const authInfo = user.getAuthResponse();" ID="ID_373638928" CREATED="1580470819492" MODIFIED="1580470819492"/>
<node TEXT="console.log(&quot;access token:&quot; + authInfo.access_token);" ID="ID_1495089312" CREATED="1580470819493" MODIFIED="1580470819493"/>
</node>
<node TEXT="})" ID="ID_1409504690" CREATED="1580470819494" MODIFIED="1580470819494"/>
<node TEXT="// gapi.auth2.init();" ID="ID_764466380" CREATED="1580470819498" MODIFIED="1580470819498"/>
<node TEXT="/* Ready. Make a call to gapi.auth2.init or some other API */" ID="ID_718841792" CREATED="1580470819498" MODIFIED="1580470819498"/>
<node TEXT="});" ID="ID_772314229" CREATED="1580470819502" MODIFIED="1580470819502"/>
</node>
</node>
</node>
<node TEXT="MVC에서 클라이언트 id 얻기" ID="ID_913579932" CREATED="1614245592648" MODIFIED="1614245644684">
<node TEXT="https://stackoverflow.com/questions/12464042/spring-oauth-oauth2-how-can-i-get-the-client-credentials-in-a-spring-mvc-cont" ID="ID_539987840" CREATED="1614245590059" MODIFIED="1614245590059" LINK="https://stackoverflow.com/questions/12464042/spring-oauth-oauth2-how-can-i-get-the-client-credentials-in-a-spring-mvc-cont"/>
</node>
</node>
<node TEXT="yaml yml 파일 읽어로기" FOLDED="true" POSITION="right" ID="ID_577056719" CREATED="1580439511092" MODIFIED="1621472968362" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
<node TEXT="https://www.baeldung.com/java-snake-yaml" ID="ID_530570295" CREATED="1580439578382" MODIFIED="1580439578382" LINK="https://www.baeldung.com/java-snake-yaml"/>
<node TEXT="datasource 읽어오기는 여기서" ID="ID_736703850" CREATED="1580439581602" MODIFIED="1580439610279" LINK="#ID_432910582"/>
</node>
<node TEXT="스페셜 캐릭터 정규표현식 자동으로 바꿔주기 예){{ \{\{" FOLDED="true" POSITION="right" ID="ID_1885333051" CREATED="1581345427875" MODIFIED="1621472968362">
<node TEXT="https://stackoverflow.com/questions/60160/how-to-escape-text-for-regular-expression-in-java" ID="ID_1629720870" CREATED="1581345576774" MODIFIED="1581345576774" LINK="https://stackoverflow.com/questions/60160/how-to-escape-text-for-regular-expression-in-java"/>
</node>
<node TEXT="이메일 깨지는 것" FOLDED="true" POSITION="right" ID="ID_883025320" CREATED="1581352196894" MODIFIED="1621472968362">
<node TEXT="https://mkil.tistory.com/340" ID="ID_990643542" CREATED="1581352200028" MODIFIED="1581352200028" LINK="https://mkil.tistory.com/340"/>
</node>
<node TEXT="arrayList 정렬(compateTo 이용방법)" POSITION="left" ID="ID_702207424" CREATED="1582972563805" MODIFIED="1621472968362">
<node TEXT="https://includestdio.tistory.com/35" ID="ID_496044427" CREATED="1582972566785" MODIFIED="1582972566785" LINK="https://includestdio.tistory.com/35"/>
</node>
<node TEXT="List의 java.lang.foreach" FOLDED="true" POSITION="left" ID="ID_650895007" CREATED="1583384548615" MODIFIED="1621472968362" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="Iterable의 메소드(이미지)" ID="ID_1821603041" CREATED="1583384603010" MODIFIED="1598945125982">
<node ID="ID_688239118" CREATED="1583384664616" MODIFIED="1583384664616"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_906404260486696931.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="로그" FOLDED="true" POSITION="right" ID="ID_443990801" CREATED="1582868802359" MODIFIED="1621472968362">
<node TEXT="@SuppressWarnings(&quot;unused&quot;)" ID="ID_1063589233" CREATED="1582868819622" MODIFIED="1582868819622"/>
<node TEXT="private LogUtil log = new LogUtil(getClass());" ID="ID_1701482316" CREATED="1582868819622" MODIFIED="1582868819622"/>
</node>
<node TEXT="aop" FOLDED="true" POSITION="right" ID="ID_1653710934" CREATED="1584666330227" MODIFIED="1621472968362" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="기초" ID="ID_145341182" CREATED="1584666337291" MODIFIED="1611565360642">
<node TEXT="https://www.baeldung.com/spring-aop-annotation" ID="ID_62009756" CREATED="1584666339394" MODIFIED="1584666339394" LINK="https://www.baeldung.com/spring-aop-annotation"/>
</node>
<node TEXT="개념마스터" FOLDED="true" ID="ID_156579748" CREATED="1611104680023" MODIFIED="1611565573412">
<node TEXT="https://ehdvudee.tistory.com/22" ID="ID_1134960024" CREATED="1611104682371" MODIFIED="1611104682371" LINK="https://ehdvudee.tistory.com/22"/>
</node>
<node TEXT="aop유형" ID="ID_458564099" CREATED="1611104693751" MODIFIED="1611565575153">
<node TEXT="https://www.baeldung.com/spring-aop-pointcut-tutorial" ID="ID_1520342314" CREATED="1611104702401" MODIFIED="1611104702401" LINK="https://www.baeldung.com/spring-aop-pointcut-tutorial"/>
</node>
<node TEXT="개념" FOLDED="true" ID="ID_975922034" CREATED="1610091963478" MODIFIED="1619770124158">
<node TEXT="개념(이미지)" ID="ID_1141497370" CREATED="1610091968942" MODIFIED="1610091974697">
<node ID="ID_655070697" CREATED="1610092001582" MODIFIED="1610092001582"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_499518602691905715.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="AOP는 Aspect Oriented Programing의 약자로, 관점 지향 프로그래밍을 뜻한다. 공통 관심사(Aspect)의 분리(모듈화)를 통해 소스코드의 중복의 해소 및 어플리케이션의 책임 원칙을 좀덕 획일화한다. 하나의 예는 트랜잭션 잡업과 인증 절차를 예를들 수 있다. 즉, 기능 중에 주 기능에만 집중하고, 부가 기능은 Aspect로 다 분리 시킨다. " ID="ID_1552863737" CREATED="1610092003790" MODIFIED="1610092015282"/>
</node>
<node TEXT="종류" FOLDED="true" ID="ID_1894326239" CREATED="1610092023278" MODIFIED="1611564622395">
<node TEXT="Spring AOP" ID="ID_1598696434" CREATED="1610092027878" MODIFIED="1610092687369">
<node TEXT="IoC/DI/프록시 패턴/자동 프록시 생성 기법/빈 오브젝트의 후처리 조작기법 등을 통해 AOP를 지원하며, 이와 같은 AOP는 스프링과 기본 JDK를 통해 구현 가능하다. 즉 간접적인 방식을 통해 AOP를 지원한다. 해당 Spring AOP는 프록시 방식의 AOP이다. 즉 프록시 디자인 패턴을 사용한다." ID="ID_764780668" CREATED="1610092057446" MODIFIED="1610092057446"/>
<node TEXT="스프링 AOP의 프록시 빈 생성 절차는 다음과 같다." ID="ID_1517894641" CREATED="1610092057446" MODIFIED="1610092057446">
<node TEXT="1. 빈 설정파일을 통한 빈 오브젝트 생성" ID="ID_430128615" CREATED="1610092057462" MODIFIED="1610092057462"/>
<node TEXT="2. (생성된 빈을 이용하여) 빈 후처리기를 통해 컨테이너 초기화 시점에서 자동으로 프록시 생성(DefaultAdvisorAutoProxyCreator.class/BeanPostProcessor.class)," ID="ID_357481209" CREATED="1610092057462" MODIFIED="1610092057462"/>
<node TEXT="3. 포인트컷을 활용하여, 프록시를 적용할 대상을 지정한다." ID="ID_367618080" CREATED="1610092057462" MODIFIED="1610092057462"/>
<node TEXT="4. 프록시 빈 오브젝트 생성 및 IoC 컨테이너에 등록" ID="ID_1554177638" CREATED="1610092057462" MODIFIED="1610092057462"/>
</node>
</node>
<node TEXT="AspectJ" ID="ID_1971597609" CREATED="1610092037909" MODIFIED="1610092687854">
<node TEXT="바이트코드 생성과 조작을 통해 AOP를 실현한다. Target 오브젝트를 뜯어 고쳐서 부가기능을 직접 넣어주는 직접적인 방식이다." ID="ID_345317495" CREATED="1610092062708" MODIFIED="1610092062708"/>
</node>
</node>
<node TEXT="용어" FOLDED="true" ID="ID_918978638" CREATED="1610092067765" MODIFIED="1611565357787">
<node TEXT="Target" FOLDED="true" ID="ID_1523655336" CREATED="1610092077438" MODIFIED="1611565296790">
<node TEXT="부가기능을 부여할 대상을 뜻한다. 즉, 주기능을 얘기한다." ID="ID_1272899277" CREATED="1610092083654" MODIFIED="1610092083654"/>
</node>
<node TEXT="Aspect" FOLDED="true" ID="ID_1920757482" CREATED="1610092086382" MODIFIED="1611565296790">
<node TEXT="AOP의 기본 모듈이다. 한개 또는 그 이상의 포인트컷과 어드바이스의 조합으로 만들어진다." ID="ID_310216247" CREATED="1610092096951" MODIFIED="1610092096951"/>
</node>
<node TEXT="Advice" FOLDED="true" ID="ID_1238977138" CREATED="1610092118277" MODIFIED="1611565296790">
<node TEXT="실질적으로 부가 기능의 구현체이다. Advice의 유형은 다음과 같다. Before, After, Around, AfterReturning, AfterThrowing이 있다." ID="ID_840155892" CREATED="1610092123579" MODIFIED="1610092123579"/>
<node TEXT="종류" ID="ID_895668894" CREATED="1610092129302" MODIFIED="1611564629878">
<node TEXT="- Before: Target을 실행하기전에 부가 기능 실행" ID="ID_1779151027" CREATED="1610092134356" MODIFIED="1610092134356"/>
<node TEXT="- After: Target실행 후 (해당 Target Exception 또는 정상리턴 여부 상관없이) 실행" ID="ID_578364122" CREATED="1610092134365" MODIFIED="1610092134365"/>
<node TEXT="- Around: Before + AfterReturning" ID="ID_1729206008" CREATED="1610092134365" MODIFIED="1610092134365"/>
<node TEXT="- AfterReturning: Target 실행 후 성공적인 리턴할 때" ID="ID_85374709" CREATED="1610092134365" MODIFIED="1610092134365"/>
<node TEXT="- AfterThrowing: Target 실행하다, Exception 던질 때" ID="ID_196003562" CREATED="1610092134365" MODIFIED="1610092134365"/>
</node>
</node>
<node TEXT="Join-Point" FOLDED="true" ID="ID_1089551571" CREATED="1610093005309" MODIFIED="1611565296790">
<node TEXT="Advice가 적용될 위치를 표시한다(ex:메소드 실행 단계)." ID="ID_1681464065" CREATED="1610093014972" MODIFIED="1610093014972"/>
</node>
<node TEXT="Point-Cut" FOLDED="true" ID="ID_1950202175" CREATED="1610092151749" MODIFIED="1611565296790">
<node TEXT="Advice를 적용할 Target를 선별하는 역할을 한다. Annotation 또는 메소드의 정규식을 통해 표현한다." ID="ID_748176287" CREATED="1610092157573" MODIFIED="1610092157573"/>
</node>
<node TEXT="Cross-Cutting Concertn" FOLDED="true" ID="ID_1268614969" CREATED="1610092164206" MODIFIED="1611221010094">
<node TEXT="횡단 공통 관심사이다. 이것은 이미지를 통해 연상하는 것이 더 빠르다." ID="ID_1323191188" CREATED="1610092169525" MODIFIED="1610092169525"/>
<node TEXT="이미지" FOLDED="true" ID="ID_296852993" CREATED="1610092174518" MODIFIED="1611221009493">
<node ID="ID_1555370573" CREATED="1610092184404" MODIFIED="1610092184404"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_4875991402765067759.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
</node>
<node TEXT="AOP Weaving" FOLDED="true" ID="ID_1401712634" CREATED="1610092256630" MODIFIED="1611221127310">
<node TEXT="Aspect(부가기능)와 Application(핵심기능)의 Linking하는 과정" ID="ID_1359553088" CREATED="1610092424006" MODIFIED="1610092460274"/>
<node TEXT="해당 객체들을 묶어 새로운 객체 생성" ID="ID_1294628410" CREATED="1610092460957" MODIFIED="1610092475101"/>
<node TEXT="SpringAop" ID="ID_1651806669" CREATED="1610092519029" MODIFIED="1610092525293">
<node TEXT="이미, 위에서 Weaving 절차를 설명하였다. Spring AOP의 Weaving 절차는 RunTime이다(프록시 빈 생성하는 것, IoC 컨테이너 초기화 작업할 때, 그러니까 WAS 가동할 때)." ID="ID_580346181" CREATED="1610092537313" MODIFIED="1610092537313"/>
<node TEXT="인터페이스 기준으로 하는 JDK Dynamic Proxy와 Class 기준으로 하는 CGLib Proxy가 존재한다. CGLib Proxy의 경우, AspectJ의 Weaving 처럼 바이트 코드를 조작한다. SpringAOP는 JDK Dynamic Proxy 패턴을 선호한다. 또한 Proxy 패턴 자체가 인터페이스를 끼고하는 페턴이다." ID="ID_83903899" CREATED="1610092537313" MODIFIED="1610092537313"/>
</node>
<node TEXT="AspectJ" ID="ID_1275208303" CREATED="1610092539349" MODIFIED="1610092543068">
<node TEXT="실제, AJC(Apsect Compiler)를 이용하여 Woven System 생성한다. 즉 부가기능과 핵심기능이 합쳐진 클래스 파일을 생성한다. AspectJ의 Weaving 타입은 아래와 같다." ID="ID_632955039" CREATED="1610092547437" MODIFIED="1610092547437"/>
</node>
<node TEXT="Compile-Time Weaving" ID="ID_257176453" CREATED="1610092565373" MODIFIED="1610092566098">
<node TEXT="Aspect의 클래스와 Aspect를 사용하는 class들을 AJC를 통해 컴파일을 한다. JAR를 이용하여 Weaving을 하는 경우, Post-Compile Weaving(Binary Weaving)을 사용하며, 일반 소스 코드의 경우, 일반 Compile-Time Weaving을 사용한다." ID="ID_1181645612" CREATED="1610092571637" MODIFIED="1610092571637"/>
</node>
<node TEXT="Load-Time Weaving" ID="ID_1047269419" CREATED="1610092579894" MODIFIED="1610092579894">
<node TEXT="클래스로더를 통해 클래스가 JVM에 로딩되는 시점에 클래스의 바이트 코드를 조작한다. 즉, 객체를 메모리에 적재할 때 Weaving을 실현한다. 때문에, 다른 Weaving보다 속도 측면에서는 느리다." ID="ID_346053345" CREATED="1610092584693" MODIFIED="1610092584693"/>
</node>
</node>
</node>
<node TEXT="bufferedImage null 문제" FOLDED="true" POSITION="right" ID="ID_915207885" CREATED="1586828883630" MODIFIED="1621472968362">
<node TEXT="이미지" ID="ID_373235148" CREATED="1586828898213" MODIFIED="1594169180751">
<node ID="ID_1023914691" CREATED="1586828947845" MODIFIED="1586828947845"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_8848869880550675843.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="jqpl in query" FOLDED="true" POSITION="right" ID="ID_599832735" CREATED="1590050662440" MODIFIED="1621472968362" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
<node TEXT="https://stackoverflow.com/questions/4378824/adding-in-clause-list-to-a-jpa-query" ID="ID_318248295" CREATED="1590050671574" MODIFIED="1590050717489" LINK="https://stackoverflow.com/questions/4378824/adding-in-clause-list-to-a-jpa-query"/>
<node TEXT="When using IN with a collection-valued parameter you don&apos;t need (...):" ID="ID_30775288" CREATED="1590050684410" MODIFIED="1590050717489" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node ID="ID_1579368323" CREATED="1590050688725" MODIFIED="1590050717491" COLOR="#3333ff" STYLE="bubble"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <p>
      @NamedQuery(name = &quot;EventLog.viewDatesInclude&quot;,
    </p>
    <p>
      query = &quot;SELECT el FROM EventLog el WHERE el.timeMark &gt;= :dateFrom AND &quot;
    </p>
    <p>
      + &quot;el.timeMark &lt;= :dateTo AND &quot;
    </p>
    <p>
      + &quot;el.name IN :inclList&quot;)
    </p>
  </body>
</html>
</richcontent>
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
</node>
</node>
<node TEXT="주간업무보고 시에 인증현황" FOLDED="true" POSITION="right" ID="ID_839585421" CREATED="1590112940069" MODIFIED="1621472968362">
<node TEXT="콘텐츠 히스토리 현황" ID="ID_1975074334" CREATED="1590113187717" MODIFIED="1590113197813">
<node TEXT="각 콘텐츠 사이트 그룹, 아이템 그룹하여 쿼리" ID="ID_507320560" CREATED="1590113199637" MODIFIED="1590113235511"/>
</node>
<node TEXT="인증조회 현황" ID="ID_491765116" CREATED="1590113242485" MODIFIED="1590113246726"/>
</node>
<node TEXT="이게 숫자인지 판단" FOLDED="true" POSITION="right" ID="ID_248784823" CREATED="1590471226221" MODIFIED="1621472968362">
<node TEXT="https://stackoverflow.com/questions/1102891/how-to-check-if-a-string-is-numeric-in-java" ID="ID_1348788645" CREATED="1590471231139" MODIFIED="1590471231139" LINK="https://stackoverflow.com/questions/1102891/how-to-check-if-a-string-is-numeric-in-java"/>
</node>
<node TEXT="쓰레드 초보" FOLDED="true" POSITION="right" ID="ID_1901071594" CREATED="1590569131484" MODIFIED="1621472968362" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://www.baeldung.com/java-start-thread" ID="ID_41113680" CREATED="1590569134899" MODIFIED="1590569134899" LINK="https://www.baeldung.com/java-start-thread"/>
<node TEXT="https://stackoverflow.com/questions/9148899/returning-value-from-thread" ID="ID_869725420" CREATED="1590569770363" MODIFIED="1590569770363" LINK="https://stackoverflow.com/questions/9148899/returning-value-from-thread"/>
</node>
<node TEXT="아스키(ascii)" FOLDED="true" POSITION="right" ID="ID_1554940138" CREATED="1590980249036" MODIFIED="1621472968362">
<node TEXT="int to char" ID="ID_1822820679" CREATED="1590980375406" MODIFIED="1590986890797">
<node TEXT="https://stackoverflow.com/questions/5328996/java-change-int-to-ascii" ID="ID_1535951954" CREATED="1590980260865" MODIFIED="1590980260865" LINK="https://stackoverflow.com/questions/5328996/java-change-int-to-ascii"/>
</node>
<node TEXT="아스키 도표(이미지)" ID="ID_830625381" CREATED="1590980720436" MODIFIED="1590985919558">
<node ID="ID_1946141600" CREATED="1590980742683" MODIFIED="1590980742683"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_122261659961691207.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="stream 필터" FOLDED="true" POSITION="right" ID="ID_620712182" CREATED="1591692561863" MODIFIED="1621472968362" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://www.baeldung.com/java-stream-filter-lambda" ID="ID_1784641128" CREATED="1591693048192" MODIFIED="1602506225772" LINK="https://www.baeldung.com/java-stream-filter-lambda"/>
<node TEXT="https://stackoverflow.com/questions/57885833/removeif-vs-filter-collect" ID="ID_1597627004" CREATED="1602506222396" MODIFIED="1602506225772" LINK="https://stackoverflow.com/questions/57885833/removeif-vs-filter-collect"/>
</node>
<node TEXT="accept language 에 대하여" FOLDED="true" POSITION="right" ID="ID_1779526622" CREATED="1592206922394" MODIFIED="1621472968362">
<node TEXT="원본(이미지)" ID="ID_1150112704" CREATED="1592206958426" MODIFIED="1598938210122">
<node ID="ID_1630743796" CREATED="1592206991072" MODIFIED="1592206991072"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_9041154389258595568.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="이미지" ID="ID_1508001772" CREATED="1592206930322" MODIFIED="1598938207970">
<node ID="ID_1867623409" CREATED="1592206933554" MODIFIED="1592206933554"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_173193874811257717.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
<node TEXT="그래서 그 코드가 뭐냐고?(링크)" ID="ID_946741980" CREATED="1592207103778" MODIFIED="1598938206998">
<node TEXT="https://docs.oracle.com/cd/E13214_01/wli/docs92/xref/xqisocodes.html" ID="ID_782439064" CREATED="1592207107512" MODIFIED="1592207107512" LINK="https://docs.oracle.com/cd/E13214_01/wli/docs92/xref/xqisocodes.html"/>
</node>
<node TEXT="이미지" ID="ID_1129283251" CREATED="1598938227400" MODIFIED="1618363086857">
<node ID="ID_1228504161" CREATED="1598938228932" MODIFIED="1598938228932"><richcontent TYPE="NODE">

<html>
  <head>
    
  </head>
  <body>
    <img src="&#xd544;&#xc694;&#xd55c; &#xc790;&#xbc14; &#xd29c;&#xd1a0;_8889266793933042899.jpeg" />
  </body>
</html>
</richcontent>
</node>
</node>
</node>
<node TEXT="ip로 주소 얻기" FOLDED="true" POSITION="right" ID="ID_1767037537" CREATED="1592558618771" MODIFIED="1621472968362">
<node TEXT="https://ip-api.com/" ID="ID_684741374" CREATED="1592558623499" MODIFIED="1592558623499" LINK="https://ip-api.com/"/>
</node>
<node TEXT="엑셀" FOLDED="true" POSITION="right" ID="ID_1675766869" CREATED="1593760842200" MODIFIED="1621472968362">
<node TEXT="기본적인 엑셀 입출력에 대한 것" ID="ID_1486676750" CREATED="1593760845759" MODIFIED="1602652939279">
<node TEXT="https://www.tutorialspoint.com/apache_poi/index.htm" ID="ID_113253334" CREATED="1594002732258" MODIFIED="1594002732258" LINK="https://www.tutorialspoint.com/apache_poi/index.htm"/>
</node>
<node TEXT="엑셀 모든 셀 포뮬라 업데이트" ID="ID_1357090620" CREATED="1593760861671" MODIFIED="1602652939918">
<node TEXT="https://stackoverflow.com/questions/5937373/using-apache-poi-hssf-how-can-i-refresh-all-formula-cells-at-once" ID="ID_1469886252" CREATED="1593760891695" MODIFIED="1593760891695" LINK="https://stackoverflow.com/questions/5937373/using-apache-poi-hssf-how-can-i-refresh-all-formula-cells-at-once"/>
</node>
</node>
<node TEXT="에리카(이중화 로드 밸런싱을 위한 서버)" FOLDED="true" POSITION="right" ID="ID_1691530218" CREATED="1598938418942" MODIFIED="1621472968370">
<node TEXT="https://www.baeldung.com/spring-cloud-netflix-eureka" ID="ID_908540782" CREATED="1598938429357" MODIFIED="1598938429357" LINK="https://www.baeldung.com/spring-cloud-netflix-eureka"/>
<node TEXT="서버 doc" ID="ID_284497516" CREATED="1598942599229" MODIFIED="1598942603646">
<node TEXT="https://docs.spring.io/spring-cloud-netflix/docs/2.2.5.RELEASE/reference/html/" ID="ID_285268418" CREATED="1598942596403" MODIFIED="1598942596403" LINK="https://docs.spring.io/spring-cloud-netflix/docs/2.2.5.RELEASE/reference/html/"/>
</node>
<node TEXT="zuul and eureka 문서1" ID="ID_1606711360" CREATED="1599007812659" MODIFIED="1599016029336">
<node TEXT="https://www.baeldung.com/zuul-load-balancing" ID="ID_1041323688" CREATED="1599007817089" MODIFIED="1599007817089" LINK="https://www.baeldung.com/zuul-load-balancing"/>
</node>
<node TEXT="server standAnlone mode" ID="ID_596294235" CREATED="1599008478923" MODIFIED="1599015983876">
<node TEXT="https://cloud.spring.io/spring-cloud-netflix/multi/multi_spring-cloud-eureka-server.html#spring-cloud-eureka-server-standalone-mode" ID="ID_1172850381" CREATED="1599008486346" MODIFIED="1599008486346" LINK="https://cloud.spring.io/spring-cloud-netflix/multi/multi_spring-cloud-eureka-server.html#spring-cloud-eureka-server-standalone-mode"/>
<node TEXT="appication.yml" ID="ID_621795454" CREATED="1599008489051" MODIFIED="1599008493710">
<node TEXT="server:" ID="ID_71035434" CREATED="1599008496792" MODIFIED="1599008496792">
<node TEXT="port: 8761" ID="ID_477078782" CREATED="1599008496792" MODIFIED="1599008496792"/>
</node>
<node TEXT="eureka:" ID="ID_1519127859" CREATED="1599008496792" MODIFIED="1599008496792">
<node TEXT="instance:" ID="ID_187459982" CREATED="1599008496792" MODIFIED="1599008496792">
<node TEXT="hostname: localhost" ID="ID_87937001" CREATED="1599008496793" MODIFIED="1599008496793"/>
</node>
<node TEXT="client:" ID="ID_1366598056" CREATED="1599008496794" MODIFIED="1599008496794">
<node TEXT="registerWithEureka: false" ID="ID_712296723" CREATED="1599008496794" MODIFIED="1599008496794"/>
<node TEXT="fetchRegistry: false" ID="ID_1514327832" CREATED="1599008496795" MODIFIED="1599008496795"/>
<node TEXT="serviceUrl:" ID="ID_1129061988" CREATED="1599008496796" MODIFIED="1599008496796">
<node TEXT="defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/" ID="ID_135995314" CREATED="1599008496796" MODIFIED="1599008496796" LINK="http://$%7Beureka.instance.hostname%7D:$%7Bserver.port%7D/eureka/"/>
</node>
</node>
</node>
</node>
</node>
<node TEXT="문서2(이건 작동함)" ID="ID_932224627" CREATED="1599016015766" MODIFIED="1599016040664">
<node TEXT="https://www.frugalisminds.com/spring/server-side-load-balancing-with-zuul-and-eureka/" ID="ID_444044454" CREATED="1599015984465" MODIFIED="1599015984465" LINK="https://www.frugalisminds.com/spring/server-side-load-balancing-with-zuul-and-eureka/"/>
</node>
<node TEXT="결론" ID="ID_964584539" CREATED="1599024035475" MODIFIED="1599024042068" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="문서1과 문서2는 결국에는 동일함" ID="ID_398462068" CREATED="1599024042878" MODIFIED="1599024049091"/>
<node TEXT="문제는 zuul서버에서 /routes로 접속이 안된다는 점, 이중화가 안된다는 점이었고, 두 문제는 각각 스프링부트 2.0.0이 시작되면서 허락안된 endpoint에 접속하지 못하도록 해놓은 것이고, yml을 사용하면 특수기호가 들어갈 때 &apos; 즉 문자따음표를 써야만 했던 것이다." ID="ID_1271926685" CREATED="1599024058984" MODIFIED="1599024382778"/>
<node TEXT="해당하는 문제의 스텍오버플로우" ID="ID_1754077836" CREATED="1599024451350" MODIFIED="1599024455242">
<node TEXT="https://stackoverflow.com/questions/57242507/spring-cloud-zuul-path-actuator-routes-404-not-found" ID="ID_689191728" CREATED="1599024455606" MODIFIED="1599024455606" LINK="https://stackoverflow.com/questions/57242507/spring-cloud-zuul-path-actuator-routes-404-not-found"/>
</node>
<node TEXT="여튼 해당하는 web의 엔드포인트를 열어주면 문제는 해결된다." ID="ID_863073103" CREATED="1599024874727" MODIFIED="1599026378689"/>
</node>
<node TEXT="정리" ID="ID_1820208808" CREATED="1599036806119" MODIFIED="1599036807929">
<node TEXT="https://blog.naver.com/neem693/222078302537" ID="ID_722304374" CREATED="1599036834403" MODIFIED="1599036834403" LINK="https://blog.naver.com/neem693/222078302537"/>
</node>
</node>
<node TEXT="하위쿼리" FOLDED="true" POSITION="right" ID="ID_1720674756" CREATED="1599814945200" MODIFIED="1621472968370">
<node TEXT="SELECT a, (SELECT b FROM testtable WHERE b = 1) AS b FROM temptable" ID="ID_1494888892" CREATED="1599814955780" MODIFIED="1599814955780"/>
</node>
<node TEXT="아임포트" FOLDED="true" POSITION="right" ID="ID_692306802" CREATED="1599039198212" MODIFIED="1621472968370">
<node TEXT="INTRO" ID="ID_1429535307" CREATED="1599039207178" MODIFIED="1599039209694"/>
<node TEXT="목적" ID="ID_249663751" CREATED="1599039210850" MODIFIED="1599039212396"/>
<node TEXT="인증" ID="ID_1341002442" CREATED="1599039216819" MODIFIED="1599039217560"/>
<node TEXT="결제" ID="ID_1032332933" CREATED="1599039221572" MODIFIED="1599039222335"/>
<node TEXT="안심클릭 계열" ID="ID_1844134770" CREATED="1599039226707" MODIFIED="1599039229819"/>
<node TEXT="ISP 계열" ID="ID_1979490815" CREATED="1599039358602" MODIFIED="1599039361167"/>
<node TEXT="앱카드" ID="ID_663866635" CREATED="1599039366051" MODIFIED="1599039367001"/>
<node TEXT="3. 비인증 결제" ID="ID_398949534" CREATED="1599039368187" MODIFIED="1599039371326">
<node TEXT="key-in 결제" ID="ID_520297544" CREATED="1599039410123" MODIFIED="1599039415458"/>
<node TEXT="빌링 결제" ID="ID_1809980017" CREATED="1599039419131" MODIFIED="1599039422551"/>
<node TEXT="현실" ID="ID_177186748" CREATED="1599039422963" MODIFIED="1599039424184"/>
</node>
</node>
<node TEXT="자바 순서가 보장되는 컬랙션" FOLDED="true" POSITION="right" ID="ID_409532207" CREATED="1602057012369" MODIFIED="1621472968370">
<node TEXT="https://library1008.tistory.com/11" ID="ID_988751307" CREATED="1602057024130" MODIFIED="1602057024130" LINK="https://library1008.tistory.com/11"/>
</node>
<node TEXT="공유폴더 암호걸기" FOLDED="true" POSITION="right" ID="ID_1660795135" CREATED="1605759487088" MODIFIED="1621472968370">
<node TEXT="https://caskers.tistory.com/522" ID="ID_1986261096" CREATED="1605759492008" MODIFIED="1605759492008" LINK="https://caskers.tistory.com/522"/>
</node>
<node TEXT="자바 디컴파일에 대한 이야기" FOLDED="true" POSITION="right" ID="ID_1941939230" CREATED="1606962136176" MODIFIED="1621472968370">
<node TEXT="https://codechacha.com/ko/how-to-decompile-android-apk/" ID="ID_1016604744" CREATED="1606962143196" MODIFIED="1606962143196" LINK="https://codechacha.com/ko/how-to-decompile-android-apk/"/>
<node TEXT="apk 디컴파일" ID="ID_1872037206" CREATED="1607388782618" MODIFIED="1607388787887">
<node TEXT="java-decompiler.github.io" ID="ID_1383479936" CREATED="1607388788401" MODIFIED="1607388788401" LINK="http://java-decompiler.github.io/"/>
<node TEXT="https://stackoverflow.com/questions/3593420/is-there-a-way-to-get-the-source-code-from-an-apk-file" ID="ID_668437839" CREATED="1607389575650" MODIFIED="1607389575650" LINK="https://stackoverflow.com/questions/3593420/is-there-a-way-to-get-the-source-code-from-an-apk-file"/>
</node>
</node>
<node TEXT="maxmindDB" FOLDED="true" POSITION="right" ID="ID_973740719" CREATED="1608027306681" MODIFIED="1621472968370">
<node TEXT="https://www.maxmind.com/en/accounts/440125/geoip/downloads" ID="ID_1562375436" CREATED="1608027308745" MODIFIED="1608027308745" LINK="https://www.maxmind.com/en/accounts/440125/geoip/downloads"/>
</node>
<node TEXT="openJdk" POSITION="left" ID="ID_933177484" CREATED="1610434059360" MODIFIED="1621472968370" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
<node TEXT="https://github.com/ojdkbuild/ojdkbuild" ID="ID_1831848659" CREATED="1610434062927" MODIFIED="1610434069273" LINK="https://github.com/ojdkbuild/ojdkbuild"/>
</node>
<node TEXT="springboot랑 같이 실행" FOLDED="true" POSITION="left" ID="ID_1331755415" CREATED="1611105493279" MODIFIED="1621472968370" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="ApplicationRunner" ID="ID_1816457558" CREATED="1611105500775" MODIFIED="1611105509614"/>
</node>
<node TEXT="erdCloud" FOLDED="true" POSITION="right" ID="ID_850119877" CREATED="1611300118764" MODIFIED="1621472968370">
<node TEXT="https://www.erdcloud.com" ID="ID_1453808096" CREATED="1611310772879" MODIFIED="1611310772879" LINK="https://www.erdcloud.com"/>
</node>
<node TEXT="스프링 컨트롤러 파라미터 LIST로 받기" FOLDED="true" POSITION="right" ID="ID_1582442077" CREATED="1613379272125" MODIFIED="1621472968370" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://krespo.net/167" ID="ID_899777292" CREATED="1613379279325" MODIFIED="1613379279325" LINK="https://krespo.net/167"/>
</node>
<node TEXT="다국어" FOLDED="true" POSITION="right" ID="ID_1370665871" CREATED="1618364358389" MODIFIED="1621472968370">
<node TEXT="https://www.baeldung.com/spring-boot-internationalization" ID="ID_357762216" CREATED="1618364360340" MODIFIED="1618364360340" LINK="https://www.baeldung.com/spring-boot-internationalization"/>
</node>
<node TEXT="elk" FOLDED="true" POSITION="right" ID="ID_1237785629" CREATED="1619006312643" MODIFIED="1621472968370" COLOR="#ff3333" BACKGROUND_COLOR="#ffffff" STYLE="bubble">
<font NAME="Dialog" SIZE="24" BOLD="true"/>
<node TEXT="https://www.javainuse.com/spring/springboot-microservice-elk" ID="ID_271111082" CREATED="1619006314116" MODIFIED="1619006316500" LINK="https://www.javainuse.com/spring/springboot-microservice-elk"/>
</node>
<node TEXT="springboot 로깅" FOLDED="true" POSITION="right" ID="ID_1802438026" CREATED="1619423255029" MODIFIED="1621472968370">
<node TEXT="logging.file(yml 설정방법)" ID="ID_1799123569" CREATED="1619423481646" MODIFIED="1619774606007">
<node TEXT="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-logging-file-output" ID="ID_7098965" CREATED="1619423354701" MODIFIED="1619423354701" LINK="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#boot-features-logging-file-output"/>
</node>
<node TEXT="로그의 유형" ID="ID_1964590571" CREATED="1619774092141" MODIFIED="1619774607104">
<node TEXT="FATAL" ID="ID_884240331" CREATED="1619774116366" MODIFIED="1619774121473"/>
<node TEXT="ERROR" ID="ID_1065572207" CREATED="1619774122133" MODIFIED="1619774123565"/>
<node TEXT="WARN" ID="ID_855789732" CREATED="1619774124125" MODIFIED="1619774125197"/>
<node TEXT="INFO" ID="ID_1709543563" CREATED="1619774125725" MODIFIED="1619774328213" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="디폴트" ID="ID_956912636" CREATED="1619774329590" MODIFIED="1619774332661" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
</node>
</node>
<node TEXT="DEBUG" ID="ID_1427031379" CREATED="1619774127293" MODIFIED="1619774129589"/>
<node TEXT="TRACE" ID="ID_27448706" CREATED="1619774130141" MODIFIED="1619774131501"/>
</node>
<node TEXT="라이브러리" ID="ID_1539720870" CREATED="1619774062208" MODIFIED="1619774607469">
<node TEXT="log4j" ID="ID_845973978" CREATED="1619774079214" MODIFIED="1619774080986">
<node TEXT="https://www.baeldung.com/java-logging-intro" ID="ID_1946960600" CREATED="1619774081518" MODIFIED="1619774081518" LINK="https://www.baeldung.com/java-logging-intro"/>
</node>
</node>
</node>
<node TEXT="apk 까보기" FOLDED="true" POSITION="right" ID="ID_936177846" CREATED="1620092329751" MODIFIED="1621472968370">
<node TEXT="https://github.com/skylot/jadx/releases/tag/v1.2.0" ID="ID_843213046" CREATED="1620092333586" MODIFIED="1620092333586" LINK="https://github.com/skylot/jadx/releases/tag/v1.2.0"/>
</node>
<node TEXT="html을 이미지로 변환하는걸 자바에서 하기" FOLDED="true" POSITION="right" ID="ID_522655161" CREATED="1620886228631" MODIFIED="1621472968370">
<node TEXT="https://whitecold89.tistory.com/48" ID="ID_1708562186" CREATED="1620886246664" MODIFIED="1620886246664" LINK="https://whitecold89.tistory.com/48"/>
</node>
<node TEXT="로컬 데이트 타임 post로 던져 세이브 할 시에" FOLDED="true" POSITION="left" ID="ID_759038728" CREATED="1613370929160" MODIFIED="1621472968370">
<node TEXT="https://lejewk.github.io/jpa-localdatetime-jsonformat/" ID="ID_1960003342" CREATED="1613370941359" MODIFIED="1613370941359" LINK="https://lejewk.github.io/jpa-localdatetime-jsonformat/"/>
</node>
<node TEXT="logback.xml 만지는법" FOLDED="true" POSITION="left" ID="ID_1412774746" CREATED="1620116178319" MODIFIED="1621472968370">
<node TEXT="https://github.com/logstash/logstash-logback-encoder" ID="ID_1642479479" CREATED="1620116188824" MODIFIED="1620116188824" LINK="https://github.com/logstash/logstash-logback-encoder"/>
</node>
<node TEXT="maven 메이븐 goals 유형" FOLDED="true" POSITION="left" ID="ID_825833406" CREATED="1620639257050" MODIFIED="1621472968370" COLOR="#3333ff" STYLE="bubble">
<font NAME="굴림" SIZE="16" BOLD="true"/>
<node TEXT="https://wikidocs.net/18341" ID="ID_1573768780" CREATED="1620639270345" MODIFIED="1620639361485" LINK="https://wikidocs.net/18341"/>
</node>
</node>
</map>
